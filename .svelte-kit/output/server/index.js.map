{"version":3,"file":"index.js","sources":["../../../node_modules/@sveltejs/kit/src/constants.js","../../../node_modules/@sveltejs/kit/src/utils/http.js","../../../node_modules/@sveltejs/kit/src/runtime/app/server/event.js","../../../node_modules/@sveltejs/kit/src/runtime/control.js","../../../node_modules/@sveltejs/kit/src/runtime/pathname.js","../../../node_modules/@sveltejs/kit/src/exports/index.js","../../../node_modules/@sveltejs/kit/src/utils/error.js","../../../node_modules/@sveltejs/kit/src/utils/escape.js","../../../node_modules/@sveltejs/kit/src/runtime/server/utils.js","../../../node_modules/@sveltejs/kit/src/runtime/server/endpoint.js","../../../node_modules/@sveltejs/kit/src/utils/array.js","../../../node_modules/@sveltejs/kit/src/runtime/server/page/actions.js","../../../node_modules/@sveltejs/kit/src/runtime/shared.js","../../../node_modules/@sveltejs/kit/src/runtime/utils.js","../../../node_modules/@sveltejs/kit/src/runtime/server/page/load_data.js","../../../node_modules/@sveltejs/kit/src/runtime/hash.js","../../../node_modules/@sveltejs/kit/src/runtime/server/page/serialize_data.js","../../../node_modules/@sveltejs/kit/src/utils/misc.js","../../../node_modules/@sveltejs/kit/src/runtime/server/page/crypto.js","../../../node_modules/@sveltejs/kit/src/runtime/server/page/csp.js","../../../node_modules/@sveltejs/kit/src/utils/streaming.js","../../../node_modules/@sveltejs/kit/src/utils/routing.js","../../../node_modules/@sveltejs/kit/src/runtime/server/page/server_routing.js","../../../node_modules/@sveltejs/kit/src/runtime/server/page/render.js","../../../node_modules/@sveltejs/kit/src/utils/page_nodes.js","../../../node_modules/@sveltejs/kit/src/runtime/server/page/respond_with_error.js","../../../node_modules/@sveltejs/kit/src/utils/functions.js","../../../node_modules/@sveltejs/kit/src/runtime/server/data/index.js","../../../node_modules/@sveltejs/kit/src/runtime/server/page/index.js","../../../node_modules/@sveltejs/kit/src/runtime/server/cookie.js","../../../node_modules/@sveltejs/kit/src/runtime/server/fetch.js","../../../node_modules/@sveltejs/kit/src/runtime/server/env_module.js","../../../node_modules/@sveltejs/kit/src/runtime/server/respond.js","../../../node_modules/@sveltejs/kit/src/utils/env.js","../../../node_modules/@sveltejs/kit/src/runtime/server/app.js","../../../node_modules/@sveltejs/kit/src/runtime/server/index.js"],"sourcesContent":["/**\n * A fake asset path used in `vite dev` and `vite preview`, so that we can\n * serve local assets while verifying that requests are correctly prefixed\n */\nexport const SVELTE_KIT_ASSETS = '/_svelte_kit_assets';\n\nexport const GENERATED_COMMENT = '// this file is generated — do not edit it\\n';\n\nexport const ENDPOINT_METHODS = ['GET', 'POST', 'PUT', 'PATCH', 'DELETE', 'OPTIONS', 'HEAD'];\n\nexport const PAGE_METHODS = ['GET', 'POST', 'HEAD'];\n","/**\n * Given an Accept header and a list of possible content types, pick\n * the most suitable one to respond with\n * @param {string} accept\n * @param {string[]} types\n */\nexport function negotiate(accept, types) {\n\t/** @type {Array<{ type: string, subtype: string, q: number, i: number }>} */\n\tconst parts = [];\n\n\taccept.split(',').forEach((str, i) => {\n\t\tconst match = /([^/ \\t]+)\\/([^; \\t]+)[ \\t]*(?:;[ \\t]*q=([0-9.]+))?/.exec(str);\n\n\t\t// no match equals invalid header — ignore\n\t\tif (match) {\n\t\t\tconst [, type, subtype, q = '1'] = match;\n\t\t\tparts.push({ type, subtype, q: +q, i });\n\t\t}\n\t});\n\n\tparts.sort((a, b) => {\n\t\tif (a.q !== b.q) {\n\t\t\treturn b.q - a.q;\n\t\t}\n\n\t\tif ((a.subtype === '*') !== (b.subtype === '*')) {\n\t\t\treturn a.subtype === '*' ? 1 : -1;\n\t\t}\n\n\t\tif ((a.type === '*') !== (b.type === '*')) {\n\t\t\treturn a.type === '*' ? 1 : -1;\n\t\t}\n\n\t\treturn a.i - b.i;\n\t});\n\n\tlet accepted;\n\tlet min_priority = Infinity;\n\n\tfor (const mimetype of types) {\n\t\tconst [type, subtype] = mimetype.split('/');\n\t\tconst priority = parts.findIndex(\n\t\t\t(part) =>\n\t\t\t\t(part.type === type || part.type === '*') &&\n\t\t\t\t(part.subtype === subtype || part.subtype === '*')\n\t\t);\n\n\t\tif (priority !== -1 && priority < min_priority) {\n\t\t\taccepted = mimetype;\n\t\t\tmin_priority = priority;\n\t\t}\n\t}\n\n\treturn accepted;\n}\n\n/**\n * Returns `true` if the request contains a `content-type` header with the given type\n * @param {Request} request\n * @param  {...string} types\n */\nfunction is_content_type(request, ...types) {\n\tconst type = request.headers.get('content-type')?.split(';', 1)[0].trim() ?? '';\n\treturn types.includes(type.toLowerCase());\n}\n\n/**\n * @param {Request} request\n */\nexport function is_form_content_type(request) {\n\t// These content types must be protected against CSRF\n\t// https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/enctype\n\treturn is_content_type(\n\t\trequest,\n\t\t'application/x-www-form-urlencoded',\n\t\t'multipart/form-data',\n\t\t'text/plain'\n\t);\n}\n","/** @import { RequestEvent } from '@sveltejs/kit' */\n\n/** @type {RequestEvent | null} */\nlet request_event = null;\n\n/** @type {import('node:async_hooks').AsyncLocalStorage<RequestEvent | null>} */\nlet als;\n\nimport('node:async_hooks')\n\t.then((hooks) => (als = new hooks.AsyncLocalStorage()))\n\t.catch(() => {\n\t\t// can't use AsyncLocalStorage, but can still call getRequestEvent synchronously.\n\t\t// this isn't behind `supports` because it's basically just StackBlitz (i.e.\n\t\t// in-browser usage) that doesn't support it AFAICT\n\t});\n\n/**\n * Returns the current `RequestEvent`. Can be used inside server hooks, server `load` functions, actions, and endpoints (and functions called by them).\n *\n * In environments without [`AsyncLocalStorage`](https://nodejs.org/api/async_context.html#class-asynclocalstorage), this must be called synchronously (i.e. not after an `await`).\n * @since 2.20.0\n */\nexport function getRequestEvent() {\n\tconst event = request_event ?? als?.getStore();\n\n\tif (!event) {\n\t\tlet message =\n\t\t\t'Can only read the current request event inside functions invoked during `handle`, such as server `load` functions, actions, endpoints, and other server hooks.';\n\n\t\tif (!als) {\n\t\t\tmessage +=\n\t\t\t\t' In environments without `AsyncLocalStorage`, the event must be read synchronously, not after an `await`.';\n\t\t}\n\n\t\tthrow new Error(message);\n\t}\n\n\treturn event;\n}\n\n/**\n * @template T\n * @param {RequestEvent | null} event\n * @param {() => T} fn\n */\nexport function with_event(event, fn) {\n\ttry {\n\t\trequest_event = event;\n\t\treturn als ? als.run(event, fn) : fn();\n\t} finally {\n\t\trequest_event = null;\n\t}\n}\n","export class HttpError {\n\t/**\n\t * @param {number} status\n\t * @param {{message: string} extends App.Error ? (App.Error | string | undefined) : App.Error} body\n\t */\n\tconstructor(status, body) {\n\t\tthis.status = status;\n\t\tif (typeof body === 'string') {\n\t\t\tthis.body = { message: body };\n\t\t} else if (body) {\n\t\t\tthis.body = body;\n\t\t} else {\n\t\t\tthis.body = { message: `Error: ${status}` };\n\t\t}\n\t}\n\n\ttoString() {\n\t\treturn JSON.stringify(this.body);\n\t}\n}\n\nexport class Redirect {\n\t/**\n\t * @param {300 | 301 | 302 | 303 | 304 | 305 | 306 | 307 | 308} status\n\t * @param {string} location\n\t */\n\tconstructor(status, location) {\n\t\tthis.status = status;\n\t\tthis.location = location;\n\t}\n}\n\n/**\n * An error that was thrown from within the SvelteKit runtime that is not fatal and doesn't result in a 500, such as a 404.\n * `SvelteKitError` goes through `handleError`.\n * @extends Error\n */\nexport class SvelteKitError extends Error {\n\t/**\n\t * @param {number} status\n\t * @param {string} text\n\t * @param {string} message\n\t */\n\tconstructor(status, text, message) {\n\t\tsuper(message);\n\t\tthis.status = status;\n\t\tthis.text = text;\n\t}\n}\n\n/**\n * @template {Record<string, unknown> | undefined} [T=undefined]\n */\nexport class ActionFailure {\n\t/**\n\t * @param {number} status\n\t * @param {T} data\n\t */\n\tconstructor(status, data) {\n\t\tthis.status = status;\n\t\tthis.data = data;\n\t}\n}\n","const DATA_SUFFIX = '/__data.json';\nconst HTML_DATA_SUFFIX = '.html__data.json';\n\n/** @param {string} pathname */\nexport function has_data_suffix(pathname) {\n\treturn pathname.endsWith(DATA_SUFFIX) || pathname.endsWith(HTML_DATA_SUFFIX);\n}\n\n/** @param {string} pathname */\nexport function add_data_suffix(pathname) {\n\tif (pathname.endsWith('.html')) return pathname.replace(/\\.html$/, HTML_DATA_SUFFIX);\n\treturn pathname.replace(/\\/$/, '') + DATA_SUFFIX;\n}\n\n/** @param {string} pathname */\nexport function strip_data_suffix(pathname) {\n\tif (pathname.endsWith(HTML_DATA_SUFFIX)) {\n\t\treturn pathname.slice(0, -HTML_DATA_SUFFIX.length) + '.html';\n\t}\n\n\treturn pathname.slice(0, -DATA_SUFFIX.length);\n}\n\nconst ROUTE_SUFFIX = '/__route.js';\n\n/**\n * @param {string} pathname\n * @returns {boolean}\n */\nexport function has_resolution_suffix(pathname) {\n\treturn pathname.endsWith(ROUTE_SUFFIX);\n}\n\n/**\n * Convert a regular URL to a route to send to SvelteKit's server-side route resolution endpoint\n * @param {string} pathname\n * @returns {string}\n */\nexport function add_resolution_suffix(pathname) {\n\treturn pathname.replace(/\\/$/, '') + ROUTE_SUFFIX;\n}\n\n/**\n * @param {string} pathname\n * @returns {string}\n */\nexport function strip_resolution_suffix(pathname) {\n\treturn pathname.slice(0, -ROUTE_SUFFIX.length);\n}\n","import { HttpError, Redirect, ActionFailure } from '../runtime/control.js';\nimport { BROWSER, DEV } from 'esm-env';\nimport {\n\tadd_data_suffix,\n\tadd_resolution_suffix,\n\thas_data_suffix,\n\thas_resolution_suffix,\n\tstrip_data_suffix,\n\tstrip_resolution_suffix\n} from '../runtime/pathname.js';\n\nexport { VERSION } from '../version.js';\n\n// TODO 3.0: remove these types as they are not used anymore (we can't remove them yet because that would be a breaking change)\n/**\n * @template {number} TNumber\n * @template {any[]} [TArray=[]]\n * @typedef {TNumber extends TArray['length'] ? TArray[number] : LessThan<TNumber, [...TArray, TArray['length']]>} LessThan\n */\n\n/**\n * @template {number} TStart\n * @template {number} TEnd\n * @typedef {Exclude<TEnd | LessThan<TEnd>, LessThan<TStart>>} NumericRange\n */\n\n// Keep the status codes as `number` because restricting to certain numbers makes it unnecessarily hard to use compared to the benefits\n// (we have runtime errors already to check for invalid codes). Also see https://github.com/sveltejs/kit/issues/11780\n\n// we have to repeat the JSDoc because the display for function overloads is broken\n// see https://github.com/microsoft/TypeScript/issues/55056\n\n/**\n * Throws an error with a HTTP status code and an optional message.\n * When called during request handling, this will cause SvelteKit to\n * return an error response without invoking `handleError`.\n * Make sure you're not catching the thrown error, which would prevent SvelteKit from handling it.\n * @param {number} status The [HTTP status code](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#client_error_responses). Must be in the range 400-599.\n * @param {App.Error} body An object that conforms to the App.Error type. If a string is passed, it will be used as the message property.\n * @overload\n * @param {number} status\n * @param {App.Error} body\n * @return {never}\n * @throws {HttpError} This error instructs SvelteKit to initiate HTTP error handling.\n * @throws {Error} If the provided status is invalid (not between 400 and 599).\n */\n/**\n * Throws an error with a HTTP status code and an optional message.\n * When called during request handling, this will cause SvelteKit to\n * return an error response without invoking `handleError`.\n * Make sure you're not catching the thrown error, which would prevent SvelteKit from handling it.\n * @param {number} status The [HTTP status code](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#client_error_responses). Must be in the range 400-599.\n * @param {{ message: string } extends App.Error ? App.Error | string | undefined : never} [body] An object that conforms to the App.Error type. If a string is passed, it will be used as the message property.\n * @overload\n * @param {number} status\n * @param {{ message: string } extends App.Error ? App.Error | string | undefined : never} [body]\n * @return {never}\n * @throws {HttpError} This error instructs SvelteKit to initiate HTTP error handling.\n * @throws {Error} If the provided status is invalid (not between 400 and 599).\n */\n/**\n * Throws an error with a HTTP status code and an optional message.\n * When called during request handling, this will cause SvelteKit to\n * return an error response without invoking `handleError`.\n * Make sure you're not catching the thrown error, which would prevent SvelteKit from handling it.\n * @param {number} status The [HTTP status code](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#client_error_responses). Must be in the range 400-599.\n * @param {{ message: string } extends App.Error ? App.Error | string | undefined : never} body An object that conforms to the App.Error type. If a string is passed, it will be used as the message property.\n * @return {never}\n * @throws {HttpError} This error instructs SvelteKit to initiate HTTP error handling.\n * @throws {Error} If the provided status is invalid (not between 400 and 599).\n */\nexport function error(status, body) {\n\tif ((!BROWSER || DEV) && (isNaN(status) || status < 400 || status > 599)) {\n\t\tthrow new Error(`HTTP error status codes must be between 400 and 599 — ${status} is invalid`);\n\t}\n\n\tthrow new HttpError(status, body);\n}\n\n/**\n * Checks whether this is an error thrown by {@link error}.\n * @template {number} T\n * @param {unknown} e\n * @param {T} [status] The status to filter for.\n * @return {e is (HttpError & { status: T extends undefined ? never : T })}\n */\nexport function isHttpError(e, status) {\n\tif (!(e instanceof HttpError)) return false;\n\treturn !status || e.status === status;\n}\n\n/**\n * Redirect a request. When called during request handling, SvelteKit will return a redirect response.\n * Make sure you're not catching the thrown redirect, which would prevent SvelteKit from handling it.\n *\n * Most common status codes:\n *  * `303 See Other`: redirect as a GET request (often used after a form POST request)\n *  * `307 Temporary Redirect`: redirect will keep the request method\n *  * `308 Permanent Redirect`: redirect will keep the request method, SEO will be transferred to the new page\n *\n * [See all redirect status codes](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#redirection_messages)\n *\n * @param {300 | 301 | 302 | 303 | 304 | 305 | 306 | 307 | 308 | ({} & number)} status The [HTTP status code](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#redirection_messages). Must be in the range 300-308.\n * @param {string | URL} location The location to redirect to.\n * @throws {Redirect} This error instructs SvelteKit to redirect to the specified location.\n * @throws {Error} If the provided status is invalid.\n * @return {never}\n */\nexport function redirect(status, location) {\n\tif ((!BROWSER || DEV) && (isNaN(status) || status < 300 || status > 308)) {\n\t\tthrow new Error('Invalid status code');\n\t}\n\n\tthrow new Redirect(\n\t\t// @ts-ignore\n\t\tstatus,\n\t\tlocation.toString()\n\t);\n}\n\n/**\n * Checks whether this is a redirect thrown by {@link redirect}.\n * @param {unknown} e The object to check.\n * @return {e is Redirect}\n */\nexport function isRedirect(e) {\n\treturn e instanceof Redirect;\n}\n\n/**\n * Create a JSON `Response` object from the supplied data.\n * @param {any} data The value that will be serialized as JSON.\n * @param {ResponseInit} [init] Options such as `status` and `headers` that will be added to the response. `Content-Type: application/json` and `Content-Length` headers will be added automatically.\n */\nexport function json(data, init) {\n\t// TODO deprecate this in favour of `Response.json` when it's\n\t// more widely supported\n\tconst body = JSON.stringify(data);\n\n\t// we can't just do `text(JSON.stringify(data), init)` because\n\t// it will set a default `content-type` header. duplicated code\n\t// means less duplicated work\n\tconst headers = new Headers(init?.headers);\n\tif (!headers.has('content-length')) {\n\t\theaders.set('content-length', encoder.encode(body).byteLength.toString());\n\t}\n\n\tif (!headers.has('content-type')) {\n\t\theaders.set('content-type', 'application/json');\n\t}\n\n\treturn new Response(body, {\n\t\t...init,\n\t\theaders\n\t});\n}\n\nconst encoder = new TextEncoder();\n\n/**\n * Create a `Response` object from the supplied body.\n * @param {string} body The value that will be used as-is.\n * @param {ResponseInit} [init] Options such as `status` and `headers` that will be added to the response. A `Content-Length` header will be added automatically.\n */\nexport function text(body, init) {\n\tconst headers = new Headers(init?.headers);\n\tif (!headers.has('content-length')) {\n\t\tconst encoded = encoder.encode(body);\n\t\theaders.set('content-length', encoded.byteLength.toString());\n\t\treturn new Response(encoded, {\n\t\t\t...init,\n\t\t\theaders\n\t\t});\n\t}\n\n\treturn new Response(body, {\n\t\t...init,\n\t\theaders\n\t});\n}\n\n/**\n * Create an `ActionFailure` object. Call when form submission fails.\n * @param {number} status The [HTTP status code](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#client_error_responses). Must be in the range 400-599.\n * @overload\n * @param {number} status\n * @returns {import('./public.js').ActionFailure<undefined>}\n */\n/**\n * Create an `ActionFailure` object. Call when form submission fails.\n * @template {Record<string, unknown> | undefined} [T=undefined]\n * @param {number} status The [HTTP status code](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#client_error_responses). Must be in the range 400-599.\n * @param {T} data Data associated with the failure (e.g. validation errors)\n * @overload\n * @param {number} status\n * @param {T} data\n * @returns {import('./public.js').ActionFailure<T>}\n */\n/**\n * Create an `ActionFailure` object. Call when form submission fails.\n * @param {number} status\n * @param {any} [data]\n * @returns {import('./public.js').ActionFailure<any>}\n */\nexport function fail(status, data) {\n\t// @ts-expect-error unique symbol missing\n\treturn new ActionFailure(status, data);\n}\n\n/**\n * Checks whether this is an action failure thrown by {@link fail}.\n * @param {unknown} e The object to check.\n * @return {e is import('./public.js').ActionFailure}\n */\nexport function isActionFailure(e) {\n\treturn e instanceof ActionFailure;\n}\n\n/**\n * Strips possible SvelteKit-internal suffixes and trailing slashes from the URL pathname.\n * Returns the normalized URL as well as a method for adding the potential suffix back\n * based on a new pathname (possibly including search) or URL.\n * ```js\n * import { normalizeUrl } from '@sveltejs/kit';\n *\n * const { url, denormalize } = normalizeUrl('/blog/post/__data.json');\n * console.log(url.pathname); // /blog/post\n * console.log(denormalize('/blog/post/a')); // /blog/post/a/__data.json\n * ```\n * @param {URL | string} url\n * @returns {{ url: URL, wasNormalized: boolean, denormalize: (url?: string | URL) => URL }}\n * @since 2.18.0\n */\nexport function normalizeUrl(url) {\n\turl = new URL(url, 'http://internal');\n\n\tconst is_route_resolution = has_resolution_suffix(url.pathname);\n\tconst is_data_request = has_data_suffix(url.pathname);\n\tconst has_trailing_slash = url.pathname !== '/' && url.pathname.endsWith('/');\n\n\tif (is_route_resolution) {\n\t\turl.pathname = strip_resolution_suffix(url.pathname);\n\t} else if (is_data_request) {\n\t\turl.pathname = strip_data_suffix(url.pathname);\n\t} else if (has_trailing_slash) {\n\t\turl.pathname = url.pathname.slice(0, -1);\n\t}\n\n\treturn {\n\t\turl,\n\t\twasNormalized: is_data_request || is_route_resolution || has_trailing_slash,\n\t\tdenormalize: (new_url = url) => {\n\t\t\tnew_url = new URL(new_url, url);\n\t\t\tif (is_route_resolution) {\n\t\t\t\tnew_url.pathname = add_resolution_suffix(new_url.pathname);\n\t\t\t} else if (is_data_request) {\n\t\t\t\tnew_url.pathname = add_data_suffix(new_url.pathname);\n\t\t\t} else if (has_trailing_slash && !new_url.pathname.endsWith('/')) {\n\t\t\t\tnew_url.pathname += '/';\n\t\t\t}\n\t\t\treturn new_url;\n\t\t}\n\t};\n}\n","import { HttpError, SvelteKitError } from '../runtime/control.js';\n\n/**\n * @param {unknown} err\n * @return {Error}\n */\nexport function coalesce_to_error(err) {\n\treturn err instanceof Error ||\n\t\t(err && /** @type {any} */ (err).name && /** @type {any} */ (err).message)\n\t\t? /** @type {Error} */ (err)\n\t\t: new Error(JSON.stringify(err));\n}\n\n/**\n * This is an identity function that exists to make TypeScript less\n * paranoid about people throwing things that aren't errors, which\n * frankly is not something we should care about\n * @param {unknown} error\n */\nexport function normalize_error(error) {\n\treturn /** @type {import('../runtime/control.js').Redirect | HttpError | SvelteKitError | Error} */ (\n\t\terror\n\t);\n}\n\n/**\n * @param {unknown} error\n */\nexport function get_status(error) {\n\treturn error instanceof HttpError || error instanceof SvelteKitError ? error.status : 500;\n}\n\n/**\n * @param {unknown} error\n */\nexport function get_message(error) {\n\treturn error instanceof SvelteKitError ? error.text : 'Internal Error';\n}\n","/**\n * When inside a double-quoted attribute value, only `&` and `\"` hold special meaning.\n * @see https://html.spec.whatwg.org/multipage/parsing.html#attribute-value-(double-quoted)-state\n * @type {Record<string, string>}\n */\nconst escape_html_attr_dict = {\n\t'&': '&amp;',\n\t'\"': '&quot;'\n\t// Svelte also escapes < because the escape function could be called inside a `noscript` there\n\t// https://github.com/sveltejs/svelte/security/advisories/GHSA-8266-84wp-wv5c\n\t// However, that doesn't apply in SvelteKit\n};\n\n/**\n * @type {Record<string, string>}\n */\nconst escape_html_dict = {\n\t'&': '&amp;',\n\t'<': '&lt;'\n};\n\nconst surrogates = // high surrogate without paired low surrogate\n\t'[\\\\ud800-\\\\udbff](?![\\\\udc00-\\\\udfff])|' +\n\t// a valid surrogate pair, the only match with 2 code units\n\t// we match it so that we can match unpaired low surrogates in the same pass\n\t// TODO: use lookbehind assertions once they are widely supported: (?<![\\ud800-udbff])[\\udc00-\\udfff]\n\t'[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]|' +\n\t// unpaired low surrogate (see previous match)\n\t'[\\\\udc00-\\\\udfff]';\n\nconst escape_html_attr_regex = new RegExp(\n\t`[${Object.keys(escape_html_attr_dict).join('')}]|` + surrogates,\n\t'g'\n);\n\nconst escape_html_regex = new RegExp(\n\t`[${Object.keys(escape_html_dict).join('')}]|` + surrogates,\n\t'g'\n);\n\n/**\n * Escapes unpaired surrogates (which are allowed in js strings but invalid in HTML) and\n * escapes characters that are special.\n *\n * @param {string} str\n * @param {boolean} [is_attr]\n * @returns {string} escaped string\n * @example const html = `<tag data-value=\"${escape_html('value', true)}\">...</tag>`;\n */\nexport function escape_html(str, is_attr) {\n\tconst dict = is_attr ? escape_html_attr_dict : escape_html_dict;\n\tconst escaped_str = str.replace(is_attr ? escape_html_attr_regex : escape_html_regex, (match) => {\n\t\tif (match.length === 2) {\n\t\t\t// valid surrogate pair\n\t\t\treturn match;\n\t\t}\n\n\t\treturn dict[match] ?? `&#${match.charCodeAt(0)};`;\n\t});\n\n\treturn escaped_str;\n}\n","import { DEV } from 'esm-env';\nimport { json, text } from '../../exports/index.js';\nimport { coalesce_to_error, get_message, get_status } from '../../utils/error.js';\nimport { negotiate } from '../../utils/http.js';\nimport { HttpError } from '../control.js';\nimport { fix_stack_trace } from '../shared-server.js';\nimport { ENDPOINT_METHODS } from '../../constants.js';\nimport { escape_html } from '../../utils/escape.js';\nimport { with_event } from '../app/server/event.js';\n\n/** @param {any} body */\nexport function is_pojo(body) {\n\tif (typeof body !== 'object') return false;\n\n\tif (body) {\n\t\tif (body instanceof Uint8Array) return false;\n\t\tif (body instanceof ReadableStream) return false;\n\t}\n\n\treturn true;\n}\n\n/**\n * @param {Partial<Record<import('types').HttpMethod, any>>} mod\n * @param {import('types').HttpMethod} method\n */\nexport function method_not_allowed(mod, method) {\n\treturn text(`${method} method not allowed`, {\n\t\tstatus: 405,\n\t\theaders: {\n\t\t\t// https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/405\n\t\t\t// \"The server must generate an Allow header field in a 405 status code response\"\n\t\t\tallow: allowed_methods(mod).join(', ')\n\t\t}\n\t});\n}\n\n/** @param {Partial<Record<import('types').HttpMethod, any>>} mod */\nexport function allowed_methods(mod) {\n\tconst allowed = ENDPOINT_METHODS.filter((method) => method in mod);\n\n\tif ('GET' in mod || 'HEAD' in mod) allowed.push('HEAD');\n\n\treturn allowed;\n}\n\n/**\n * Return as a response that renders the error.html\n *\n * @param {import('types').SSROptions} options\n * @param {number} status\n * @param {string} message\n */\nexport function static_error_page(options, status, message) {\n\tlet page = options.templates.error({ status, message: escape_html(message) });\n\n\tif (DEV) {\n\t\t// inject Vite HMR client, for easier debugging\n\t\tpage = page.replace('</head>', '<script type=\"module\" src=\"/@vite/client\"></script></head>');\n\t}\n\n\treturn text(page, {\n\t\theaders: { 'content-type': 'text/html; charset=utf-8' },\n\t\tstatus\n\t});\n}\n\n/**\n * @param {import('@sveltejs/kit').RequestEvent} event\n * @param {import('types').SSROptions} options\n * @param {unknown} error\n */\nexport async function handle_fatal_error(event, options, error) {\n\terror = error instanceof HttpError ? error : coalesce_to_error(error);\n\tconst status = get_status(error);\n\tconst body = await handle_error_and_jsonify(event, options, error);\n\n\t// ideally we'd use sec-fetch-dest instead, but Safari — quelle surprise — doesn't support it\n\tconst type = negotiate(event.request.headers.get('accept') || 'text/html', [\n\t\t'application/json',\n\t\t'text/html'\n\t]);\n\n\tif (event.isDataRequest || type === 'application/json') {\n\t\treturn json(body, {\n\t\t\tstatus\n\t\t});\n\t}\n\n\treturn static_error_page(options, status, body.message);\n}\n\n/**\n * @param {import('@sveltejs/kit').RequestEvent} event\n * @param {import('types').SSROptions} options\n * @param {any} error\n * @returns {Promise<App.Error>}\n */\nexport async function handle_error_and_jsonify(event, options, error) {\n\tif (error instanceof HttpError) {\n\t\treturn error.body;\n\t}\n\n\tif (__SVELTEKIT_DEV__ && typeof error == 'object') {\n\t\tfix_stack_trace(error);\n\t}\n\n\tconst status = get_status(error);\n\tconst message = get_message(error);\n\n\treturn (\n\t\t(await with_event(event, () =>\n\t\t\toptions.hooks.handleError({ error, event, status, message })\n\t\t)) ?? { message }\n\t);\n}\n\n/**\n * @param {number} status\n * @param {string} location\n */\nexport function redirect_response(status, location) {\n\tconst response = new Response(undefined, {\n\t\tstatus,\n\t\theaders: { location }\n\t});\n\treturn response;\n}\n\n/**\n * @param {import('@sveltejs/kit').RequestEvent} event\n * @param {Error & { path: string }} error\n */\nexport function clarify_devalue_error(event, error) {\n\tif (error.path) {\n\t\treturn `Data returned from \\`load\\` while rendering ${event.route.id} is not serializable: ${error.message} (${error.path})`;\n\t}\n\n\tif (error.path === '') {\n\t\treturn `Data returned from \\`load\\` while rendering ${event.route.id} is not a plain object`;\n\t}\n\n\t// belt and braces — this should never happen\n\treturn error.message;\n}\n\n/**\n * @param {import('types').ServerDataNode} node\n */\nexport function serialize_uses(node) {\n\tconst uses = {};\n\n\tif (node.uses && node.uses.dependencies.size > 0) {\n\t\tuses.dependencies = Array.from(node.uses.dependencies);\n\t}\n\n\tif (node.uses && node.uses.search_params.size > 0) {\n\t\tuses.search_params = Array.from(node.uses.search_params);\n\t}\n\n\tif (node.uses && node.uses.params.size > 0) {\n\t\tuses.params = Array.from(node.uses.params);\n\t}\n\n\tif (node.uses?.parent) uses.parent = 1;\n\tif (node.uses?.route) uses.route = 1;\n\tif (node.uses?.url) uses.url = 1;\n\n\treturn uses;\n}\n\n/**\n * Returns `true` if the given path was prerendered\n * @param {import('@sveltejs/kit').SSRManifest} manifest\n * @param {string} pathname Should include the base and be decoded\n */\nexport function has_prerendered_path(manifest, pathname) {\n\treturn (\n\t\tmanifest._.prerendered_routes.has(pathname) ||\n\t\t(pathname.at(-1) === '/' && manifest._.prerendered_routes.has(pathname.slice(0, -1)))\n\t);\n}\n","import { ENDPOINT_METHODS, PAGE_METHODS } from '../../constants.js';\nimport { negotiate } from '../../utils/http.js';\nimport { with_event } from '../app/server/event.js';\nimport { Redirect } from '../control.js';\nimport { method_not_allowed } from './utils.js';\n\n/**\n * @param {import('@sveltejs/kit').RequestEvent} event\n * @param {import('types').SSREndpoint} mod\n * @param {import('types').SSRState} state\n * @returns {Promise<Response>}\n */\nexport async function render_endpoint(event, mod, state) {\n\tconst method = /** @type {import('types').HttpMethod} */ (event.request.method);\n\n\tlet handler = mod[method] || mod.fallback;\n\n\tif (method === 'HEAD' && !mod.HEAD && mod.GET) {\n\t\thandler = mod.GET;\n\t}\n\n\tif (!handler) {\n\t\treturn method_not_allowed(mod, method);\n\t}\n\n\tconst prerender = mod.prerender ?? state.prerender_default;\n\n\tif (prerender && (mod.POST || mod.PATCH || mod.PUT || mod.DELETE)) {\n\t\tthrow new Error('Cannot prerender endpoints that have mutative methods');\n\t}\n\n\tif (state.prerendering && !state.prerendering.inside_reroute && !prerender) {\n\t\tif (state.depth > 0) {\n\t\t\t// if request came from a prerendered page, bail\n\t\t\tthrow new Error(`${event.route.id} is not prerenderable`);\n\t\t} else {\n\t\t\t// if request came direct from the crawler, signal that\n\t\t\t// this route cannot be prerendered, but don't bail\n\t\t\treturn new Response(undefined, { status: 204 });\n\t\t}\n\t}\n\n\ttry {\n\t\tconst response = await with_event(event, () =>\n\t\t\thandler(/** @type {import('@sveltejs/kit').RequestEvent<Record<string, any>>} */ (event))\n\t\t);\n\n\t\tif (!(response instanceof Response)) {\n\t\t\tthrow new Error(\n\t\t\t\t`Invalid response from route ${event.url.pathname}: handler should return a Response object`\n\t\t\t);\n\t\t}\n\n\t\tif (state.prerendering && (!state.prerendering.inside_reroute || prerender)) {\n\t\t\t// The returned Response might have immutable Headers\n\t\t\t// so we should clone them before trying to mutate them.\n\t\t\t// We also need to clone the response body since it may be read twice during prerendering\n\t\t\tconst cloned = new Response(response.clone().body, {\n\t\t\t\tstatus: response.status,\n\t\t\t\tstatusText: response.statusText,\n\t\t\t\theaders: new Headers(response.headers)\n\t\t\t});\n\t\t\tcloned.headers.set('x-sveltekit-prerender', String(prerender));\n\n\t\t\tif (state.prerendering.inside_reroute && prerender) {\n\t\t\t\t// Without this, the route wouldn't be recorded as prerendered,\n\t\t\t\t// because there's nothing after reroute that would do that.\n\t\t\t\tcloned.headers.set(\n\t\t\t\t\t'x-sveltekit-routeid',\n\t\t\t\t\tencodeURI(/** @type {string} */ (event.route.id))\n\t\t\t\t);\n\t\t\t\tstate.prerendering.dependencies.set(event.url.pathname, { response: cloned, body: null });\n\t\t\t} else {\n\t\t\t\treturn cloned;\n\t\t\t}\n\t\t}\n\n\t\treturn response;\n\t} catch (e) {\n\t\tif (e instanceof Redirect) {\n\t\t\treturn new Response(undefined, {\n\t\t\t\tstatus: e.status,\n\t\t\t\theaders: { location: e.location }\n\t\t\t});\n\t\t}\n\n\t\tthrow e;\n\t}\n}\n\n/**\n * @param {import('@sveltejs/kit').RequestEvent} event\n */\nexport function is_endpoint_request(event) {\n\tconst { method, headers } = event.request;\n\n\t// These methods exist exclusively for endpoints\n\tif (ENDPOINT_METHODS.includes(method) && !PAGE_METHODS.includes(method)) {\n\t\treturn true;\n\t}\n\n\t// use:enhance uses a custom header to disambiguate\n\tif (method === 'POST' && headers.get('x-sveltekit-action') === 'true') return false;\n\n\t// GET/POST requests may be for endpoints or pages. We prefer endpoints if this isn't a text/html request\n\tconst accept = event.request.headers.get('accept') ?? '*/*';\n\treturn negotiate(accept, ['*', 'text/html']) !== 'text/html';\n}\n","/**\n * Removes nullish values from an array.\n *\n * @template T\n * @param {Array<T>} arr\n */\nexport function compact(arr) {\n\treturn arr.filter(/** @returns {val is NonNullable<T>} */ (val) => val != null);\n}\n","import * as devalue from 'devalue';\nimport { DEV } from 'esm-env';\nimport { json } from '../../../exports/index.js';\nimport { get_status, normalize_error } from '../../../utils/error.js';\nimport { is_form_content_type, negotiate } from '../../../utils/http.js';\nimport { HttpError, Redirect, ActionFailure, SvelteKitError } from '../../control.js';\nimport { handle_error_and_jsonify } from '../utils.js';\nimport { with_event } from '../../app/server/event.js';\n\n/** @param {import('@sveltejs/kit').RequestEvent} event */\nexport function is_action_json_request(event) {\n\tconst accept = negotiate(event.request.headers.get('accept') ?? '*/*', [\n\t\t'application/json',\n\t\t'text/html'\n\t]);\n\n\treturn accept === 'application/json' && event.request.method === 'POST';\n}\n\n/**\n * @param {import('@sveltejs/kit').RequestEvent} event\n * @param {import('types').SSROptions} options\n * @param {import('types').SSRNode['server'] | undefined} server\n */\nexport async function handle_action_json_request(event, options, server) {\n\tconst actions = server?.actions;\n\n\tif (!actions) {\n\t\tconst no_actions_error = new SvelteKitError(\n\t\t\t405,\n\t\t\t'Method Not Allowed',\n\t\t\t`POST method not allowed. No form actions exist for ${DEV ? `the page at ${event.route.id}` : 'this page'}`\n\t\t);\n\n\t\treturn action_json(\n\t\t\t{\n\t\t\t\ttype: 'error',\n\t\t\t\terror: await handle_error_and_jsonify(event, options, no_actions_error)\n\t\t\t},\n\t\t\t{\n\t\t\t\tstatus: no_actions_error.status,\n\t\t\t\theaders: {\n\t\t\t\t\t// https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/405\n\t\t\t\t\t// \"The server must generate an Allow header field in a 405 status code response\"\n\t\t\t\t\tallow: 'GET'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tcheck_named_default_separate(actions);\n\n\ttry {\n\t\tconst data = await call_action(event, actions);\n\n\t\tif (__SVELTEKIT_DEV__) {\n\t\t\tvalidate_action_return(data);\n\t\t}\n\n\t\tif (data instanceof ActionFailure) {\n\t\t\treturn action_json({\n\t\t\t\ttype: 'failure',\n\t\t\t\tstatus: data.status,\n\t\t\t\t// @ts-expect-error we assign a string to what is supposed to be an object. That's ok\n\t\t\t\t// because we don't use the object outside, and this way we have better code navigation\n\t\t\t\t// through knowing where the related interface is used.\n\t\t\t\tdata: stringify_action_response(\n\t\t\t\t\tdata.data,\n\t\t\t\t\t/** @type {string} */ (event.route.id),\n\t\t\t\t\toptions.hooks.transport\n\t\t\t\t)\n\t\t\t});\n\t\t} else {\n\t\t\treturn action_json({\n\t\t\t\ttype: 'success',\n\t\t\t\tstatus: data ? 200 : 204,\n\t\t\t\t// @ts-expect-error see comment above\n\t\t\t\tdata: stringify_action_response(\n\t\t\t\t\tdata,\n\t\t\t\t\t/** @type {string} */ (event.route.id),\n\t\t\t\t\toptions.hooks.transport\n\t\t\t\t)\n\t\t\t});\n\t\t}\n\t} catch (e) {\n\t\tconst err = normalize_error(e);\n\n\t\tif (err instanceof Redirect) {\n\t\t\treturn action_json_redirect(err);\n\t\t}\n\n\t\treturn action_json(\n\t\t\t{\n\t\t\t\ttype: 'error',\n\t\t\t\terror: await handle_error_and_jsonify(event, options, check_incorrect_fail_use(err))\n\t\t\t},\n\t\t\t{\n\t\t\t\tstatus: get_status(err)\n\t\t\t}\n\t\t);\n\t}\n}\n\n/**\n * @param {HttpError | Error} error\n */\nfunction check_incorrect_fail_use(error) {\n\treturn error instanceof ActionFailure\n\t\t? new Error('Cannot \"throw fail()\". Use \"return fail()\"')\n\t\t: error;\n}\n\n/**\n * @param {import('@sveltejs/kit').Redirect} redirect\n */\nexport function action_json_redirect(redirect) {\n\treturn action_json({\n\t\ttype: 'redirect',\n\t\tstatus: redirect.status,\n\t\tlocation: redirect.location\n\t});\n}\n\n/**\n * @param {import('@sveltejs/kit').ActionResult} data\n * @param {ResponseInit} [init]\n */\nfunction action_json(data, init) {\n\treturn json(data, init);\n}\n\n/**\n * @param {import('@sveltejs/kit').RequestEvent} event\n */\nexport function is_action_request(event) {\n\treturn event.request.method === 'POST';\n}\n\n/**\n * @param {import('@sveltejs/kit').RequestEvent} event\n * @param {import('types').SSRNode['server'] | undefined} server\n * @returns {Promise<import('@sveltejs/kit').ActionResult>}\n */\nexport async function handle_action_request(event, server) {\n\tconst actions = server?.actions;\n\n\tif (!actions) {\n\t\t// TODO should this be a different error altogether?\n\t\tevent.setHeaders({\n\t\t\t// https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/405\n\t\t\t// \"The server must generate an Allow header field in a 405 status code response\"\n\t\t\tallow: 'GET'\n\t\t});\n\t\treturn {\n\t\t\ttype: 'error',\n\t\t\terror: new SvelteKitError(\n\t\t\t\t405,\n\t\t\t\t'Method Not Allowed',\n\t\t\t\t`POST method not allowed. No form actions exist for ${DEV ? `the page at ${event.route.id}` : 'this page'}`\n\t\t\t)\n\t\t};\n\t}\n\n\tcheck_named_default_separate(actions);\n\n\ttry {\n\t\tconst data = await call_action(event, actions);\n\n\t\tif (__SVELTEKIT_DEV__) {\n\t\t\tvalidate_action_return(data);\n\t\t}\n\n\t\tif (data instanceof ActionFailure) {\n\t\t\treturn {\n\t\t\t\ttype: 'failure',\n\t\t\t\tstatus: data.status,\n\t\t\t\tdata: data.data\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\ttype: 'success',\n\t\t\t\tstatus: 200,\n\t\t\t\t// @ts-expect-error this will be removed upon serialization, so `undefined` is the same as omission\n\t\t\t\tdata\n\t\t\t};\n\t\t}\n\t} catch (e) {\n\t\tconst err = normalize_error(e);\n\n\t\tif (err instanceof Redirect) {\n\t\t\treturn {\n\t\t\t\ttype: 'redirect',\n\t\t\t\tstatus: err.status,\n\t\t\t\tlocation: err.location\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\ttype: 'error',\n\t\t\terror: check_incorrect_fail_use(err)\n\t\t};\n\t}\n}\n\n/**\n * @param {import('@sveltejs/kit').Actions} actions\n */\nfunction check_named_default_separate(actions) {\n\tif (actions.default && Object.keys(actions).length > 1) {\n\t\tthrow new Error(\n\t\t\t'When using named actions, the default action cannot be used. See the docs for more info: https://svelte.dev/docs/kit/form-actions#named-actions'\n\t\t);\n\t}\n}\n\n/**\n * @param {import('@sveltejs/kit').RequestEvent} event\n * @param {NonNullable<import('types').ServerNode['actions']>} actions\n * @throws {Redirect | HttpError | SvelteKitError | Error}\n */\nasync function call_action(event, actions) {\n\tconst url = new URL(event.request.url);\n\n\tlet name = 'default';\n\tfor (const param of url.searchParams) {\n\t\tif (param[0].startsWith('/')) {\n\t\t\tname = param[0].slice(1);\n\t\t\tif (name === 'default') {\n\t\t\t\tthrow new Error('Cannot use reserved action name \"default\"');\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tconst action = actions[name];\n\tif (!action) {\n\t\tthrow new SvelteKitError(404, 'Not Found', `No action with name '${name}' found`);\n\t}\n\n\tif (!is_form_content_type(event.request)) {\n\t\tthrow new SvelteKitError(\n\t\t\t415,\n\t\t\t'Unsupported Media Type',\n\t\t\t`Form actions expect form-encoded data — received ${event.request.headers.get(\n\t\t\t\t'content-type'\n\t\t\t)}`\n\t\t);\n\t}\n\n\treturn with_event(event, () => action(event));\n}\n\n/** @param {any} data */\nfunction validate_action_return(data) {\n\tif (data instanceof Redirect) {\n\t\tthrow new Error('Cannot `return redirect(...)` — use `redirect(...)` instead');\n\t}\n\n\tif (data instanceof HttpError) {\n\t\tthrow new Error('Cannot `return error(...)` — use `error(...)` or `return fail(...)` instead');\n\t}\n}\n\n/**\n * Try to `devalue.uneval` the data object, and if it fails, return a proper Error with context\n * @param {any} data\n * @param {string} route_id\n * @param {import('types').ServerHooks['transport']} transport\n */\nexport function uneval_action_response(data, route_id, transport) {\n\tconst replacer = (/** @type {any} */ thing) => {\n\t\tfor (const key in transport) {\n\t\t\tconst encoded = transport[key].encode(thing);\n\t\t\tif (encoded) {\n\t\t\t\treturn `app.decode('${key}', ${devalue.uneval(encoded, replacer)})`;\n\t\t\t}\n\t\t}\n\t};\n\n\treturn try_serialize(data, (value) => devalue.uneval(value, replacer), route_id);\n}\n\n/**\n * Try to `devalue.stringify` the data object, and if it fails, return a proper Error with context\n * @param {any} data\n * @param {string} route_id\n * @param {import('types').ServerHooks['transport']} transport\n */\nfunction stringify_action_response(data, route_id, transport) {\n\tconst encoders = Object.fromEntries(\n\t\tObject.entries(transport).map(([key, value]) => [key, value.encode])\n\t);\n\n\treturn try_serialize(data, (value) => devalue.stringify(value, encoders), route_id);\n}\n\n/**\n * @param {any} data\n * @param {(data: any) => string} fn\n * @param {string} route_id\n */\nfunction try_serialize(data, fn, route_id) {\n\ttry {\n\t\treturn fn(data);\n\t} catch (e) {\n\t\t// If we're here, the data could not be serialized with devalue\n\t\tconst error = /** @type {any} */ (e);\n\n\t\t// if someone tries to use `json()` in their action\n\t\tif (data instanceof Response) {\n\t\t\tthrow new Error(\n\t\t\t\t`Data returned from action inside ${route_id} is not serializable. Form actions need to return plain objects or fail(). E.g. return { success: true } or return fail(400, { message: \"invalid\" });`\n\t\t\t);\n\t\t}\n\n\t\t// if devalue could not serialize a property on the object, etc.\n\t\tif ('path' in error) {\n\t\t\tlet message = `Data returned from action inside ${route_id} is not serializable: ${error.message}`;\n\t\t\tif (error.path !== '') message += ` (data.${error.path})`;\n\t\t\tthrow new Error(message);\n\t\t}\n\n\t\tthrow error;\n\t}\n}\n","/**\n * @param {string} route_id\n * @param {string} dep\n */\nexport function validate_depends(route_id, dep) {\n\tconst match = /^(moz-icon|view-source|jar):/.exec(dep);\n\tif (match) {\n\t\tconsole.warn(\n\t\t\t`${route_id}: Calling \\`depends('${dep}')\\` will throw an error in Firefox because \\`${match[1]}\\` is a special URI scheme`\n\t\t);\n\t}\n}\n\nexport const INVALIDATED_PARAM = 'x-sveltekit-invalidated';\n\nexport const TRAILING_SLASH_PARAM = 'x-sveltekit-trailing-slash';\n","/**\n * @param {string} text\n * @returns {ArrayBufferLike}\n */\nexport function b64_decode(text) {\n\tconst d = atob(text);\n\n\tconst u8 = new Uint8Array(d.length);\n\n\tfor (let i = 0; i < d.length; i++) {\n\t\tu8[i] = d.charCodeAt(i);\n\t}\n\n\treturn u8.buffer;\n}\n\n/**\n * @param {ArrayBuffer} buffer\n * @returns {string}\n */\nexport function b64_encode(buffer) {\n\tif (globalThis.Buffer) {\n\t\treturn Buffer.from(buffer).toString('base64');\n\t}\n\n\tconst little_endian = new Uint8Array(new Uint16Array([1]).buffer)[0] > 0;\n\n\t// The Uint16Array(Uint8Array(...)) ensures the code points are padded with 0's\n\treturn btoa(\n\t\tnew TextDecoder(little_endian ? 'utf-16le' : 'utf-16be').decode(\n\t\t\tnew Uint16Array(new Uint8Array(buffer))\n\t\t)\n\t);\n}\n\n/**\n * Like node's path.relative, but without using node\n * @param {string} from\n * @param {string} to\n */\nexport function get_relative_path(from, to) {\n\tconst from_parts = from.split(/[/\\\\]/);\n\tconst to_parts = to.split(/[/\\\\]/);\n\tfrom_parts.pop(); // get dirname\n\n\twhile (from_parts[0] === to_parts[0]) {\n\t\tfrom_parts.shift();\n\t\tto_parts.shift();\n\t}\n\n\tlet i = from_parts.length;\n\twhile (i--) from_parts[i] = '..';\n\n\treturn from_parts.concat(to_parts).join('/');\n}\n","import { DEV } from 'esm-env';\nimport { disable_search, make_trackable } from '../../../utils/url.js';\nimport { validate_depends } from '../../shared.js';\nimport { b64_encode } from '../../utils.js';\nimport { with_event } from '../../app/server/event.js';\n\n/**\n * Calls the user's server `load` function.\n * @param {{\n *   event: import('@sveltejs/kit').RequestEvent;\n *   state: import('types').SSRState;\n *   node: import('types').SSRNode | undefined;\n *   parent: () => Promise<Record<string, any>>;\n * }} opts\n * @returns {Promise<import('types').ServerDataNode | null>}\n */\nexport async function load_server_data({ event, state, node, parent }) {\n\tif (!node?.server) return null;\n\n\tlet is_tracking = true;\n\n\tconst uses = {\n\t\tdependencies: new Set(),\n\t\tparams: new Set(),\n\t\tparent: false,\n\t\troute: false,\n\t\turl: false,\n\t\tsearch_params: new Set()\n\t};\n\n\tconst load = node.server.load;\n\t// TODO: shouldn't this be calculated using PageNodes? there could be a trailingSlash option on a layout\n\tconst slash = node.server.trailingSlash;\n\n\tif (!load) {\n\t\treturn { type: 'data', data: null, uses, slash };\n\t}\n\n\tconst url = make_trackable(\n\t\tevent.url,\n\t\t() => {\n\t\t\tif (DEV && done && !uses.url) {\n\t\t\t\tconsole.warn(\n\t\t\t\t\t`${node.server_id}: Accessing URL properties in a promise handler after \\`load(...)\\` has returned will not cause the function to re-run when the URL changes`\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (is_tracking) {\n\t\t\t\tuses.url = true;\n\t\t\t}\n\t\t},\n\t\t(param) => {\n\t\t\tif (DEV && done && !uses.search_params.has(param)) {\n\t\t\t\tconsole.warn(\n\t\t\t\t\t`${node.server_id}: Accessing URL properties in a promise handler after \\`load(...)\\` has returned will not cause the function to re-run when the URL changes`\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (is_tracking) {\n\t\t\t\tuses.search_params.add(param);\n\t\t\t}\n\t\t}\n\t);\n\n\tif (state.prerendering) {\n\t\tdisable_search(url);\n\t}\n\n\tlet done = false;\n\n\tconst result = await with_event(event, () =>\n\t\tload.call(null, {\n\t\t\t...event,\n\t\t\tfetch: (info, init) => {\n\t\t\t\tconst url = new URL(info instanceof Request ? info.url : info, event.url);\n\n\t\t\t\tif (DEV && done && !uses.dependencies.has(url.href)) {\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t`${node.server_id}: Calling \\`event.fetch(...)\\` in a promise handler after \\`load(...)\\` has returned will not cause the function to re-run when the dependency is invalidated`\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// Note: server fetches are not added to uses.depends due to security concerns\n\t\t\t\treturn event.fetch(info, init);\n\t\t\t},\n\t\t\t/** @param {string[]} deps */\n\t\t\tdepends: (...deps) => {\n\t\t\t\tfor (const dep of deps) {\n\t\t\t\t\tconst { href } = new URL(dep, event.url);\n\n\t\t\t\t\tif (DEV) {\n\t\t\t\t\t\tvalidate_depends(node.server_id || 'missing route ID', dep);\n\n\t\t\t\t\t\tif (done && !uses.dependencies.has(href)) {\n\t\t\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\t\t`${node.server_id}: Calling \\`depends(...)\\` in a promise handler after \\`load(...)\\` has returned will not cause the function to re-run when the dependency is invalidated`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tuses.dependencies.add(href);\n\t\t\t\t}\n\t\t\t},\n\t\t\tparams: new Proxy(event.params, {\n\t\t\t\tget: (target, key) => {\n\t\t\t\t\tif (DEV && done && typeof key === 'string' && !uses.params.has(key)) {\n\t\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\t`${node.server_id}: Accessing \\`params.${String(\n\t\t\t\t\t\t\t\tkey\n\t\t\t\t\t\t\t)}\\` in a promise handler after \\`load(...)\\` has returned will not cause the function to re-run when the param changes`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (is_tracking) {\n\t\t\t\t\t\tuses.params.add(key);\n\t\t\t\t\t}\n\t\t\t\t\treturn target[/** @type {string} */ (key)];\n\t\t\t\t}\n\t\t\t}),\n\t\t\tparent: async () => {\n\t\t\t\tif (DEV && done && !uses.parent) {\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t`${node.server_id}: Calling \\`parent(...)\\` in a promise handler after \\`load(...)\\` has returned will not cause the function to re-run when parent data changes`\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (is_tracking) {\n\t\t\t\t\tuses.parent = true;\n\t\t\t\t}\n\t\t\t\treturn parent();\n\t\t\t},\n\t\t\troute: new Proxy(event.route, {\n\t\t\t\tget: (target, key) => {\n\t\t\t\t\tif (DEV && done && typeof key === 'string' && !uses.route) {\n\t\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\t`${node.server_id}: Accessing \\`route.${String(\n\t\t\t\t\t\t\t\tkey\n\t\t\t\t\t\t\t)}\\` in a promise handler after \\`load(...)\\` has returned will not cause the function to re-run when the route changes`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (is_tracking) {\n\t\t\t\t\t\tuses.route = true;\n\t\t\t\t\t}\n\t\t\t\t\treturn target[/** @type {'id'} */ (key)];\n\t\t\t\t}\n\t\t\t}),\n\t\t\turl,\n\t\t\tuntrack(fn) {\n\t\t\t\tis_tracking = false;\n\t\t\t\ttry {\n\t\t\t\t\treturn fn();\n\t\t\t\t} finally {\n\t\t\t\t\tis_tracking = true;\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t);\n\n\tif (__SVELTEKIT_DEV__) {\n\t\tvalidate_load_response(result, node.server_id);\n\t}\n\n\tdone = true;\n\n\treturn {\n\t\ttype: 'data',\n\t\tdata: result ?? null,\n\t\tuses,\n\t\tslash\n\t};\n}\n\n/**\n * Calls the user's `load` function.\n * @param {{\n *   event: import('@sveltejs/kit').RequestEvent;\n *   fetched: import('./types.js').Fetched[];\n *   node: import('types').SSRNode | undefined;\n *   parent: () => Promise<Record<string, any>>;\n *   resolve_opts: import('types').RequiredResolveOptions;\n *   server_data_promise: Promise<import('types').ServerDataNode | null>;\n *   state: import('types').SSRState;\n *   csr: boolean;\n * }} opts\n * @returns {Promise<Record<string, any | Promise<any>> | null>}\n */\nexport async function load_data({\n\tevent,\n\tfetched,\n\tnode,\n\tparent,\n\tserver_data_promise,\n\tstate,\n\tresolve_opts,\n\tcsr\n}) {\n\tconst server_data_node = await server_data_promise;\n\n\tif (!node?.universal?.load) {\n\t\treturn server_data_node?.data ?? null;\n\t}\n\n\tconst result = await node.universal.load.call(null, {\n\t\turl: event.url,\n\t\tparams: event.params,\n\t\tdata: server_data_node?.data ?? null,\n\t\troute: event.route,\n\t\tfetch: create_universal_fetch(event, state, fetched, csr, resolve_opts),\n\t\tsetHeaders: event.setHeaders,\n\t\tdepends: () => {},\n\t\tparent,\n\t\tuntrack: (fn) => fn()\n\t});\n\n\tif (__SVELTEKIT_DEV__) {\n\t\tvalidate_load_response(result, node.universal_id);\n\t}\n\n\treturn result ?? null;\n}\n\n/**\n * @param {Pick<import('@sveltejs/kit').RequestEvent, 'fetch' | 'url' | 'request' | 'route'>} event\n * @param {import('types').SSRState} state\n * @param {import('./types.js').Fetched[]} fetched\n * @param {boolean} csr\n * @param {Pick<Required<import('@sveltejs/kit').ResolveOptions>, 'filterSerializedResponseHeaders'>} resolve_opts\n * @returns {typeof fetch}\n */\nexport function create_universal_fetch(event, state, fetched, csr, resolve_opts) {\n\t/**\n\t * @param {URL | RequestInfo} input\n\t * @param {RequestInit} [init]\n\t */\n\tconst universal_fetch = async (input, init) => {\n\t\tconst cloned_body = input instanceof Request && input.body ? input.clone().body : null;\n\n\t\tconst cloned_headers =\n\t\t\tinput instanceof Request && [...input.headers].length\n\t\t\t\t? new Headers(input.headers)\n\t\t\t\t: init?.headers;\n\n\t\tlet response = await event.fetch(input, init);\n\n\t\tconst url = new URL(input instanceof Request ? input.url : input, event.url);\n\t\tconst same_origin = url.origin === event.url.origin;\n\n\t\t/** @type {import('types').PrerenderDependency} */\n\t\tlet dependency;\n\n\t\tif (same_origin) {\n\t\t\tif (state.prerendering) {\n\t\t\t\tdependency = { response, body: null };\n\t\t\t\tstate.prerendering.dependencies.set(url.pathname, dependency);\n\t\t\t}\n\t\t} else if (url.protocol === 'https:' || url.protocol === 'http:') {\n\t\t\t// simulate CORS errors and \"no access to body in no-cors mode\" server-side for consistency with client-side behaviour\n\t\t\tconst mode = input instanceof Request ? input.mode : (init?.mode ?? 'cors');\n\t\t\tif (mode === 'no-cors') {\n\t\t\t\tresponse = new Response('', {\n\t\t\t\t\tstatus: response.status,\n\t\t\t\t\tstatusText: response.statusText,\n\t\t\t\t\theaders: response.headers\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst acao = response.headers.get('access-control-allow-origin');\n\t\t\t\tif (!acao || (acao !== event.url.origin && acao !== '*')) {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t`CORS error: ${\n\t\t\t\t\t\t\tacao ? 'Incorrect' : 'No'\n\t\t\t\t\t\t} 'Access-Control-Allow-Origin' header is present on the requested resource`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst proxy = new Proxy(response, {\n\t\t\tget(response, key, _receiver) {\n\t\t\t\t/**\n\t\t\t\t * @param {string} body\n\t\t\t\t * @param {boolean} is_b64\n\t\t\t\t */\n\t\t\t\tasync function push_fetched(body, is_b64) {\n\t\t\t\t\tconst status_number = Number(response.status);\n\t\t\t\t\tif (isNaN(status_number)) {\n\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t`response.status is not a number. value: \"${\n\t\t\t\t\t\t\t\tresponse.status\n\t\t\t\t\t\t\t}\" type: ${typeof response.status}`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tfetched.push({\n\t\t\t\t\t\turl: same_origin ? url.href.slice(event.url.origin.length) : url.href,\n\t\t\t\t\t\tmethod: event.request.method,\n\t\t\t\t\t\trequest_body: /** @type {string | ArrayBufferView | undefined} */ (\n\t\t\t\t\t\t\tinput instanceof Request && cloned_body\n\t\t\t\t\t\t\t\t? await stream_to_string(cloned_body)\n\t\t\t\t\t\t\t\t: init?.body\n\t\t\t\t\t\t),\n\t\t\t\t\t\trequest_headers: cloned_headers,\n\t\t\t\t\t\tresponse_body: body,\n\t\t\t\t\t\tresponse,\n\t\t\t\t\t\tis_b64\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (key === 'arrayBuffer') {\n\t\t\t\t\treturn async () => {\n\t\t\t\t\t\tconst buffer = await response.arrayBuffer();\n\n\t\t\t\t\t\tif (dependency) {\n\t\t\t\t\t\t\tdependency.body = new Uint8Array(buffer);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (buffer instanceof ArrayBuffer) {\n\t\t\t\t\t\t\tawait push_fetched(b64_encode(buffer), true);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn buffer;\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tasync function text() {\n\t\t\t\t\tconst body = await response.text();\n\n\t\t\t\t\tif (!body || typeof body === 'string') {\n\t\t\t\t\t\tawait push_fetched(body, false);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (dependency) {\n\t\t\t\t\t\tdependency.body = body;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn body;\n\t\t\t\t}\n\n\t\t\t\tif (key === 'text') {\n\t\t\t\t\treturn text;\n\t\t\t\t}\n\n\t\t\t\tif (key === 'json') {\n\t\t\t\t\treturn async () => {\n\t\t\t\t\t\treturn JSON.parse(await text());\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn Reflect.get(response, key, response);\n\t\t\t}\n\t\t});\n\n\t\tif (csr) {\n\t\t\t// ensure that excluded headers can't be read\n\t\t\tconst get = response.headers.get;\n\t\t\tresponse.headers.get = (key) => {\n\t\t\t\tconst lower = key.toLowerCase();\n\t\t\t\tconst value = get.call(response.headers, lower);\n\t\t\t\tif (value && !lower.startsWith('x-sveltekit-')) {\n\t\t\t\t\tconst included = resolve_opts.filterSerializedResponseHeaders(lower, value);\n\t\t\t\t\tif (!included) {\n\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t`Failed to get response header \"${lower}\" — it must be included by the \\`filterSerializedResponseHeaders\\` option: https://svelte.dev/docs/kit/hooks#Server-hooks-handle (at ${event.route.id})`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn value;\n\t\t\t};\n\t\t}\n\n\t\treturn proxy;\n\t};\n\n\t// Don't make this function `async`! Otherwise, the user has to `catch` promises they use for streaming responses or else\n\t// it will be an unhandled rejection. Instead, we add a `.catch(() => {})` ourselves below to this from happening.\n\treturn (input, init) => {\n\t\t// See docs in fetch.js for why we need to do this\n\t\tconst response = universal_fetch(input, init);\n\t\tresponse.catch(() => {});\n\t\treturn response;\n\t};\n}\n\n/**\n * @param {ReadableStream<Uint8Array>} stream\n */\nasync function stream_to_string(stream) {\n\tlet result = '';\n\tconst reader = stream.getReader();\n\tconst decoder = new TextDecoder();\n\twhile (true) {\n\t\tconst { done, value } = await reader.read();\n\t\tif (done) {\n\t\t\tbreak;\n\t\t}\n\t\tresult += decoder.decode(value);\n\t}\n\treturn result;\n}\n\n/**\n * @param {any} data\n * @param {string} [id]\n */\nfunction validate_load_response(data, id) {\n\tif (data != null && Object.getPrototypeOf(data) !== Object.prototype) {\n\t\tthrow new Error(\n\t\t\t`a load function in ${id} returned ${\n\t\t\t\ttypeof data !== 'object'\n\t\t\t\t\t? `a ${typeof data}`\n\t\t\t\t\t: data instanceof Response\n\t\t\t\t\t\t? 'a Response object'\n\t\t\t\t\t\t: Array.isArray(data)\n\t\t\t\t\t\t\t? 'an array'\n\t\t\t\t\t\t\t: 'a non-plain object'\n\t\t\t}, but must return a plain object at the top level (i.e. \\`return {...}\\`)`\n\t\t);\n\t}\n}\n","/**\n * Hash using djb2\n * @param {import('types').StrictBody[]} values\n */\nexport function hash(...values) {\n\tlet hash = 5381;\n\n\tfor (const value of values) {\n\t\tif (typeof value === 'string') {\n\t\t\tlet i = value.length;\n\t\t\twhile (i) hash = (hash * 33) ^ value.charCodeAt(--i);\n\t\t} else if (ArrayBuffer.isView(value)) {\n\t\t\tconst buffer = new Uint8Array(value.buffer, value.byteOffset, value.byteLength);\n\t\t\tlet i = buffer.length;\n\t\t\twhile (i) hash = (hash * 33) ^ buffer[--i];\n\t\t} else {\n\t\t\tthrow new TypeError('value must be a string or TypedArray');\n\t\t}\n\t}\n\n\treturn (hash >>> 0).toString(36);\n}\n","import { escape_html } from '../../../utils/escape.js';\nimport { hash } from '../../hash.js';\n\n/**\n * Inside a script element, only `</script` and `<!--` hold special meaning to the HTML parser.\n *\n * The first closes the script element, so everything after is treated as raw HTML.\n * The second disables further parsing until `-->`, so the script element might be unexpectedly\n * kept open until until an unrelated HTML comment in the page.\n *\n * U+2028 LINE SEPARATOR and U+2029 PARAGRAPH SEPARATOR are escaped for the sake of pre-2018\n * browsers.\n *\n * @see tests for unsafe parsing examples.\n * @see https://html.spec.whatwg.org/multipage/scripting.html#restrictions-for-contents-of-script-elements\n * @see https://html.spec.whatwg.org/multipage/syntax.html#cdata-rcdata-restrictions\n * @see https://html.spec.whatwg.org/multipage/parsing.html#script-data-state\n * @see https://html.spec.whatwg.org/multipage/parsing.html#script-data-double-escaped-state\n * @see https://github.com/tc39/proposal-json-superset\n * @type {Record<string, string>}\n */\nconst replacements = {\n\t'<': '\\\\u003C',\n\t'\\u2028': '\\\\u2028',\n\t'\\u2029': '\\\\u2029'\n};\n\nconst pattern = new RegExp(`[${Object.keys(replacements).join('')}]`, 'g');\n\n/**\n * Generates a raw HTML string containing a safe script element carrying data and associated attributes.\n *\n * It escapes all the special characters needed to guarantee the element is unbroken, but care must\n * be taken to ensure it is inserted in the document at an acceptable position for a script element,\n * and that the resulting string isn't further modified.\n *\n * @param {import('./types.js').Fetched} fetched\n * @param {(name: string, value: string) => boolean} filter\n * @param {boolean} [prerendering]\n * @returns {string} The raw HTML of a script element carrying the JSON payload.\n * @example const html = serialize_data('/data.json', null, { foo: 'bar' });\n */\nexport function serialize_data(fetched, filter, prerendering = false) {\n\t/** @type {Record<string, string>} */\n\tconst headers = {};\n\n\tlet cache_control = null;\n\tlet age = null;\n\tlet varyAny = false;\n\n\tfor (const [key, value] of fetched.response.headers) {\n\t\tif (filter(key, value)) {\n\t\t\theaders[key] = value;\n\t\t}\n\n\t\tif (key === 'cache-control') cache_control = value;\n\t\telse if (key === 'age') age = value;\n\t\telse if (key === 'vary' && value.trim() === '*') varyAny = true;\n\t}\n\n\tconst payload = {\n\t\tstatus: fetched.response.status,\n\t\tstatusText: fetched.response.statusText,\n\t\theaders,\n\t\tbody: fetched.response_body\n\t};\n\n\tconst safe_payload = JSON.stringify(payload).replace(pattern, (match) => replacements[match]);\n\n\tconst attrs = [\n\t\t'type=\"application/json\"',\n\t\t'data-sveltekit-fetched',\n\t\t`data-url=\"${escape_html(fetched.url, true)}\"`\n\t];\n\n\tif (fetched.is_b64) {\n\t\tattrs.push('data-b64');\n\t}\n\n\tif (fetched.request_headers || fetched.request_body) {\n\t\t/** @type {import('types').StrictBody[]} */\n\t\tconst values = [];\n\n\t\tif (fetched.request_headers) {\n\t\t\tvalues.push([...new Headers(fetched.request_headers)].join(','));\n\t\t}\n\n\t\tif (fetched.request_body) {\n\t\t\tvalues.push(fetched.request_body);\n\t\t}\n\n\t\tattrs.push(`data-hash=\"${hash(...values)}\"`);\n\t}\n\n\t// Compute the time the response should be cached, taking into account max-age and age.\n\t// Do not cache at all if a `Vary: *` header is present, as this indicates that the\n\t// cache is likely to get busted.\n\tif (!prerendering && fetched.method === 'GET' && cache_control && !varyAny) {\n\t\tconst match = /s-maxage=(\\d+)/g.exec(cache_control) ?? /max-age=(\\d+)/g.exec(cache_control);\n\t\tif (match) {\n\t\t\tconst ttl = +match[1] - +(age ?? '0');\n\t\t\tattrs.push(`data-ttl=\"${ttl}\"`);\n\t\t}\n\t}\n\n\treturn `<script ${attrs.join(' ')}>${safe_payload}</script>`;\n}\n","export const s = JSON.stringify;\n","const encoder = new TextEncoder();\n\n/**\n * SHA-256 hashing function adapted from https://bitwiseshiftleft.github.io/sjcl\n * modified and redistributed under BSD license\n * @param {string} data\n */\nexport function sha256(data) {\n\tif (!key[0]) precompute();\n\n\tconst out = init.slice(0);\n\tconst array = encode(data);\n\n\tfor (let i = 0; i < array.length; i += 16) {\n\t\tconst w = array.subarray(i, i + 16);\n\n\t\tlet tmp;\n\t\tlet a;\n\t\tlet b;\n\n\t\tlet out0 = out[0];\n\t\tlet out1 = out[1];\n\t\tlet out2 = out[2];\n\t\tlet out3 = out[3];\n\t\tlet out4 = out[4];\n\t\tlet out5 = out[5];\n\t\tlet out6 = out[6];\n\t\tlet out7 = out[7];\n\n\t\t/* Rationale for placement of |0 :\n\t\t * If a value can overflow is original 32 bits by a factor of more than a few\n\t\t * million (2^23 ish), there is a possibility that it might overflow the\n\t\t * 53-bit mantissa and lose precision.\n\t\t *\n\t\t * To avoid this, we clamp back to 32 bits by |'ing with 0 on any value that\n\t\t * propagates around the loop, and on the hash state out[]. I don't believe\n\t\t * that the clamps on out4 and on out0 are strictly necessary, but it's close\n\t\t * (for out4 anyway), and better safe than sorry.\n\t\t *\n\t\t * The clamps on out[] are necessary for the output to be correct even in the\n\t\t * common case and for short inputs.\n\t\t */\n\n\t\tfor (let i = 0; i < 64; i++) {\n\t\t\t// load up the input word for this round\n\n\t\t\tif (i < 16) {\n\t\t\t\ttmp = w[i];\n\t\t\t} else {\n\t\t\t\ta = w[(i + 1) & 15];\n\n\t\t\t\tb = w[(i + 14) & 15];\n\n\t\t\t\ttmp = w[i & 15] =\n\t\t\t\t\t(((a >>> 7) ^ (a >>> 18) ^ (a >>> 3) ^ (a << 25) ^ (a << 14)) +\n\t\t\t\t\t\t((b >>> 17) ^ (b >>> 19) ^ (b >>> 10) ^ (b << 15) ^ (b << 13)) +\n\t\t\t\t\t\tw[i & 15] +\n\t\t\t\t\t\tw[(i + 9) & 15]) |\n\t\t\t\t\t0;\n\t\t\t}\n\n\t\t\ttmp =\n\t\t\t\ttmp +\n\t\t\t\tout7 +\n\t\t\t\t((out4 >>> 6) ^ (out4 >>> 11) ^ (out4 >>> 25) ^ (out4 << 26) ^ (out4 << 21) ^ (out4 << 7)) +\n\t\t\t\t(out6 ^ (out4 & (out5 ^ out6))) +\n\t\t\t\tkey[i]; // | 0;\n\n\t\t\t// shift register\n\t\t\tout7 = out6;\n\t\t\tout6 = out5;\n\t\t\tout5 = out4;\n\n\t\t\tout4 = (out3 + tmp) | 0;\n\n\t\t\tout3 = out2;\n\t\t\tout2 = out1;\n\t\t\tout1 = out0;\n\n\t\t\tout0 =\n\t\t\t\t(tmp +\n\t\t\t\t\t((out1 & out2) ^ (out3 & (out1 ^ out2))) +\n\t\t\t\t\t((out1 >>> 2) ^\n\t\t\t\t\t\t(out1 >>> 13) ^\n\t\t\t\t\t\t(out1 >>> 22) ^\n\t\t\t\t\t\t(out1 << 30) ^\n\t\t\t\t\t\t(out1 << 19) ^\n\t\t\t\t\t\t(out1 << 10))) |\n\t\t\t\t0;\n\t\t}\n\n\t\tout[0] = (out[0] + out0) | 0;\n\t\tout[1] = (out[1] + out1) | 0;\n\t\tout[2] = (out[2] + out2) | 0;\n\t\tout[3] = (out[3] + out3) | 0;\n\t\tout[4] = (out[4] + out4) | 0;\n\t\tout[5] = (out[5] + out5) | 0;\n\t\tout[6] = (out[6] + out6) | 0;\n\t\tout[7] = (out[7] + out7) | 0;\n\t}\n\n\tconst bytes = new Uint8Array(out.buffer);\n\treverse_endianness(bytes);\n\n\treturn base64(bytes);\n}\n\n/** The SHA-256 initialization vector */\nconst init = new Uint32Array(8);\n\n/** The SHA-256 hash key */\nconst key = new Uint32Array(64);\n\n/** Function to precompute init and key. */\nfunction precompute() {\n\t/** @param {number} x */\n\tfunction frac(x) {\n\t\treturn (x - Math.floor(x)) * 0x100000000;\n\t}\n\n\tlet prime = 2;\n\n\tfor (let i = 0; i < 64; prime++) {\n\t\tlet is_prime = true;\n\n\t\tfor (let factor = 2; factor * factor <= prime; factor++) {\n\t\t\tif (prime % factor === 0) {\n\t\t\t\tis_prime = false;\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (is_prime) {\n\t\t\tif (i < 8) {\n\t\t\t\tinit[i] = frac(prime ** (1 / 2));\n\t\t\t}\n\n\t\t\tkey[i] = frac(prime ** (1 / 3));\n\n\t\t\ti++;\n\t\t}\n\t}\n}\n\n/** @param {Uint8Array} bytes */\nfunction reverse_endianness(bytes) {\n\tfor (let i = 0; i < bytes.length; i += 4) {\n\t\tconst a = bytes[i + 0];\n\t\tconst b = bytes[i + 1];\n\t\tconst c = bytes[i + 2];\n\t\tconst d = bytes[i + 3];\n\n\t\tbytes[i + 0] = d;\n\t\tbytes[i + 1] = c;\n\t\tbytes[i + 2] = b;\n\t\tbytes[i + 3] = a;\n\t}\n}\n\n/** @param {string} str */\nfunction encode(str) {\n\tconst encoded = encoder.encode(str);\n\tconst length = encoded.length * 8;\n\n\t// result should be a multiple of 512 bits in length,\n\t// with room for a 1 (after the data) and two 32-bit\n\t// words containing the original input bit length\n\tconst size = 512 * Math.ceil((length + 65) / 512);\n\tconst bytes = new Uint8Array(size / 8);\n\tbytes.set(encoded);\n\n\t// append a 1\n\tbytes[encoded.length] = 0b10000000;\n\n\treverse_endianness(bytes);\n\n\t// add the input bit length\n\tconst words = new Uint32Array(bytes.buffer);\n\twords[words.length - 2] = Math.floor(length / 0x100000000); // this will always be zero for us\n\twords[words.length - 1] = length;\n\n\treturn words;\n}\n\n/*\n\tBased on https://gist.github.com/enepomnyaschih/72c423f727d395eeaa09697058238727\n\n\tMIT License\n\tCopyright (c) 2020 Egor Nepomnyaschih\n\tPermission is hereby granted, free of charge, to any person obtaining a copy\n\tof this software and associated documentation files (the \"Software\"), to deal\n\tin the Software without restriction, including without limitation the rights\n\tto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\tcopies of the Software, and to permit persons to whom the Software is\n\tfurnished to do so, subject to the following conditions:\n\tThe above copyright notice and this permission notice shall be included in all\n\tcopies or substantial portions of the Software.\n\tTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\tIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\tFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\tAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\tLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\tOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n\tSOFTWARE.\n*/\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'.split('');\n\n/** @param {Uint8Array} bytes */\nexport function base64(bytes) {\n\tconst l = bytes.length;\n\n\tlet result = '';\n\tlet i;\n\n\tfor (i = 2; i < l; i += 3) {\n\t\tresult += chars[bytes[i - 2] >> 2];\n\t\tresult += chars[((bytes[i - 2] & 0x03) << 4) | (bytes[i - 1] >> 4)];\n\t\tresult += chars[((bytes[i - 1] & 0x0f) << 2) | (bytes[i] >> 6)];\n\t\tresult += chars[bytes[i] & 0x3f];\n\t}\n\n\tif (i === l + 1) {\n\t\t// 1 octet yet to write\n\t\tresult += chars[bytes[i - 2] >> 2];\n\t\tresult += chars[(bytes[i - 2] & 0x03) << 4];\n\t\tresult += '==';\n\t}\n\n\tif (i === l) {\n\t\t// 2 octets yet to write\n\t\tresult += chars[bytes[i - 2] >> 2];\n\t\tresult += chars[((bytes[i - 2] & 0x03) << 4) | (bytes[i - 1] >> 4)];\n\t\tresult += chars[(bytes[i - 1] & 0x0f) << 2];\n\t\tresult += '=';\n\t}\n\n\treturn result;\n}\n","import { escape_html } from '../../../utils/escape.js';\nimport { base64, sha256 } from './crypto.js';\n\nconst array = new Uint8Array(16);\n\nfunction generate_nonce() {\n\tcrypto.getRandomValues(array);\n\treturn base64(array);\n}\n\nconst quoted = new Set([\n\t'self',\n\t'unsafe-eval',\n\t'unsafe-hashes',\n\t'unsafe-inline',\n\t'none',\n\t'strict-dynamic',\n\t'report-sample',\n\t'wasm-unsafe-eval',\n\t'script'\n]);\n\nconst crypto_pattern = /^(nonce|sha\\d\\d\\d)-/;\n\n// CSP and CSP Report Only are extremely similar with a few caveats\n// the easiest/DRYest way to express this is with some private encapsulation\nclass BaseProvider {\n\t/** @type {boolean} */\n\t#use_hashes;\n\n\t/** @type {boolean} */\n\t#script_needs_csp;\n\n\t/** @type {boolean} */\n\t#script_src_needs_csp;\n\n\t/** @type {boolean} */\n\t#script_src_elem_needs_csp;\n\n\t/** @type {boolean} */\n\t#style_needs_csp;\n\n\t/** @type {boolean} */\n\t#style_src_needs_csp;\n\n\t/** @type {boolean} */\n\t#style_src_attr_needs_csp;\n\n\t/** @type {boolean} */\n\t#style_src_elem_needs_csp;\n\n\t/** @type {import('types').CspDirectives} */\n\t#directives;\n\n\t/** @type {import('types').Csp.Source[]} */\n\t#script_src;\n\n\t/** @type {import('types').Csp.Source[]} */\n\t#script_src_elem;\n\n\t/** @type {import('types').Csp.Source[]} */\n\t#style_src;\n\n\t/** @type {import('types').Csp.Source[]} */\n\t#style_src_attr;\n\n\t/** @type {import('types').Csp.Source[]} */\n\t#style_src_elem;\n\n\t/** @type {string} */\n\t#nonce;\n\n\t/**\n\t * @param {boolean} use_hashes\n\t * @param {import('types').CspDirectives} directives\n\t * @param {string} nonce\n\t */\n\tconstructor(use_hashes, directives, nonce) {\n\t\tthis.#use_hashes = use_hashes;\n\t\tthis.#directives = __SVELTEKIT_DEV__ ? { ...directives } : directives; // clone in dev so we can safely mutate\n\n\t\tconst d = this.#directives;\n\n\t\tthis.#script_src = [];\n\t\tthis.#script_src_elem = [];\n\t\tthis.#style_src = [];\n\t\tthis.#style_src_attr = [];\n\t\tthis.#style_src_elem = [];\n\n\t\tconst effective_script_src = d['script-src'] || d['default-src'];\n\t\tconst script_src_elem = d['script-src-elem'];\n\t\tconst effective_style_src = d['style-src'] || d['default-src'];\n\t\tconst style_src_attr = d['style-src-attr'];\n\t\tconst style_src_elem = d['style-src-elem'];\n\n\t\tif (__SVELTEKIT_DEV__) {\n\t\t\t// remove strict-dynamic in dev...\n\t\t\t// TODO reinstate this if we can figure out how to make strict-dynamic work\n\t\t\t// if (d['default-src']) {\n\t\t\t// \td['default-src'] = d['default-src'].filter((name) => name !== 'strict-dynamic');\n\t\t\t// \tif (d['default-src'].length === 0) delete d['default-src'];\n\t\t\t// }\n\n\t\t\t// if (d['script-src']) {\n\t\t\t// \td['script-src'] = d['script-src'].filter((name) => name !== 'strict-dynamic');\n\t\t\t// \tif (d['script-src'].length === 0) delete d['script-src'];\n\t\t\t// }\n\n\t\t\t// ...and add unsafe-inline so we can inject <style> elements\n\t\t\t// Note that 'unsafe-inline' is ignored if either a hash or nonce value is present in the source list, so we remove those during dev when injecting unsafe-inline\n\t\t\tif (effective_style_src && !effective_style_src.includes('unsafe-inline')) {\n\t\t\t\td['style-src'] = [\n\t\t\t\t\t...effective_style_src.filter(\n\t\t\t\t\t\t(value) => !(value.startsWith('sha256-') || value.startsWith('nonce-'))\n\t\t\t\t\t),\n\t\t\t\t\t'unsafe-inline'\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tif (style_src_attr && !style_src_attr.includes('unsafe-inline')) {\n\t\t\t\td['style-src-attr'] = [\n\t\t\t\t\t...style_src_attr.filter(\n\t\t\t\t\t\t(value) => !(value.startsWith('sha256-') || value.startsWith('nonce-'))\n\t\t\t\t\t),\n\t\t\t\t\t'unsafe-inline'\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tif (style_src_elem && !style_src_elem.includes('unsafe-inline')) {\n\t\t\t\td['style-src-elem'] = [\n\t\t\t\t\t...style_src_elem.filter(\n\t\t\t\t\t\t(value) => !(value.startsWith('sha256-') || value.startsWith('nonce-'))\n\t\t\t\t\t),\n\t\t\t\t\t'unsafe-inline'\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\n\t\t/** @param {(import('types').Csp.Source | import('types').Csp.ActionSource)[] | undefined} directive */\n\t\tconst needs_csp = (directive) =>\n\t\t\t!!directive && !directive.some((value) => value === 'unsafe-inline');\n\n\t\tthis.#script_src_needs_csp = needs_csp(effective_script_src);\n\t\tthis.#script_src_elem_needs_csp = needs_csp(script_src_elem);\n\t\tthis.#style_src_needs_csp = needs_csp(effective_style_src);\n\t\tthis.#style_src_attr_needs_csp = needs_csp(style_src_attr);\n\t\tthis.#style_src_elem_needs_csp = needs_csp(style_src_elem);\n\n\t\tthis.#script_needs_csp = this.#script_src_needs_csp || this.#script_src_elem_needs_csp;\n\t\tthis.#style_needs_csp =\n\t\t\t!__SVELTEKIT_DEV__ &&\n\t\t\t(this.#style_src_needs_csp ||\n\t\t\t\tthis.#style_src_attr_needs_csp ||\n\t\t\t\tthis.#style_src_elem_needs_csp);\n\n\t\tthis.script_needs_nonce = this.#script_needs_csp && !this.#use_hashes;\n\t\tthis.style_needs_nonce = this.#style_needs_csp && !this.#use_hashes;\n\n\t\tthis.#nonce = nonce;\n\t}\n\n\t/** @param {string} content */\n\tadd_script(content) {\n\t\tif (!this.#script_needs_csp) return;\n\n\t\t/** @type {`nonce-${string}` | `sha256-${string}`} */\n\t\tconst source = this.#use_hashes ? `sha256-${sha256(content)}` : `nonce-${this.#nonce}`;\n\n\t\tif (this.#script_src_needs_csp) {\n\t\t\tthis.#script_src.push(source);\n\t\t}\n\n\t\tif (this.#script_src_elem_needs_csp) {\n\t\t\tthis.#script_src_elem.push(source);\n\t\t}\n\t}\n\n\t/** @param {string} content */\n\tadd_style(content) {\n\t\tif (!this.#style_needs_csp) return;\n\n\t\t/** @type {`nonce-${string}` | `sha256-${string}`} */\n\t\tconst source = this.#use_hashes ? `sha256-${sha256(content)}` : `nonce-${this.#nonce}`;\n\n\t\tif (this.#style_src_needs_csp) {\n\t\t\tthis.#style_src.push(source);\n\t\t}\n\n\t\tif (this.#style_src_attr_needs_csp) {\n\t\t\tthis.#style_src_attr.push(source);\n\t\t}\n\n\t\tif (this.#style_src_elem_needs_csp) {\n\t\t\t// this is the sha256 hash for the string \"/* empty */\"\n\t\t\t// adding it so that svelte does not break csp\n\t\t\t// see https://github.com/sveltejs/svelte/pull/7800\n\t\t\tconst sha256_empty_comment_hash = 'sha256-9OlNO0DNEeaVzHL4RZwCLsBHA8WBQ8toBp/4F5XV2nc=';\n\t\t\tconst d = this.#directives;\n\n\t\t\tif (\n\t\t\t\td['style-src-elem'] &&\n\t\t\t\t!d['style-src-elem'].includes(sha256_empty_comment_hash) &&\n\t\t\t\t!this.#style_src_elem.includes(sha256_empty_comment_hash)\n\t\t\t) {\n\t\t\t\tthis.#style_src_elem.push(sha256_empty_comment_hash);\n\t\t\t}\n\n\t\t\tif (source !== sha256_empty_comment_hash) {\n\t\t\t\tthis.#style_src_elem.push(source);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @param {boolean} [is_meta]\n\t */\n\tget_header(is_meta = false) {\n\t\tconst header = [];\n\n\t\t// due to browser inconsistencies, we can't append sources to default-src\n\t\t// (specifically, Firefox appears to not ignore nonce-{nonce} directives\n\t\t// on default-src), so we ensure that script-src and style-src exist\n\n\t\tconst directives = { ...this.#directives };\n\n\t\tif (this.#style_src.length > 0) {\n\t\t\tdirectives['style-src'] = [\n\t\t\t\t...(directives['style-src'] || directives['default-src'] || []),\n\t\t\t\t...this.#style_src\n\t\t\t];\n\t\t}\n\n\t\tif (this.#style_src_attr.length > 0) {\n\t\t\tdirectives['style-src-attr'] = [\n\t\t\t\t...(directives['style-src-attr'] || []),\n\t\t\t\t...this.#style_src_attr\n\t\t\t];\n\t\t}\n\n\t\tif (this.#style_src_elem.length > 0) {\n\t\t\tdirectives['style-src-elem'] = [\n\t\t\t\t...(directives['style-src-elem'] || []),\n\t\t\t\t...this.#style_src_elem\n\t\t\t];\n\t\t}\n\n\t\tif (this.#script_src.length > 0) {\n\t\t\tdirectives['script-src'] = [\n\t\t\t\t...(directives['script-src'] || directives['default-src'] || []),\n\t\t\t\t...this.#script_src\n\t\t\t];\n\t\t}\n\n\t\tif (this.#script_src_elem.length > 0) {\n\t\t\tdirectives['script-src-elem'] = [\n\t\t\t\t...(directives['script-src-elem'] || []),\n\t\t\t\t...this.#script_src_elem\n\t\t\t];\n\t\t}\n\n\t\tfor (const key in directives) {\n\t\t\tif (is_meta && (key === 'frame-ancestors' || key === 'report-uri' || key === 'sandbox')) {\n\t\t\t\t// these values cannot be used with a <meta> tag\n\t\t\t\t// TODO warn?\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// @ts-expect-error gimme a break typescript, `key` is obviously a member of internal_directives\n\t\t\tconst value = /** @type {string[] | true} */ (directives[key]);\n\n\t\t\tif (!value) continue;\n\n\t\t\tconst directive = [key];\n\t\t\tif (Array.isArray(value)) {\n\t\t\t\tvalue.forEach((value) => {\n\t\t\t\t\tif (quoted.has(value) || crypto_pattern.test(value)) {\n\t\t\t\t\t\tdirective.push(`'${value}'`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdirective.push(value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\theader.push(directive.join(' '));\n\t\t}\n\n\t\treturn header.join('; ');\n\t}\n}\n\nclass CspProvider extends BaseProvider {\n\tget_meta() {\n\t\tconst content = this.get_header(true);\n\n\t\tif (!content) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn `<meta http-equiv=\"content-security-policy\" content=\"${escape_html(content, true)}\">`;\n\t}\n}\n\nclass CspReportOnlyProvider extends BaseProvider {\n\t/**\n\t * @param {boolean} use_hashes\n\t * @param {import('types').CspDirectives} directives\n\t * @param {string} nonce\n\t */\n\tconstructor(use_hashes, directives, nonce) {\n\t\tsuper(use_hashes, directives, nonce);\n\n\t\tif (Object.values(directives).filter((v) => !!v).length > 0) {\n\t\t\t// If we're generating content-security-policy-report-only,\n\t\t\t// if there are any directives, we need a report-uri or report-to (or both)\n\t\t\t// else it's just an expensive noop.\n\t\t\tconst has_report_to = directives['report-to']?.length ?? 0 > 0;\n\t\t\tconst has_report_uri = directives['report-uri']?.length ?? 0 > 0;\n\t\t\tif (!has_report_to && !has_report_uri) {\n\t\t\t\tthrow Error(\n\t\t\t\t\t'`content-security-policy-report-only` must be specified with either the `report-to` or `report-uri` directives, or both'\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class Csp {\n\t/** @readonly */\n\tnonce = generate_nonce();\n\n\t/** @type {CspProvider} */\n\tcsp_provider;\n\n\t/** @type {CspReportOnlyProvider} */\n\treport_only_provider;\n\n\t/**\n\t * @param {import('./types.js').CspConfig} config\n\t * @param {import('./types.js').CspOpts} opts\n\t */\n\tconstructor({ mode, directives, reportOnly }, { prerender }) {\n\t\tconst use_hashes = mode === 'hash' || (mode === 'auto' && prerender);\n\t\tthis.csp_provider = new CspProvider(use_hashes, directives, this.nonce);\n\t\tthis.report_only_provider = new CspReportOnlyProvider(use_hashes, reportOnly, this.nonce);\n\t}\n\n\tget script_needs_nonce() {\n\t\treturn this.csp_provider.script_needs_nonce || this.report_only_provider.script_needs_nonce;\n\t}\n\n\tget style_needs_nonce() {\n\t\treturn this.csp_provider.style_needs_nonce || this.report_only_provider.style_needs_nonce;\n\t}\n\n\t/** @param {string} content */\n\tadd_script(content) {\n\t\tthis.csp_provider.add_script(content);\n\t\tthis.report_only_provider.add_script(content);\n\t}\n\n\t/** @param {string} content */\n\tadd_style(content) {\n\t\tthis.csp_provider.add_style(content);\n\t\tthis.report_only_provider.add_style(content);\n\t}\n}\n","/**\n * @returns {import('types').Deferred & { promise: Promise<any> }}}\n */\nfunction defer() {\n\tlet fulfil;\n\tlet reject;\n\n\tconst promise = new Promise((f, r) => {\n\t\tfulfil = f;\n\t\treject = r;\n\t});\n\n\t// @ts-expect-error\n\treturn { promise, fulfil, reject };\n}\n\n/**\n * Create an async iterator and a function to push values into it\n * @returns {{\n *   iterator: AsyncIterable<any>;\n *   push: (value: any) => void;\n *   done: () => void;\n * }}\n */\nexport function create_async_iterator() {\n\tconst deferred = [defer()];\n\n\treturn {\n\t\titerator: {\n\t\t\t[Symbol.asyncIterator]() {\n\t\t\t\treturn {\n\t\t\t\t\tnext: async () => {\n\t\t\t\t\t\tconst next = await deferred[0].promise;\n\t\t\t\t\t\tif (!next.done) deferred.shift();\n\t\t\t\t\t\treturn next;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\tpush: (value) => {\n\t\t\tdeferred[deferred.length - 1].fulfil({\n\t\t\t\tvalue,\n\t\t\t\tdone: false\n\t\t\t});\n\t\t\tdeferred.push(defer());\n\t\t},\n\t\tdone: () => {\n\t\t\tdeferred[deferred.length - 1].fulfil({ done: true });\n\t\t}\n\t};\n}\n","import { BROWSER } from 'esm-env';\n\nconst param_pattern = /^(\\[)?(\\.\\.\\.)?(\\w+)(?:=(\\w+))?(\\])?$/;\n\n/**\n * Creates the regex pattern, extracts parameter names, and generates types for a route\n * @param {string} id\n */\nexport function parse_route_id(id) {\n\t/** @type {import('types').RouteParam[]} */\n\tconst params = [];\n\n\tconst pattern =\n\t\tid === '/'\n\t\t\t? /^\\/$/\n\t\t\t: new RegExp(\n\t\t\t\t\t`^${get_route_segments(id)\n\t\t\t\t\t\t.map((segment) => {\n\t\t\t\t\t\t\t// special case — /[...rest]/ could contain zero segments\n\t\t\t\t\t\t\tconst rest_match = /^\\[\\.\\.\\.(\\w+)(?:=(\\w+))?\\]$/.exec(segment);\n\t\t\t\t\t\t\tif (rest_match) {\n\t\t\t\t\t\t\t\tparams.push({\n\t\t\t\t\t\t\t\t\tname: rest_match[1],\n\t\t\t\t\t\t\t\t\tmatcher: rest_match[2],\n\t\t\t\t\t\t\t\t\toptional: false,\n\t\t\t\t\t\t\t\t\trest: true,\n\t\t\t\t\t\t\t\t\tchained: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\treturn '(?:/(.*))?';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// special case — /[[optional]]/ could contain zero segments\n\t\t\t\t\t\t\tconst optional_match = /^\\[\\[(\\w+)(?:=(\\w+))?\\]\\]$/.exec(segment);\n\t\t\t\t\t\t\tif (optional_match) {\n\t\t\t\t\t\t\t\tparams.push({\n\t\t\t\t\t\t\t\t\tname: optional_match[1],\n\t\t\t\t\t\t\t\t\tmatcher: optional_match[2],\n\t\t\t\t\t\t\t\t\toptional: true,\n\t\t\t\t\t\t\t\t\trest: false,\n\t\t\t\t\t\t\t\t\tchained: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\treturn '(?:/([^/]+))?';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!segment) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst parts = segment.split(/\\[(.+?)\\](?!\\])/);\n\t\t\t\t\t\t\tconst result = parts\n\t\t\t\t\t\t\t\t.map((content, i) => {\n\t\t\t\t\t\t\t\t\tif (i % 2) {\n\t\t\t\t\t\t\t\t\t\tif (content.startsWith('x+')) {\n\t\t\t\t\t\t\t\t\t\t\treturn escape(String.fromCharCode(parseInt(content.slice(2), 16)));\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif (content.startsWith('u+')) {\n\t\t\t\t\t\t\t\t\t\t\treturn escape(\n\t\t\t\t\t\t\t\t\t\t\t\tString.fromCharCode(\n\t\t\t\t\t\t\t\t\t\t\t\t\t...content\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.slice(2)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.split('-')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map((code) => parseInt(code, 16))\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// We know the match cannot be null in the browser because manifest generation\n\t\t\t\t\t\t\t\t\t\t// would have invoked this during build and failed if we hit an invalid\n\t\t\t\t\t\t\t\t\t\t// param/matcher name with non-alphanumeric character.\n\t\t\t\t\t\t\t\t\t\tconst match = /** @type {RegExpExecArray} */ (param_pattern.exec(content));\n\t\t\t\t\t\t\t\t\t\tif (!BROWSER && !match) {\n\t\t\t\t\t\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t\t\t\t\t\t`Invalid param: ${content}. Params and matcher names can only have underscores and alphanumeric characters.`\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tconst [, is_optional, is_rest, name, matcher] = match;\n\t\t\t\t\t\t\t\t\t\t// It's assumed that the following invalid route id cases are already checked\n\t\t\t\t\t\t\t\t\t\t// - unbalanced brackets\n\t\t\t\t\t\t\t\t\t\t// - optional param following rest param\n\n\t\t\t\t\t\t\t\t\t\tparams.push({\n\t\t\t\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\t\t\t\tmatcher,\n\t\t\t\t\t\t\t\t\t\t\toptional: !!is_optional,\n\t\t\t\t\t\t\t\t\t\t\trest: !!is_rest,\n\t\t\t\t\t\t\t\t\t\t\tchained: is_rest ? i === 1 && parts[0] === '' : false\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn is_rest ? '(.*?)' : is_optional ? '([^/]*)?' : '([^/]+?)';\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn escape(content);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.join('');\n\n\t\t\t\t\t\t\treturn '/' + result;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.join('')}/?$`\n\t\t\t\t);\n\n\treturn { pattern, params };\n}\n\nconst optional_param_regex = /\\/\\[\\[\\w+?(?:=\\w+)?\\]\\]/;\n\n/**\n * Removes optional params from a route ID.\n * @param {string} id\n * @returns The route id with optional params removed\n */\nexport function remove_optional_params(id) {\n\treturn id.replace(optional_param_regex, '');\n}\n\n/**\n * Returns `false` for `(group)` segments\n * @param {string} segment\n */\nfunction affects_path(segment) {\n\treturn !/^\\([^)]+\\)$/.test(segment);\n}\n\n/**\n * Splits a route id into its segments, removing segments that\n * don't affect the path (i.e. groups). The root route is represented by `/`\n * and will be returned as `['']`.\n * @param {string} route\n * @returns string[]\n */\nexport function get_route_segments(route) {\n\treturn route.slice(1).split('/').filter(affects_path);\n}\n\n/**\n * @param {RegExpMatchArray} match\n * @param {import('types').RouteParam[]} params\n * @param {Record<string, import('@sveltejs/kit').ParamMatcher>} matchers\n */\nexport function exec(match, params, matchers) {\n\t/** @type {Record<string, string>} */\n\tconst result = {};\n\n\tconst values = match.slice(1);\n\tconst values_needing_match = values.filter((value) => value !== undefined);\n\n\tlet buffered = 0;\n\n\tfor (let i = 0; i < params.length; i += 1) {\n\t\tconst param = params[i];\n\t\tlet value = values[i - buffered];\n\n\t\t// in the `[[a=b]]/.../[...rest]` case, if one or more optional parameters\n\t\t// weren't matched, roll the skipped values into the rest\n\t\tif (param.chained && param.rest && buffered) {\n\t\t\tvalue = values\n\t\t\t\t.slice(i - buffered, i + 1)\n\t\t\t\t.filter((s) => s)\n\t\t\t\t.join('/');\n\n\t\t\tbuffered = 0;\n\t\t}\n\n\t\t// if `value` is undefined, it means this is an optional or rest parameter\n\t\tif (value === undefined) {\n\t\t\tif (param.rest) result[param.name] = '';\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!param.matcher || matchers[param.matcher](value)) {\n\t\t\tresult[param.name] = value;\n\n\t\t\t// Now that the params match, reset the buffer if the next param isn't the [...rest]\n\t\t\t// and the next value is defined, otherwise the buffer will cause us to skip values\n\t\t\tconst next_param = params[i + 1];\n\t\t\tconst next_value = values[i + 1];\n\t\t\tif (next_param && !next_param.rest && next_param.optional && next_value && param.chained) {\n\t\t\t\tbuffered = 0;\n\t\t\t}\n\n\t\t\t// There are no more params and no more values, but all non-empty values have been matched\n\t\t\tif (\n\t\t\t\t!next_param &&\n\t\t\t\t!next_value &&\n\t\t\t\tObject.keys(result).length === values_needing_match.length\n\t\t\t) {\n\t\t\t\tbuffered = 0;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\n\t\t// in the `/[[a=b]]/...` case, if the value didn't satisfy the matcher,\n\t\t// keep track of the number of skipped optional parameters and continue\n\t\tif (param.optional && param.chained) {\n\t\t\tbuffered++;\n\t\t\tcontinue;\n\t\t}\n\n\t\t// otherwise, if the matcher returns `false`, the route did not match\n\t\treturn;\n\t}\n\n\tif (buffered) return;\n\treturn result;\n}\n\n/** @param {string} str */\nfunction escape(str) {\n\treturn (\n\t\tstr\n\t\t\t.normalize()\n\t\t\t// escape [ and ] before escaping other characters, since they are used in the replacements\n\t\t\t.replace(/[[\\]]/g, '\\\\$&')\n\t\t\t// replace %, /, ? and # with their encoded versions because decode_pathname leaves them untouched\n\t\t\t.replace(/%/g, '%25')\n\t\t\t.replace(/\\//g, '%2[Ff]')\n\t\t\t.replace(/\\?/g, '%3[Ff]')\n\t\t\t.replace(/#/g, '%23')\n\t\t\t// escape characters that have special meaning in regex\n\t\t\t.replace(/[.*+?^${}()|\\\\]/g, '\\\\$&')\n\t);\n}\n\nconst basic_param_pattern = /\\[(\\[)?(\\.\\.\\.)?(\\w+?)(?:=(\\w+))?\\]\\]?/g;\n\n/**\n * Populate a route ID with params to resolve a pathname.\n * @example\n * ```js\n * resolveRoute(\n *   `/blog/[slug]/[...somethingElse]`,\n *   {\n *     slug: 'hello-world',\n *     somethingElse: 'something/else'\n *   }\n * ); // `/blog/hello-world/something/else`\n * ```\n * @param {string} id\n * @param {Record<string, string | undefined>} params\n * @returns {string}\n */\nexport function resolve_route(id, params) {\n\tconst segments = get_route_segments(id);\n\treturn (\n\t\t'/' +\n\t\tsegments\n\t\t\t.map((segment) =>\n\t\t\t\tsegment.replace(basic_param_pattern, (_, optional, rest, name) => {\n\t\t\t\t\tconst param_value = params[name];\n\n\t\t\t\t\t// This is nested so TS correctly narrows the type\n\t\t\t\t\tif (!param_value) {\n\t\t\t\t\t\tif (optional) return '';\n\t\t\t\t\t\tif (rest && param_value !== undefined) return '';\n\t\t\t\t\t\tthrow new Error(`Missing parameter '${name}' in route ${id}`);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (param_value.startsWith('/') || param_value.endsWith('/'))\n\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t`Parameter '${name}' in route ${id} cannot start or end with a slash -- this would cause an invalid route like foo//bar`\n\t\t\t\t\t\t);\n\t\t\t\t\treturn param_value;\n\t\t\t\t})\n\t\t\t)\n\t\t\t.filter(Boolean)\n\t\t\t.join('/')\n\t);\n}\n\n/**\n * @param {import('types').SSRNode} node\n * @returns {boolean}\n */\nexport function has_server_load(node) {\n\treturn node.server?.load !== undefined || node.server?.trailingSlash !== undefined;\n}\n","import { base, assets, relative } from '__sveltekit/paths';\nimport { text } from '../../../exports/index.js';\nimport { s } from '../../../utils/misc.js';\nimport { exec } from '../../../utils/routing.js';\nimport { decode_params } from '../../../utils/url.js';\nimport { get_relative_path } from '../../utils.js';\n\n/**\n * @param {import('types').SSRClientRoute} route\n * @param {URL} url\n * @param {import('@sveltejs/kit').SSRManifest} manifest\n * @returns {string}\n */\nexport function generate_route_object(route, url, manifest) {\n\tconst { errors, layouts, leaf } = route;\n\n\tconst nodes = [...errors, ...layouts.map((l) => l?.[1]), leaf[1]]\n\t\t.filter((n) => typeof n === 'number')\n\t\t.map((n) => `'${n}': () => ${create_client_import(manifest._.client.nodes?.[n], url)}`)\n\t\t.join(',\\n\\t\\t');\n\n\t// stringified version of\n\t/** @type {import('types').CSRRouteServer} */\n\treturn [\n\t\t`{\\n\\tid: ${s(route.id)}`,\n\t\t`errors: ${s(route.errors)}`,\n\t\t`layouts: ${s(route.layouts)}`,\n\t\t`leaf: ${s(route.leaf)}`,\n\t\t`nodes: {\\n\\t\\t${nodes}\\n\\t}\\n}`\n\t].join(',\\n\\t');\n}\n\n/**\n * @param {string | undefined} import_path\n * @param {URL} url\n */\nfunction create_client_import(import_path, url) {\n\tif (!import_path) return 'Promise.resolve({})';\n\n\t// During DEV, Vite will make the paths absolute (e.g. /@fs/...)\n\tif (import_path[0] === '/') {\n\t\treturn `import('${import_path}')`;\n\t}\n\n\t// During PROD, they're root-relative\n\tif (assets !== '') {\n\t\treturn `import('${assets}/${import_path}')`;\n\t}\n\n\tif (!relative) {\n\t\treturn `import('${base}/${import_path}')`;\n\t}\n\n\t// Else we make them relative to the server-side route resolution request\n\t// to support IPFS, the internet archive, etc.\n\tlet path = get_relative_path(url.pathname, `${base}/${import_path}`);\n\tif (path[0] !== '.') path = `./${path}`;\n\treturn `import('${path}')`;\n}\n\n/**\n * @param {string} resolved_path\n * @param {URL} url\n * @param {import('@sveltejs/kit').SSRManifest} manifest\n * @returns {Promise<Response>}\n */\nexport async function resolve_route(resolved_path, url, manifest) {\n\tif (!manifest._.client.routes) {\n\t\treturn text('Server-side route resolution disabled', { status: 400 });\n\t}\n\n\t/** @type {import('types').SSRClientRoute | null} */\n\tlet route = null;\n\t/** @type {Record<string, string>} */\n\tlet params = {};\n\n\tconst matchers = await manifest._.matchers();\n\n\tfor (const candidate of manifest._.client.routes) {\n\t\tconst match = candidate.pattern.exec(resolved_path);\n\t\tif (!match) continue;\n\n\t\tconst matched = exec(match, candidate.params, matchers);\n\t\tif (matched) {\n\t\t\troute = candidate;\n\t\t\tparams = decode_params(matched);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn create_server_routing_response(route, params, url, manifest).response;\n}\n\n/**\n * @param {import('types').SSRClientRoute | null} route\n * @param {Partial<Record<string, string>>} params\n * @param {URL} url\n * @param {import('@sveltejs/kit').SSRManifest} manifest\n * @returns {{response: Response, body: string}}\n */\nexport function create_server_routing_response(route, params, url, manifest) {\n\tconst headers = new Headers({\n\t\t'content-type': 'application/javascript; charset=utf-8'\n\t});\n\n\tif (route) {\n\t\tconst csr_route = generate_route_object(route, url, manifest);\n\t\tconst body = `${create_css_import(route, url, manifest)}\\nexport const route = ${csr_route}; export const params = ${JSON.stringify(params)};`;\n\n\t\treturn { response: text(body, { headers }), body };\n\t} else {\n\t\treturn { response: text('', { headers }), body: '' };\n\t}\n}\n\n/**\n * This function generates the client-side import for the CSS files that are\n * associated with the current route. Vite takes care of that when using\n * client-side route resolution, but for server-side resolution it does\n * not know about the CSS files automatically.\n *\n * @param {import('types').SSRClientRoute} route\n * @param {URL} url\n * @param {import('@sveltejs/kit').SSRManifest} manifest\n * @returns {string}\n */\nfunction create_css_import(route, url, manifest) {\n\tconst { errors, layouts, leaf } = route;\n\n\tlet css = '';\n\n\tfor (const node of [...errors, ...layouts.map((l) => l?.[1]), leaf[1]]) {\n\t\tif (typeof node !== 'number') continue;\n\t\tconst node_css = manifest._.client.css?.[node];\n\t\tfor (const css_path of node_css ?? []) {\n\t\t\tcss += `'${assets || base}/${css_path}',`;\n\t\t}\n\t}\n\n\tif (!css) return '';\n\n\treturn `${create_client_import(/** @type {string} */ (manifest._.client.start), url)}.then(x => x.load_css([${css}]));`;\n}\n","import * as devalue from 'devalue';\nimport { readable, writable } from 'svelte/store';\nimport { DEV } from 'esm-env';\nimport * as paths from '__sveltekit/paths';\nimport { hash } from '../../hash.js';\nimport { serialize_data } from './serialize_data.js';\nimport { s } from '../../../utils/misc.js';\nimport { Csp } from './csp.js';\nimport { uneval_action_response } from './actions.js';\nimport { clarify_devalue_error, handle_error_and_jsonify, serialize_uses } from '../utils.js';\nimport { public_env, safe_public_env } from '../../shared-server.js';\nimport { text } from '../../../exports/index.js';\nimport { create_async_iterator } from '../../../utils/streaming.js';\nimport { SVELTE_KIT_ASSETS } from '../../../constants.js';\nimport { SCHEME } from '../../../utils/url.js';\nimport { create_server_routing_response, generate_route_object } from './server_routing.js';\nimport { add_resolution_suffix } from '../../pathname.js';\n\n// TODO rename this function/module\n\nconst updated = {\n\t...readable(false),\n\tcheck: () => false\n};\n\nconst encoder = new TextEncoder();\n\n/**\n * Creates the HTML response.\n * @param {{\n *   branch: Array<import('./types.js').Loaded>;\n *   fetched: Array<import('./types.js').Fetched>;\n *   options: import('types').SSROptions;\n *   manifest: import('@sveltejs/kit').SSRManifest;\n *   state: import('types').SSRState;\n *   page_config: { ssr: boolean; csr: boolean };\n *   status: number;\n *   error: App.Error | null;\n *   event: import('@sveltejs/kit').RequestEvent;\n *   resolve_opts: import('types').RequiredResolveOptions;\n *   action_result?: import('@sveltejs/kit').ActionResult;\n * }} opts\n */\nexport async function render_response({\n\tbranch,\n\tfetched,\n\toptions,\n\tmanifest,\n\tstate,\n\tpage_config,\n\tstatus,\n\terror = null,\n\tevent,\n\tresolve_opts,\n\taction_result\n}) {\n\tif (state.prerendering) {\n\t\tif (options.csp.mode === 'nonce') {\n\t\t\tthrow new Error('Cannot use prerendering if config.kit.csp.mode === \"nonce\"');\n\t\t}\n\n\t\tif (options.app_template_contains_nonce) {\n\t\t\tthrow new Error('Cannot use prerendering if page template contains %sveltekit.nonce%');\n\t\t}\n\t}\n\n\tconst { client } = manifest._;\n\n\tconst modulepreloads = new Set(client.imports);\n\tconst stylesheets = new Set(client.stylesheets);\n\tconst fonts = new Set(client.fonts);\n\n\t/** @type {Set<string>} */\n\tconst link_header_preloads = new Set();\n\n\t/** @type {Map<string, string>} */\n\t// TODO if we add a client entry point one day, we will need to include inline_styles with the entry, otherwise stylesheets will be linked even if they are below inlineStyleThreshold\n\tconst inline_styles = new Map();\n\n\tlet rendered;\n\n\tconst form_value =\n\t\taction_result?.type === 'success' || action_result?.type === 'failure'\n\t\t\t? (action_result.data ?? null)\n\t\t\t: null;\n\n\t/** @type {string} */\n\tlet base = paths.base;\n\n\t/** @type {string} */\n\tlet assets = paths.assets;\n\n\t/**\n\t * An expression that will evaluate in the client to determine the resolved base path.\n\t * We use a relative path when possible to support IPFS, the internet archive, etc.\n\t */\n\tlet base_expression = s(paths.base);\n\n\t// if appropriate, use relative paths for greater portability\n\tif (paths.relative) {\n\t\tif (!state.prerendering?.fallback) {\n\t\t\tconst segments = event.url.pathname.slice(paths.base.length).split('/').slice(2);\n\n\t\t\tbase = segments.map(() => '..').join('/') || '.';\n\n\t\t\t// resolve e.g. '../..' against current location, then remove trailing slash\n\t\t\tbase_expression = `new URL(${s(base)}, location).pathname.slice(0, -1)`;\n\n\t\t\tif (!paths.assets || (paths.assets[0] === '/' && paths.assets !== SVELTE_KIT_ASSETS)) {\n\t\t\t\tassets = base;\n\t\t\t}\n\t\t} else if (options.hash_routing) {\n\t\t\t// we have to assume that we're in the right place\n\t\t\tbase_expression = \"new URL('.', location).pathname.slice(0, -1)\";\n\t\t}\n\t}\n\n\tif (page_config.ssr) {\n\t\t/** @type {Record<string, any>} */\n\t\tconst props = {\n\t\t\tstores: {\n\t\t\t\tpage: writable(null),\n\t\t\t\tnavigating: writable(null),\n\t\t\t\tupdated\n\t\t\t},\n\t\t\tconstructors: await Promise.all(\n\t\t\t\tbranch.map(({ node }) => {\n\t\t\t\t\tif (!node.component) {\n\t\t\t\t\t\t// Can only be the leaf, layouts have a fallback component generated\n\t\t\t\t\t\tthrow new Error(`Missing +page.svelte component for route ${event.route.id}`);\n\t\t\t\t\t}\n\t\t\t\t\treturn node.component();\n\t\t\t\t})\n\t\t\t),\n\t\t\tform: form_value\n\t\t};\n\n\t\tlet data = {};\n\n\t\t// props_n (instead of props[n]) makes it easy to avoid\n\t\t// unnecessary updates for layout components\n\t\tfor (let i = 0; i < branch.length; i += 1) {\n\t\t\tdata = { ...data, ...branch[i].data };\n\t\t\tprops[`data_${i}`] = data;\n\t\t}\n\n\t\tprops.page = {\n\t\t\terror,\n\t\t\tparams: /** @type {Record<string, any>} */ (event.params),\n\t\t\troute: event.route,\n\t\t\tstatus,\n\t\t\turl: event.url,\n\t\t\tdata,\n\t\t\tform: form_value,\n\t\t\tstate: {}\n\t\t};\n\n\t\t// use relative paths during rendering, so that the resulting HTML is as\n\t\t// portable as possible, but reset afterwards\n\t\tif (paths.relative) paths.override({ base, assets });\n\n\t\tconst render_opts = {\n\t\t\tcontext: new Map([\n\t\t\t\t[\n\t\t\t\t\t'__request__',\n\t\t\t\t\t{\n\t\t\t\t\t\tpage: props.page\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t])\n\t\t};\n\n\t\tif (__SVELTEKIT_DEV__) {\n\t\t\tconst fetch = globalThis.fetch;\n\t\t\tlet warned = false;\n\t\t\tglobalThis.fetch = (info, init) => {\n\t\t\t\tif (typeof info === 'string' && !SCHEME.test(info)) {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t`Cannot call \\`fetch\\` eagerly during server side rendering with relative URL (${info}) — put your \\`fetch\\` calls inside \\`onMount\\` or a \\`load\\` function instead`\n\t\t\t\t\t);\n\t\t\t\t} else if (!warned) {\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t'Avoid calling `fetch` eagerly during server side rendering — put your `fetch` calls inside `onMount` or a `load` function instead'\n\t\t\t\t\t);\n\t\t\t\t\twarned = true;\n\t\t\t\t}\n\n\t\t\t\treturn fetch(info, init);\n\t\t\t};\n\n\t\t\ttry {\n\t\t\t\trendered = options.root.render(props, render_opts);\n\t\t\t} finally {\n\t\t\t\tglobalThis.fetch = fetch;\n\t\t\t\tpaths.reset();\n\t\t\t}\n\t\t} else {\n\t\t\ttry {\n\t\t\t\trendered = options.root.render(props, render_opts);\n\t\t\t} finally {\n\t\t\t\tpaths.reset();\n\t\t\t}\n\t\t}\n\n\t\tfor (const { node } of branch) {\n\t\t\tfor (const url of node.imports) modulepreloads.add(url);\n\t\t\tfor (const url of node.stylesheets) stylesheets.add(url);\n\t\t\tfor (const url of node.fonts) fonts.add(url);\n\n\t\t\tif (node.inline_styles && !client.inline) {\n\t\t\t\tObject.entries(await node.inline_styles()).forEach(([k, v]) => inline_styles.set(k, v));\n\t\t\t}\n\t\t}\n\t} else {\n\t\trendered = { head: '', html: '', css: { code: '', map: null } };\n\t}\n\n\tlet head = '';\n\tlet body = rendered.html;\n\n\tconst csp = new Csp(options.csp, {\n\t\tprerender: !!state.prerendering\n\t});\n\n\t/** @param {string} path */\n\tconst prefixed = (path) => {\n\t\tif (path.startsWith('/')) {\n\t\t\t// Vite makes the start script available through the base path and without it.\n\t\t\t// We load it via the base path in order to support remote IDE environments which proxy\n\t\t\t// all URLs under the base path during development.\n\t\t\treturn paths.base + path;\n\t\t}\n\t\treturn `${assets}/${path}`;\n\t};\n\n\t// inline styles can come from `bundleStrategy: 'inline'` or `inlineStyleThreshold`\n\tconst style = client.inline\n\t\t? client.inline?.style\n\t\t: Array.from(inline_styles.values()).join('\\n');\n\n\tif (style) {\n\t\tconst attributes = __SVELTEKIT_DEV__ ? [' data-sveltekit'] : [];\n\t\tif (csp.style_needs_nonce) attributes.push(` nonce=\"${csp.nonce}\"`);\n\n\t\tcsp.add_style(style);\n\n\t\thead += `\\n\\t<style${attributes.join('')}>${style}</style>`;\n\t}\n\n\tfor (const dep of stylesheets) {\n\t\tconst path = prefixed(dep);\n\n\t\tconst attributes = ['rel=\"stylesheet\"'];\n\n\t\tif (inline_styles.has(dep)) {\n\t\t\t// don't load stylesheets that are already inlined\n\t\t\t// include them in disabled state so that Vite can detect them and doesn't try to add them\n\t\t\tattributes.push('disabled', 'media=\"(max-width: 0)\"');\n\t\t} else {\n\t\t\tif (resolve_opts.preload({ type: 'css', path })) {\n\t\t\t\tconst preload_atts = ['rel=\"preload\"', 'as=\"style\"'];\n\t\t\t\tlink_header_preloads.add(`<${encodeURI(path)}>; ${preload_atts.join(';')}; nopush`);\n\t\t\t}\n\t\t}\n\n\t\thead += `\\n\\t\\t<link href=\"${path}\" ${attributes.join(' ')}>`;\n\t}\n\n\tfor (const dep of fonts) {\n\t\tconst path = prefixed(dep);\n\n\t\tif (resolve_opts.preload({ type: 'font', path })) {\n\t\t\tconst ext = dep.slice(dep.lastIndexOf('.') + 1);\n\t\t\tconst attributes = [\n\t\t\t\t'rel=\"preload\"',\n\t\t\t\t'as=\"font\"',\n\t\t\t\t`type=\"font/${ext}\"`,\n\t\t\t\t`href=\"${path}\"`,\n\t\t\t\t'crossorigin'\n\t\t\t];\n\n\t\t\thead += `\\n\\t\\t<link ${attributes.join(' ')}>`;\n\t\t}\n\t}\n\n\tconst global = __SVELTEKIT_DEV__ ? '__sveltekit_dev' : `__sveltekit_${options.version_hash}`;\n\n\tconst { data, chunks } = get_data(\n\t\tevent,\n\t\toptions,\n\t\tbranch.map((b) => b.server_data),\n\t\tcsp,\n\t\tglobal\n\t);\n\n\tif (page_config.ssr && page_config.csr) {\n\t\tbody += `\\n\\t\\t\\t${fetched\n\t\t\t.map((item) =>\n\t\t\t\tserialize_data(item, resolve_opts.filterSerializedResponseHeaders, !!state.prerendering)\n\t\t\t)\n\t\t\t.join('\\n\\t\\t\\t')}`;\n\t}\n\n\tif (page_config.csr) {\n\t\tconst route = manifest._.client.routes?.find((r) => r.id === event.route.id) ?? null;\n\n\t\tif (client.uses_env_dynamic_public && state.prerendering) {\n\t\t\tmodulepreloads.add(`${paths.app_dir}/env.js`);\n\t\t}\n\n\t\tif (!client.inline) {\n\t\t\tconst included_modulepreloads = Array.from(modulepreloads, (dep) => prefixed(dep)).filter(\n\t\t\t\t(path) => resolve_opts.preload({ type: 'js', path })\n\t\t\t);\n\n\t\t\tfor (const path of included_modulepreloads) {\n\t\t\t\t// see the kit.output.preloadStrategy option for details on why we have multiple options here\n\t\t\t\tlink_header_preloads.add(`<${encodeURI(path)}>; rel=\"modulepreload\"; nopush`);\n\t\t\t\tif (options.preload_strategy !== 'modulepreload') {\n\t\t\t\t\thead += `\\n\\t\\t<link rel=\"preload\" as=\"script\" crossorigin=\"anonymous\" href=\"${path}\">`;\n\t\t\t\t} else if (state.prerendering) {\n\t\t\t\t\thead += `\\n\\t\\t<link rel=\"modulepreload\" href=\"${path}\">`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// prerender a `/path/to/page/__route.js` module\n\t\tif (manifest._.client.routes && state.prerendering && !state.prerendering.fallback) {\n\t\t\tconst pathname = add_resolution_suffix(event.url.pathname);\n\n\t\t\tstate.prerendering.dependencies.set(\n\t\t\t\tpathname,\n\t\t\t\tcreate_server_routing_response(route, event.params, new URL(pathname, event.url), manifest)\n\t\t\t);\n\t\t}\n\n\t\tconst blocks = [];\n\n\t\t// when serving a prerendered page in an app that uses $env/dynamic/public, we must\n\t\t// import the env.js module so that it evaluates before any user code can evaluate.\n\t\t// TODO revert to using top-level await once https://bugs.webkit.org/show_bug.cgi?id=242740 is fixed\n\t\t// https://github.com/sveltejs/kit/pull/11601\n\t\tconst load_env_eagerly = client.uses_env_dynamic_public && state.prerendering;\n\n\t\tconst properties = [`base: ${base_expression}`];\n\n\t\tif (paths.assets) {\n\t\t\tproperties.push(`assets: ${s(paths.assets)}`);\n\t\t}\n\n\t\tif (client.uses_env_dynamic_public) {\n\t\t\tproperties.push(`env: ${load_env_eagerly ? 'null' : s(public_env)}`);\n\t\t}\n\n\t\tif (chunks) {\n\t\t\tblocks.push('const deferred = new Map();');\n\n\t\t\tproperties.push(`defer: (id) => new Promise((fulfil, reject) => {\n\t\t\t\t\t\t\tdeferred.set(id, { fulfil, reject });\n\t\t\t\t\t\t})`);\n\n\t\t\t// When resolving, the id might not yet be available due to the data\n\t\t\t// be evaluated upon init of kit, so we use a timeout to retry\n\t\t\tproperties.push(`resolve: ({ id, data, error }) => {\n\t\t\t\t\t\t\tconst try_to_resolve = () => {\n\t\t\t\t\t\t\t\tif (!deferred.has(id)) {\n\t\t\t\t\t\t\t\t\tsetTimeout(try_to_resolve, 0);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst { fulfil, reject } = deferred.get(id);\n\t\t\t\t\t\t\t\tdeferred.delete(id);\n\t\t\t\t\t\t\t\tif (error) reject(error);\n\t\t\t\t\t\t\t\telse fulfil(data);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttry_to_resolve();\n\t\t\t\t\t\t}`);\n\t\t}\n\n\t\t// create this before declaring `data`, which may contain references to `${global}`\n\t\tblocks.push(`${global} = {\n\t\t\t\t\t\t${properties.join(',\\n\\t\\t\\t\\t\\t\\t')}\n\t\t\t\t\t};`);\n\n\t\tconst args = ['element'];\n\n\t\tblocks.push('const element = document.currentScript.parentElement;');\n\n\t\tif (page_config.ssr) {\n\t\t\tconst serialized = { form: 'null', error: 'null' };\n\n\t\t\tif (form_value) {\n\t\t\t\tserialized.form = uneval_action_response(\n\t\t\t\t\tform_value,\n\t\t\t\t\t/** @type {string} */ (event.route.id),\n\t\t\t\t\toptions.hooks.transport\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (error) {\n\t\t\t\tserialized.error = devalue.uneval(error);\n\t\t\t}\n\n\t\t\tconst hydrate = [\n\t\t\t\t`node_ids: [${branch.map(({ node }) => node.index).join(', ')}]`,\n\t\t\t\t`data: ${data}`,\n\t\t\t\t`form: ${serialized.form}`,\n\t\t\t\t`error: ${serialized.error}`\n\t\t\t];\n\n\t\t\tif (status !== 200) {\n\t\t\t\thydrate.push(`status: ${status}`);\n\t\t\t}\n\n\t\t\tif (manifest._.client.routes) {\n\t\t\t\tif (route) {\n\t\t\t\t\tconst stringified = generate_route_object(route, event.url, manifest).replaceAll(\n\t\t\t\t\t\t'\\n',\n\t\t\t\t\t\t'\\n\\t\\t\\t\\t\\t\\t\\t'\n\t\t\t\t\t); // make output after it's put together with the rest more readable\n\t\t\t\t\thydrate.push(`params: ${devalue.uneval(event.params)}`, `server_route: ${stringified}`);\n\t\t\t\t}\n\t\t\t} else if (options.embedded) {\n\t\t\t\thydrate.push(`params: ${devalue.uneval(event.params)}`, `route: ${s(event.route)}`);\n\t\t\t}\n\n\t\t\tconst indent = '\\t'.repeat(load_env_eagerly ? 7 : 6);\n\t\t\targs.push(`{\\n${indent}\\t${hydrate.join(`,\\n${indent}\\t`)}\\n${indent}}`);\n\t\t}\n\n\t\t// `client.app` is a proxy for `bundleStrategy === 'split'`\n\t\tconst boot = client.inline\n\t\t\t? `${client.inline.script}\n\n\t\t\t\t\t__sveltekit_${options.version_hash}.app.start(${args.join(', ')});`\n\t\t\t: client.app\n\t\t\t\t? `Promise.all([\n\t\t\t\t\t\timport(${s(prefixed(client.start))}),\n\t\t\t\t\t\timport(${s(prefixed(client.app))})\n\t\t\t\t\t]).then(([kit, app]) => {\n\t\t\t\t\t\tkit.start(app, ${args.join(', ')});\n\t\t\t\t\t});`\n\t\t\t\t: `import(${s(prefixed(client.start))}).then((app) => {\n\t\t\t\t\t\tapp.start(${args.join(', ')})\n\t\t\t\t\t});`;\n\n\t\tif (load_env_eagerly) {\n\t\t\tblocks.push(`import(${s(`${base}/${paths.app_dir}/env.js`)}).then(({ env }) => {\n\t\t\t\t\t\t${global}.env = env;\n\n\t\t\t\t\t\t${boot.replace(/\\n/g, '\\n\\t')}\n\t\t\t\t\t});`);\n\t\t} else {\n\t\t\tblocks.push(boot);\n\t\t}\n\n\t\tif (options.service_worker) {\n\t\t\tconst opts = __SVELTEKIT_DEV__ ? \", { type: 'module' }\" : '';\n\n\t\t\t// we use an anonymous function instead of an arrow function to support\n\t\t\t// older browsers (https://github.com/sveltejs/kit/pull/5417)\n\t\t\tblocks.push(`if ('serviceWorker' in navigator) {\n\t\t\t\t\t\taddEventListener('load', function () {\n\t\t\t\t\t\t\tnavigator.serviceWorker.register('${prefixed('service-worker.js')}'${opts});\n\t\t\t\t\t\t});\n\t\t\t\t\t}`);\n\t\t}\n\n\t\tconst init_app = `\n\t\t\t\t{\n\t\t\t\t\t${blocks.join('\\n\\n\\t\\t\\t\\t\\t')}\n\t\t\t\t}\n\t\t\t`;\n\t\tcsp.add_script(init_app);\n\n\t\tbody += `\\n\\t\\t\\t<script${\n\t\t\tcsp.script_needs_nonce ? ` nonce=\"${csp.nonce}\"` : ''\n\t\t}>${init_app}</script>\\n\\t\\t`;\n\t}\n\n\tconst headers = new Headers({\n\t\t'x-sveltekit-page': 'true',\n\t\t'content-type': 'text/html'\n\t});\n\n\tif (state.prerendering) {\n\t\t// TODO read headers set with setHeaders and convert into http-equiv where possible\n\t\tconst http_equiv = [];\n\n\t\tconst csp_headers = csp.csp_provider.get_meta();\n\t\tif (csp_headers) {\n\t\t\thttp_equiv.push(csp_headers);\n\t\t}\n\n\t\tif (state.prerendering.cache) {\n\t\t\thttp_equiv.push(`<meta http-equiv=\"cache-control\" content=\"${state.prerendering.cache}\">`);\n\t\t}\n\n\t\tif (http_equiv.length > 0) {\n\t\t\thead = http_equiv.join('\\n') + head;\n\t\t}\n\t} else {\n\t\tconst csp_header = csp.csp_provider.get_header();\n\t\tif (csp_header) {\n\t\t\theaders.set('content-security-policy', csp_header);\n\t\t}\n\t\tconst report_only_header = csp.report_only_provider.get_header();\n\t\tif (report_only_header) {\n\t\t\theaders.set('content-security-policy-report-only', report_only_header);\n\t\t}\n\n\t\tif (link_header_preloads.size) {\n\t\t\theaders.set('link', Array.from(link_header_preloads).join(', '));\n\t\t}\n\t}\n\n\t// add the content after the script/css links so the link elements are parsed first\n\thead += rendered.head;\n\n\tconst html = options.templates.app({\n\t\thead,\n\t\tbody,\n\t\tassets,\n\t\tnonce: /** @type {string} */ (csp.nonce),\n\t\tenv: safe_public_env\n\t});\n\n\t// TODO flush chunks as early as we can\n\tconst transformed =\n\t\t(await resolve_opts.transformPageChunk({\n\t\t\thtml,\n\t\t\tdone: true\n\t\t})) || '';\n\n\tif (!chunks) {\n\t\theaders.set('etag', `\"${hash(transformed)}\"`);\n\t}\n\n\tif (DEV) {\n\t\tif (page_config.csr) {\n\t\t\tif (transformed.split('<!--').length < html.split('<!--').length) {\n\t\t\t\t// the \\u001B stuff is ANSI codes, so that we don't need to add a library to the runtime\n\t\t\t\t// https://svelte.dev/playground/1b3f49696f0c44c881c34587f2537aa2?version=4.2.19\n\t\t\t\tconsole.warn(\n\t\t\t\t\t\"\\u001B[1m\\u001B[31mRemoving comments in transformPageChunk can break Svelte's hydration\\u001B[39m\\u001B[22m\"\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tif (chunks) {\n\t\t\t\tconsole.warn(\n\t\t\t\t\t'\\u001B[1m\\u001B[31mReturning promises from server `load` functions will only work if `csr === true`\\u001B[39m\\u001B[22m'\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn !chunks\n\t\t? text(transformed, {\n\t\t\t\tstatus,\n\t\t\t\theaders\n\t\t\t})\n\t\t: new Response(\n\t\t\t\tnew ReadableStream({\n\t\t\t\t\tasync start(controller) {\n\t\t\t\t\t\tcontroller.enqueue(encoder.encode(transformed + '\\n'));\n\t\t\t\t\t\tfor await (const chunk of chunks) {\n\t\t\t\t\t\t\tcontroller.enqueue(encoder.encode(chunk));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontroller.close();\n\t\t\t\t\t},\n\n\t\t\t\t\ttype: 'bytes'\n\t\t\t\t}),\n\t\t\t\t{\n\t\t\t\t\theaders\n\t\t\t\t}\n\t\t\t);\n}\n\n/**\n * If the serialized data contains promises, `chunks` will be an\n * async iterable containing their resolutions\n * @param {import('@sveltejs/kit').RequestEvent} event\n * @param {import('types').SSROptions} options\n * @param {Array<import('types').ServerDataNode | null>} nodes\n * @param {import('./csp.js').Csp} csp\n * @param {string} global\n * @returns {{ data: string, chunks: AsyncIterable<string> | null }}\n */\nfunction get_data(event, options, nodes, csp, global) {\n\tlet promise_id = 1;\n\tlet count = 0;\n\n\tconst { iterator, push, done } = create_async_iterator();\n\n\t/** @param {any} thing */\n\tfunction replacer(thing) {\n\t\tif (typeof thing?.then === 'function') {\n\t\t\tconst id = promise_id++;\n\t\t\tcount += 1;\n\n\t\t\tthing\n\t\t\t\t.then(/** @param {any} data */ (data) => ({ data }))\n\t\t\t\t.catch(\n\t\t\t\t\t/** @param {any} error */ async (error) => ({\n\t\t\t\t\t\terror: await handle_error_and_jsonify(event, options, error)\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.then(\n\t\t\t\t\t/**\n\t\t\t\t\t * @param {{data: any; error: any}} result\n\t\t\t\t\t */\n\t\t\t\t\tasync ({ data, error }) => {\n\t\t\t\t\t\tcount -= 1;\n\n\t\t\t\t\t\tlet str;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tstr = devalue.uneval({ id, data, error }, replacer);\n\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\terror = await handle_error_and_jsonify(\n\t\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\t\tnew Error(`Failed to serialize promise while rendering ${event.route.id}`)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tdata = undefined;\n\t\t\t\t\t\t\tstr = devalue.uneval({ id, data, error }, replacer);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst nonce = csp.script_needs_nonce ? ` nonce=\"${csp.nonce}\"` : '';\n\t\t\t\t\t\tpush(`<script${nonce}>${global}.resolve(${str})</script>\\n`);\n\t\t\t\t\t\tif (count === 0) done();\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\treturn `${global}.defer(${id})`;\n\t\t} else {\n\t\t\tfor (const key in options.hooks.transport) {\n\t\t\t\tconst encoded = options.hooks.transport[key].encode(thing);\n\t\t\t\tif (encoded) {\n\t\t\t\t\treturn `app.decode('${key}', ${devalue.uneval(encoded, replacer)})`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\ttry {\n\t\tconst strings = nodes.map((node) => {\n\t\t\tif (!node) return 'null';\n\n\t\t\t/** @type {any} */\n\t\t\tconst payload = { type: 'data', data: node.data, uses: serialize_uses(node) };\n\t\t\tif (node.slash) payload.slash = node.slash;\n\n\t\t\treturn devalue.uneval(payload, replacer);\n\t\t});\n\n\t\treturn {\n\t\t\tdata: `[${strings.join(',')}]`,\n\t\t\tchunks: count > 0 ? iterator : null\n\t\t};\n\t} catch (e) {\n\t\t// @ts-expect-error\n\t\te.path = e.path.slice(1);\n\t\tthrow new Error(clarify_devalue_error(event, /** @type {any} */ (e)));\n\t}\n}\n","import {\n\tvalidate_layout_exports,\n\tvalidate_layout_server_exports,\n\tvalidate_page_exports,\n\tvalidate_page_server_exports\n} from './exports.js';\n\nexport class PageNodes {\n\tdata;\n\n\t/**\n\t * @param {Array<import('types').SSRNode | undefined>} nodes\n\t */\n\tconstructor(nodes) {\n\t\tthis.data = nodes;\n\t}\n\n\tlayouts() {\n\t\treturn this.data.slice(0, -1);\n\t}\n\n\tpage() {\n\t\treturn this.data.at(-1);\n\t}\n\n\tvalidate() {\n\t\tfor (const layout of this.layouts()) {\n\t\t\tif (layout) {\n\t\t\t\tvalidate_layout_server_exports(layout.server, /** @type {string} */ (layout.server_id));\n\t\t\t\tvalidate_layout_exports(layout.universal, /** @type {string} */ (layout.universal_id));\n\t\t\t}\n\t\t}\n\n\t\tconst page = this.page();\n\t\tif (page) {\n\t\t\tvalidate_page_server_exports(page.server, /** @type {string} */ (page.server_id));\n\t\t\tvalidate_page_exports(page.universal, /** @type {string} */ (page.universal_id));\n\t\t}\n\t}\n\n\t/**\n\t * @template {'prerender' | 'ssr' | 'csr' | 'trailingSlash'} Option\n\t * @param {Option} option\n\t * @returns {Value | undefined}\n\t */\n\t#get_option(option) {\n\t\t/** @typedef {(import('types').UniversalNode | import('types').ServerNode)[Option]} Value */\n\n\t\treturn this.data.reduce((value, node) => {\n\t\t\treturn node?.universal?.[option] ?? node?.server?.[option] ?? value;\n\t\t}, /** @type {Value | undefined} */ (undefined));\n\t}\n\n\tcsr() {\n\t\treturn this.#get_option('csr') ?? true;\n\t}\n\n\tssr() {\n\t\treturn this.#get_option('ssr') ?? true;\n\t}\n\n\tprerender() {\n\t\treturn this.#get_option('prerender') ?? false;\n\t}\n\n\ttrailing_slash() {\n\t\treturn this.#get_option('trailingSlash') ?? 'never';\n\t}\n\n\tget_config() {\n\t\t/** @type {any} */\n\t\tlet current = {};\n\n\t\tfor (const node of this.data) {\n\t\t\tif (!node?.universal?.config && !node?.server?.config) continue;\n\n\t\t\tcurrent = {\n\t\t\t\t...current,\n\t\t\t\t// TODO: should we override the server config value with the universal value similar to other page options?\n\t\t\t\t...node?.universal?.config,\n\t\t\t\t...node?.server?.config\n\t\t\t};\n\t\t}\n\n\t\t// TODO 3.0 always return `current`? then we can get rid of `?? {}` in other places\n\t\treturn Object.keys(current).length ? current : undefined;\n\t}\n\n\tshould_prerender_data() {\n\t\treturn this.data.some(\n\t\t\t// prerender in case of trailingSlash because the client retrieves that value from the server\n\t\t\t(node) => node?.server?.load || node?.server?.trailingSlash !== undefined\n\t\t);\n\t}\n}\n","import { render_response } from './render.js';\nimport { load_data, load_server_data } from './load_data.js';\nimport { handle_error_and_jsonify, static_error_page, redirect_response } from '../utils.js';\nimport { Redirect } from '../../control.js';\nimport { get_status } from '../../../utils/error.js';\nimport { PageNodes } from '../../../utils/page_nodes.js';\n\n/**\n * @typedef {import('./types.js').Loaded} Loaded\n */\n\n/**\n * @param {{\n *   event: import('@sveltejs/kit').RequestEvent;\n *   options: import('types').SSROptions;\n *   manifest: import('@sveltejs/kit').SSRManifest;\n *   state: import('types').SSRState;\n *   status: number;\n *   error: unknown;\n *   resolve_opts: import('types').RequiredResolveOptions;\n * }} opts\n */\nexport async function respond_with_error({\n\tevent,\n\toptions,\n\tmanifest,\n\tstate,\n\tstatus,\n\terror,\n\tresolve_opts\n}) {\n\t// reroute to the fallback page to prevent an infinite chain of requests.\n\tif (event.request.headers.get('x-sveltekit-error')) {\n\t\treturn static_error_page(options, status, /** @type {Error} */ (error).message);\n\t}\n\n\t/** @type {import('./types.js').Fetched[]} */\n\tconst fetched = [];\n\n\ttry {\n\t\tconst branch = [];\n\t\tconst default_layout = await manifest._.nodes[0](); // 0 is always the root layout\n\t\tconst nodes = new PageNodes([default_layout]);\n\t\tconst ssr = nodes.ssr();\n\t\tconst csr = nodes.csr();\n\n\t\tif (ssr) {\n\t\t\tstate.error = true;\n\n\t\t\tconst server_data_promise = load_server_data({\n\t\t\t\tevent,\n\t\t\t\tstate,\n\t\t\t\tnode: default_layout,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/require-await\n\t\t\t\tparent: async () => ({})\n\t\t\t});\n\n\t\t\tconst server_data = await server_data_promise;\n\n\t\t\tconst data = await load_data({\n\t\t\t\tevent,\n\t\t\t\tfetched,\n\t\t\t\tnode: default_layout,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/require-await\n\t\t\t\tparent: async () => ({}),\n\t\t\t\tresolve_opts,\n\t\t\t\tserver_data_promise,\n\t\t\t\tstate,\n\t\t\t\tcsr\n\t\t\t});\n\n\t\t\tbranch.push(\n\t\t\t\t{\n\t\t\t\t\tnode: default_layout,\n\t\t\t\t\tserver_data,\n\t\t\t\t\tdata\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tnode: await manifest._.nodes[1](), // 1 is always the root error\n\t\t\t\t\tdata: null,\n\t\t\t\t\tserver_data: null\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn await render_response({\n\t\t\toptions,\n\t\t\tmanifest,\n\t\t\tstate,\n\t\t\tpage_config: {\n\t\t\t\tssr,\n\t\t\t\tcsr\n\t\t\t},\n\t\t\tstatus,\n\t\t\terror: await handle_error_and_jsonify(event, options, error),\n\t\t\tbranch,\n\t\t\tfetched,\n\t\t\tevent,\n\t\t\tresolve_opts\n\t\t});\n\t} catch (e) {\n\t\t// Edge case: If route is a 404 and the user redirects to somewhere from the root layout,\n\t\t// we end up here.\n\t\tif (e instanceof Redirect) {\n\t\t\treturn redirect_response(e.status, e.location);\n\t\t}\n\n\t\treturn static_error_page(\n\t\t\toptions,\n\t\t\tget_status(e),\n\t\t\t(await handle_error_and_jsonify(event, options, e)).message\n\t\t);\n\t}\n}\n","/**\n * @template T\n * @param {() => T} fn\n */\nexport function once(fn) {\n\tlet done = false;\n\n\t/** @type T */\n\tlet result;\n\n\treturn () => {\n\t\tif (done) return result;\n\t\tdone = true;\n\t\treturn (result = fn());\n\t};\n}\n","import { HttpError, SvelteKitError, Redirect } from '../../control.js';\nimport { normalize_error } from '../../../utils/error.js';\nimport { once } from '../../../utils/functions.js';\nimport { load_server_data } from '../page/load_data.js';\nimport { clarify_devalue_error, handle_error_and_jsonify, serialize_uses } from '../utils.js';\nimport { normalize_path } from '../../../utils/url.js';\nimport { text } from '../../../exports/index.js';\nimport * as devalue from 'devalue';\nimport { create_async_iterator } from '../../../utils/streaming.js';\n\nconst encoder = new TextEncoder();\n\n/**\n * @param {import('@sveltejs/kit').RequestEvent} event\n * @param {import('types').SSRRoute} route\n * @param {import('types').SSROptions} options\n * @param {import('@sveltejs/kit').SSRManifest} manifest\n * @param {import('types').SSRState} state\n * @param {boolean[] | undefined} invalidated_data_nodes\n * @param {import('types').TrailingSlash} trailing_slash\n * @returns {Promise<Response>}\n */\nexport async function render_data(\n\tevent,\n\troute,\n\toptions,\n\tmanifest,\n\tstate,\n\tinvalidated_data_nodes,\n\ttrailing_slash\n) {\n\tif (!route.page) {\n\t\t// requesting /__data.json should fail for a +server.js\n\t\treturn new Response(undefined, {\n\t\t\tstatus: 404\n\t\t});\n\t}\n\n\ttry {\n\t\tconst node_ids = [...route.page.layouts, route.page.leaf];\n\t\tconst invalidated = invalidated_data_nodes ?? node_ids.map(() => true);\n\n\t\tlet aborted = false;\n\n\t\tconst url = new URL(event.url);\n\t\turl.pathname = normalize_path(url.pathname, trailing_slash);\n\n\t\tconst new_event = { ...event, url };\n\n\t\tconst functions = node_ids.map((n, i) => {\n\t\t\treturn once(async () => {\n\t\t\t\ttry {\n\t\t\t\t\tif (aborted) {\n\t\t\t\t\t\treturn /** @type {import('types').ServerDataSkippedNode} */ ({\n\t\t\t\t\t\t\ttype: 'skip'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// == because it could be undefined (in dev) or null (in build, because of JSON.stringify)\n\t\t\t\t\tconst node = n == undefined ? n : await manifest._.nodes[n]();\n\t\t\t\t\t// load this. for the child, return as is. for the final result, stream things\n\t\t\t\t\treturn load_server_data({\n\t\t\t\t\t\tevent: new_event,\n\t\t\t\t\t\tstate,\n\t\t\t\t\t\tnode,\n\t\t\t\t\t\tparent: async () => {\n\t\t\t\t\t\t\t/** @type {Record<string, any>} */\n\t\t\t\t\t\t\tconst data = {};\n\t\t\t\t\t\t\tfor (let j = 0; j < i; j += 1) {\n\t\t\t\t\t\t\t\tconst parent = /** @type {import('types').ServerDataNode | null} */ (\n\t\t\t\t\t\t\t\t\tawait functions[j]()\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tif (parent) {\n\t\t\t\t\t\t\t\t\tObject.assign(data, parent.data);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn data;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\taborted = true;\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tconst promises = functions.map(async (fn, i) => {\n\t\t\tif (!invalidated[i]) {\n\t\t\t\treturn /** @type {import('types').ServerDataSkippedNode} */ ({\n\t\t\t\t\ttype: 'skip'\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn fn();\n\t\t});\n\n\t\tlet length = promises.length;\n\t\tconst nodes = await Promise.all(\n\t\t\tpromises.map((p, i) =>\n\t\t\t\tp.catch(async (error) => {\n\t\t\t\t\tif (error instanceof Redirect) {\n\t\t\t\t\t\tthrow error;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Math.min because array isn't guaranteed to resolve in order\n\t\t\t\t\tlength = Math.min(length, i + 1);\n\n\t\t\t\t\treturn /** @type {import('types').ServerErrorNode} */ ({\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\terror: await handle_error_and_jsonify(event, options, error),\n\t\t\t\t\t\tstatus:\n\t\t\t\t\t\t\terror instanceof HttpError || error instanceof SvelteKitError\n\t\t\t\t\t\t\t\t? error.status\n\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t)\n\t\t);\n\n\t\tconst { data, chunks } = get_data_json(event, options, nodes);\n\n\t\tif (!chunks) {\n\t\t\t// use a normal JSON response where possible, so we get `content-length`\n\t\t\t// and can use browser JSON devtools for easier inspecting\n\t\t\treturn json_response(data);\n\t\t}\n\n\t\treturn new Response(\n\t\t\tnew ReadableStream({\n\t\t\t\tasync start(controller) {\n\t\t\t\t\tcontroller.enqueue(encoder.encode(data));\n\t\t\t\t\tfor await (const chunk of chunks) {\n\t\t\t\t\t\tcontroller.enqueue(encoder.encode(chunk));\n\t\t\t\t\t}\n\t\t\t\t\tcontroller.close();\n\t\t\t\t},\n\n\t\t\t\ttype: 'bytes'\n\t\t\t}),\n\t\t\t{\n\t\t\t\theaders: {\n\t\t\t\t\t// we use a proprietary content type to prevent buffering.\n\t\t\t\t\t// the `text` prefix makes it inspectable\n\t\t\t\t\t'content-type': 'text/sveltekit-data',\n\t\t\t\t\t'cache-control': 'private, no-store'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t} catch (e) {\n\t\tconst error = normalize_error(e);\n\n\t\tif (error instanceof Redirect) {\n\t\t\treturn redirect_json_response(error);\n\t\t} else {\n\t\t\treturn json_response(await handle_error_and_jsonify(event, options, error), 500);\n\t\t}\n\t}\n}\n\n/**\n * @param {Record<string, any> | string} json\n * @param {number} [status]\n */\nfunction json_response(json, status = 200) {\n\treturn text(typeof json === 'string' ? json : JSON.stringify(json), {\n\t\tstatus,\n\t\theaders: {\n\t\t\t'content-type': 'application/json',\n\t\t\t'cache-control': 'private, no-store'\n\t\t}\n\t});\n}\n\n/**\n * @param {Redirect} redirect\n */\nexport function redirect_json_response(redirect) {\n\treturn json_response({\n\t\ttype: 'redirect',\n\t\tlocation: redirect.location\n\t});\n}\n\n/**\n * If the serialized data contains promises, `chunks` will be an\n * async iterable containing their resolutions\n * @param {import('@sveltejs/kit').RequestEvent} event\n * @param {import('types').SSROptions} options\n * @param {Array<import('types').ServerDataSkippedNode | import('types').ServerDataNode | import('types').ServerErrorNode | null | undefined>} nodes\n *  @returns {{ data: string, chunks: AsyncIterable<string> | null }}\n */\nexport function get_data_json(event, options, nodes) {\n\tlet promise_id = 1;\n\tlet count = 0;\n\n\tconst { iterator, push, done } = create_async_iterator();\n\n\tconst reducers = {\n\t\t...Object.fromEntries(\n\t\t\tObject.entries(options.hooks.transport).map(([key, value]) => [key, value.encode])\n\t\t),\n\t\t/** @param {any} thing */\n\t\tPromise: (thing) => {\n\t\t\tif (typeof thing?.then === 'function') {\n\t\t\t\tconst id = promise_id++;\n\t\t\t\tcount += 1;\n\n\t\t\t\t/** @type {'data' | 'error'} */\n\t\t\t\tlet key = 'data';\n\n\t\t\t\tthing\n\t\t\t\t\t.catch(\n\t\t\t\t\t\t/** @param {any} e */ async (e) => {\n\t\t\t\t\t\t\tkey = 'error';\n\t\t\t\t\t\t\treturn handle_error_and_jsonify(event, options, /** @type {any} */ (e));\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t\t.then(\n\t\t\t\t\t\t/** @param {any} value */\n\t\t\t\t\t\tasync (value) => {\n\t\t\t\t\t\t\tlet str;\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tstr = devalue.stringify(value, reducers);\n\t\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\t\tconst error = await handle_error_and_jsonify(\n\t\t\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\t\t\tnew Error(`Failed to serialize promise while rendering ${event.route.id}`)\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tkey = 'error';\n\t\t\t\t\t\t\t\tstr = devalue.stringify(error, reducers);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tcount -= 1;\n\n\t\t\t\t\t\t\tpush(`{\"type\":\"chunk\",\"id\":${id},\"${key}\":${str}}\\n`);\n\t\t\t\t\t\t\tif (count === 0) done();\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\treturn id;\n\t\t\t}\n\t\t}\n\t};\n\n\ttry {\n\t\tconst strings = nodes.map((node) => {\n\t\t\tif (!node) return 'null';\n\n\t\t\tif (node.type === 'error' || node.type === 'skip') {\n\t\t\t\treturn JSON.stringify(node);\n\t\t\t}\n\n\t\t\treturn `{\"type\":\"data\",\"data\":${devalue.stringify(node.data, reducers)},\"uses\":${JSON.stringify(\n\t\t\t\tserialize_uses(node)\n\t\t\t)}${node.slash ? `,\"slash\":${JSON.stringify(node.slash)}` : ''}}`;\n\t\t});\n\n\t\treturn {\n\t\t\tdata: `{\"type\":\"data\",\"nodes\":[${strings.join(',')}]}\\n`,\n\t\t\tchunks: count > 0 ? iterator : null\n\t\t};\n\t} catch (e) {\n\t\t// @ts-expect-error\n\t\te.path = 'data' + e.path;\n\t\tthrow new Error(clarify_devalue_error(event, /** @type {any} */ (e)));\n\t}\n}\n","import { text } from '../../../exports/index.js';\nimport { compact } from '../../../utils/array.js';\nimport { get_status, normalize_error } from '../../../utils/error.js';\nimport { add_data_suffix } from '../../pathname.js';\nimport { Redirect } from '../../control.js';\nimport { redirect_response, static_error_page, handle_error_and_jsonify } from '../utils.js';\nimport {\n\thandle_action_json_request,\n\thandle_action_request,\n\tis_action_json_request,\n\tis_action_request\n} from './actions.js';\nimport { load_data, load_server_data } from './load_data.js';\nimport { render_response } from './render.js';\nimport { respond_with_error } from './respond_with_error.js';\nimport { get_data_json } from '../data/index.js';\nimport { DEV } from 'esm-env';\nimport { PageNodes } from '../../../utils/page_nodes.js';\n\n/**\n * The maximum request depth permitted before assuming we're stuck in an infinite loop\n */\nconst MAX_DEPTH = 10;\n\n/**\n * @param {import('@sveltejs/kit').RequestEvent} event\n * @param {import('types').PageNodeIndexes} page\n * @param {import('types').SSROptions} options\n * @param {import('@sveltejs/kit').SSRManifest} manifest\n * @param {import('types').SSRState} state\n * @param {import('../../../utils/page_nodes.js').PageNodes} nodes\n * @param {import('types').RequiredResolveOptions} resolve_opts\n * @returns {Promise<Response>}\n */\nexport async function render_page(event, page, options, manifest, state, nodes, resolve_opts) {\n\tif (state.depth > MAX_DEPTH) {\n\t\t// infinite request cycle detected\n\t\treturn text(`Not found: ${event.url.pathname}`, {\n\t\t\tstatus: 404 // TODO in some cases this should be 500. not sure how to differentiate\n\t\t});\n\t}\n\n\tif (is_action_json_request(event)) {\n\t\tconst node = await manifest._.nodes[page.leaf]();\n\t\treturn handle_action_json_request(event, options, node?.server);\n\t}\n\n\ttry {\n\t\tconst leaf_node = /** @type {import('types').SSRNode} */ (nodes.page());\n\n\t\tlet status = 200;\n\n\t\t/** @type {import('@sveltejs/kit').ActionResult | undefined} */\n\t\tlet action_result = undefined;\n\n\t\tif (is_action_request(event)) {\n\t\t\t// for action requests, first call handler in +page.server.js\n\t\t\t// (this also determines status code)\n\t\t\taction_result = await handle_action_request(event, leaf_node.server);\n\t\t\tif (action_result?.type === 'redirect') {\n\t\t\t\treturn redirect_response(action_result.status, action_result.location);\n\t\t\t}\n\t\t\tif (action_result?.type === 'error') {\n\t\t\t\tstatus = get_status(action_result.error);\n\t\t\t}\n\t\t\tif (action_result?.type === 'failure') {\n\t\t\t\tstatus = action_result.status;\n\t\t\t}\n\t\t}\n\n\t\t// it's crucial that we do this before returning the non-SSR response, otherwise\n\t\t// SvelteKit will erroneously believe that the path has been prerendered,\n\t\t// causing functions to be omitted from the manifest generated later\n\t\tconst should_prerender = nodes.prerender();\n\t\tif (should_prerender) {\n\t\t\tconst mod = leaf_node.server;\n\t\t\tif (mod?.actions) {\n\t\t\t\tthrow new Error('Cannot prerender pages with actions');\n\t\t\t}\n\t\t} else if (state.prerendering) {\n\t\t\t// if the page isn't marked as prerenderable, then bail out at this point\n\t\t\treturn new Response(undefined, {\n\t\t\t\tstatus: 204\n\t\t\t});\n\t\t}\n\n\t\t// if we fetch any endpoints while loading data for this page, they should\n\t\t// inherit the prerender option of the page\n\t\tstate.prerender_default = should_prerender;\n\n\t\tconst should_prerender_data = nodes.should_prerender_data();\n\t\tconst data_pathname = add_data_suffix(event.url.pathname);\n\n\t\t/** @type {import('./types.js').Fetched[]} */\n\t\tconst fetched = [];\n\n\t\tconst ssr = nodes.ssr();\n\t\tconst csr = nodes.csr();\n\n\t\t// renders an empty 'shell' page if SSR is turned off and if there is\n\t\t// no server data to prerender. As a result, the load functions and rendering\n\t\t// only occur client-side.\n\t\tif (ssr === false && !(state.prerendering && should_prerender_data)) {\n\t\t\t// if the user makes a request through a non-enhanced form, the returned value is lost\n\t\t\t// because there is no SSR or client-side handling of the response\n\t\t\tif (DEV && action_result && !event.request.headers.has('x-sveltekit-action')) {\n\t\t\t\tif (action_result.type === 'error') {\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\"The form action returned an error, but +error.svelte wasn't rendered because SSR is off. To get the error page with CSR, enhance your form with `use:enhance`. See https://svelte.dev/docs/kit/form-actions#progressive-enhancement-use-enhance\"\n\t\t\t\t\t);\n\t\t\t\t} else if (action_result.data) {\n\t\t\t\t\t/// case: lost data\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\"The form action returned a value, but it isn't available in `page.form`, because SSR is off. To handle the returned value in CSR, enhance your form with `use:enhance`. See https://svelte.dev/docs/kit/form-actions#progressive-enhancement-use-enhance\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn await render_response({\n\t\t\t\tbranch: [],\n\t\t\t\tfetched,\n\t\t\t\tpage_config: {\n\t\t\t\t\tssr: false,\n\t\t\t\t\tcsr\n\t\t\t\t},\n\t\t\t\tstatus,\n\t\t\t\terror: null,\n\t\t\t\tevent,\n\t\t\t\toptions,\n\t\t\t\tmanifest,\n\t\t\t\tstate,\n\t\t\t\tresolve_opts\n\t\t\t});\n\t\t}\n\n\t\t/** @type {Array<import('./types.js').Loaded | null>} */\n\t\tconst branch = [];\n\n\t\t/** @type {Error | null} */\n\t\tlet load_error = null;\n\n\t\t/** @type {Array<Promise<import('types').ServerDataNode | null>>} */\n\t\tconst server_promises = nodes.data.map((node, i) => {\n\t\t\tif (load_error) {\n\t\t\t\t// if an error happens immediately, don't bother with the rest of the nodes\n\t\t\t\tthrow load_error;\n\t\t\t}\n\n\t\t\treturn Promise.resolve().then(async () => {\n\t\t\t\ttry {\n\t\t\t\t\tif (node === leaf_node && action_result?.type === 'error') {\n\t\t\t\t\t\t// we wait until here to throw the error so that we can use\n\t\t\t\t\t\t// any nested +error.svelte components that were defined\n\t\t\t\t\t\tthrow action_result.error;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn await load_server_data({\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\tstate,\n\t\t\t\t\t\tnode,\n\t\t\t\t\t\tparent: async () => {\n\t\t\t\t\t\t\t/** @type {Record<string, any>} */\n\t\t\t\t\t\t\tconst data = {};\n\t\t\t\t\t\t\tfor (let j = 0; j < i; j += 1) {\n\t\t\t\t\t\t\t\tconst parent = await server_promises[j];\n\t\t\t\t\t\t\t\tif (parent) Object.assign(data, parent.data);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn data;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\tload_error = /** @type {Error} */ (e);\n\t\t\t\t\tthrow load_error;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t/** @type {Array<Promise<Record<string, any> | null>>} */\n\t\tconst load_promises = nodes.data.map((node, i) => {\n\t\t\tif (load_error) throw load_error;\n\t\t\treturn Promise.resolve().then(async () => {\n\t\t\t\ttry {\n\t\t\t\t\treturn await load_data({\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\tfetched,\n\t\t\t\t\t\tnode,\n\t\t\t\t\t\tparent: async () => {\n\t\t\t\t\t\t\tconst data = {};\n\t\t\t\t\t\t\tfor (let j = 0; j < i; j += 1) {\n\t\t\t\t\t\t\t\tObject.assign(data, await load_promises[j]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn data;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tresolve_opts,\n\t\t\t\t\t\tserver_data_promise: server_promises[i],\n\t\t\t\t\t\tstate,\n\t\t\t\t\t\tcsr\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\tload_error = /** @type {Error} */ (e);\n\t\t\t\t\tthrow load_error;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// if we don't do this, rejections will be unhandled\n\t\tfor (const p of server_promises) p.catch(() => {});\n\t\tfor (const p of load_promises) p.catch(() => {});\n\n\t\tfor (let i = 0; i < nodes.data.length; i += 1) {\n\t\t\tconst node = nodes.data[i];\n\n\t\t\tif (node) {\n\t\t\t\ttry {\n\t\t\t\t\tconst server_data = await server_promises[i];\n\t\t\t\t\tconst data = await load_promises[i];\n\n\t\t\t\t\tbranch.push({ node, server_data, data });\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconst err = normalize_error(e);\n\n\t\t\t\t\tif (err instanceof Redirect) {\n\t\t\t\t\t\tif (state.prerendering && should_prerender_data) {\n\t\t\t\t\t\t\tconst body = JSON.stringify({\n\t\t\t\t\t\t\t\ttype: 'redirect',\n\t\t\t\t\t\t\t\tlocation: err.location\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tstate.prerendering.dependencies.set(data_pathname, {\n\t\t\t\t\t\t\t\tresponse: text(body),\n\t\t\t\t\t\t\t\tbody\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn redirect_response(err.status, err.location);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst status = get_status(err);\n\t\t\t\t\tconst error = await handle_error_and_jsonify(event, options, err);\n\n\t\t\t\t\twhile (i--) {\n\t\t\t\t\t\tif (page.errors[i]) {\n\t\t\t\t\t\t\tconst index = /** @type {number} */ (page.errors[i]);\n\t\t\t\t\t\t\tconst node = await manifest._.nodes[index]();\n\n\t\t\t\t\t\t\tlet j = i;\n\t\t\t\t\t\t\twhile (!branch[j]) j -= 1;\n\n\t\t\t\t\t\t\tconst layouts = compact(branch.slice(0, j + 1));\n\t\t\t\t\t\t\tconst nodes = new PageNodes(layouts.map((layout) => layout.node));\n\n\t\t\t\t\t\t\treturn await render_response({\n\t\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\t\tmanifest,\n\t\t\t\t\t\t\t\tstate,\n\t\t\t\t\t\t\t\tresolve_opts,\n\t\t\t\t\t\t\t\tpage_config: {\n\t\t\t\t\t\t\t\t\tssr: nodes.ssr(),\n\t\t\t\t\t\t\t\t\tcsr: nodes.csr()\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\t\terror,\n\t\t\t\t\t\t\t\tbranch: layouts.concat({\n\t\t\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\t\t\tdata: null,\n\t\t\t\t\t\t\t\t\tserver_data: null\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tfetched\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// if we're still here, it means the error happened in the root layout,\n\t\t\t\t\t// which means we have to fall back to error.html\n\t\t\t\t\treturn static_error_page(options, status, error.message);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// push an empty slot so we can rewind past gaps to the\n\t\t\t\t// layout that corresponds with an +error.svelte page\n\t\t\t\tbranch.push(null);\n\t\t\t}\n\t\t}\n\n\t\tif (state.prerendering && should_prerender_data) {\n\t\t\t// ndjson format\n\t\t\tlet { data, chunks } = get_data_json(\n\t\t\t\tevent,\n\t\t\t\toptions,\n\t\t\t\tbranch.map((node) => node?.server_data)\n\t\t\t);\n\n\t\t\tif (chunks) {\n\t\t\t\tfor await (const chunk of chunks) {\n\t\t\t\t\tdata += chunk;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tstate.prerendering.dependencies.set(data_pathname, {\n\t\t\t\tresponse: text(data),\n\t\t\t\tbody: data\n\t\t\t});\n\t\t}\n\n\t\treturn await render_response({\n\t\t\tevent,\n\t\t\toptions,\n\t\t\tmanifest,\n\t\t\tstate,\n\t\t\tresolve_opts,\n\t\t\tpage_config: {\n\t\t\t\tcsr,\n\t\t\t\tssr\n\t\t\t},\n\t\t\tstatus,\n\t\t\terror: null,\n\t\t\tbranch: ssr === false ? [] : compact(branch),\n\t\t\taction_result,\n\t\t\tfetched\n\t\t});\n\t} catch (e) {\n\t\t// if we end up here, it means the data loaded successfully\n\t\t// but the page failed to render, or that a prerendering error occurred\n\t\treturn await respond_with_error({\n\t\t\tevent,\n\t\t\toptions,\n\t\t\tmanifest,\n\t\t\tstate,\n\t\t\tstatus: 500,\n\t\t\terror: e,\n\t\t\tresolve_opts\n\t\t});\n\t}\n}\n","import { parse, serialize } from 'cookie';\nimport { normalize_path, resolve } from '../../utils/url.js';\nimport { add_data_suffix } from '../pathname.js';\n\n// eslint-disable-next-line no-control-regex -- control characters are invalid in cookie names\nconst INVALID_COOKIE_CHARACTER_REGEX = /[\\x00-\\x1F\\x7F()<>@,;:\"/[\\]?={} \\t]/;\n\n/**\n * Tracks all cookies set during dev mode so we can emit warnings\n * when we detect that there's likely cookie misusage due to wrong paths\n *\n * @type {Record<string, Set<string>>} */\nconst cookie_paths = {};\n\n/**\n * Cookies that are larger than this size (including the name and other\n * attributes) are discarded by browsers\n */\nconst MAX_COOKIE_SIZE = 4129;\n\n// TODO 3.0 remove this check\n/** @param {import('./page/types.js').Cookie['options']} options */\nfunction validate_options(options) {\n\tif (options?.path === undefined) {\n\t\tthrow new Error('You must specify a `path` when setting, deleting or serializing cookies');\n\t}\n}\n\n/**\n * @param {Request} request\n * @param {URL} url\n */\nexport function get_cookies(request, url) {\n\tconst header = request.headers.get('cookie') ?? '';\n\tconst initial_cookies = parse(header, { decode: (value) => value });\n\n\t/** @type {string | undefined} */\n\tlet normalized_url;\n\n\t/** @type {Record<string, import('./page/types.js').Cookie>} */\n\tconst new_cookies = {};\n\n\t/** @type {import('cookie').CookieSerializeOptions} */\n\tconst defaults = {\n\t\thttpOnly: true,\n\t\tsameSite: 'lax',\n\t\tsecure: url.hostname === 'localhost' && url.protocol === 'http:' ? false : true\n\t};\n\n\t/** @type {import('@sveltejs/kit').Cookies} */\n\tconst cookies = {\n\t\t// The JSDoc param annotations appearing below for get, set and delete\n\t\t// are necessary to expose the `cookie` library types to\n\t\t// typescript users. `@type {import('@sveltejs/kit').Cookies}` above is not\n\t\t// sufficient to do so.\n\n\t\t/**\n\t\t * @param {string} name\n\t\t * @param {import('cookie').CookieParseOptions} [opts]\n\t\t */\n\t\tget(name, opts) {\n\t\t\tconst c = new_cookies[name];\n\t\t\tif (\n\t\t\t\tc &&\n\t\t\t\tdomain_matches(url.hostname, c.options.domain) &&\n\t\t\t\tpath_matches(url.pathname, c.options.path)\n\t\t\t) {\n\t\t\t\treturn c.value;\n\t\t\t}\n\n\t\t\tconst req_cookies = parse(header, { decode: opts?.decode });\n\t\t\tconst cookie = req_cookies[name]; // the decoded string or undefined\n\n\t\t\t// in development, if the cookie was set during this session with `cookies.set`,\n\t\t\t// but at a different path, warn the user. (ignore cookies from request headers,\n\t\t\t// since we don't know which path they were set at)\n\t\t\tif (__SVELTEKIT_DEV__ && !cookie) {\n\t\t\t\tconst paths = Array.from(cookie_paths[name] ?? []).filter((path) => {\n\t\t\t\t\t// we only care about paths that are _more_ specific than the current path\n\t\t\t\t\treturn path_matches(path, url.pathname) && path !== url.pathname;\n\t\t\t\t});\n\n\t\t\t\tif (paths.length > 0) {\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t// prettier-ignore\n\t\t\t\t\t\t`'${name}' cookie does not exist for ${url.pathname}, but was previously set at ${conjoin([...paths])}. Did you mean to set its 'path' to '/' instead?`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn cookie;\n\t\t},\n\n\t\t/**\n\t\t * @param {import('cookie').CookieParseOptions} [opts]\n\t\t */\n\t\tgetAll(opts) {\n\t\t\tconst cookies = parse(header, { decode: opts?.decode });\n\n\t\t\tfor (const c of Object.values(new_cookies)) {\n\t\t\t\tif (\n\t\t\t\t\tdomain_matches(url.hostname, c.options.domain) &&\n\t\t\t\t\tpath_matches(url.pathname, c.options.path)\n\t\t\t\t) {\n\t\t\t\t\tcookies[c.name] = c.value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn Object.entries(cookies).map(([name, value]) => ({ name, value }));\n\t\t},\n\n\t\t/**\n\t\t * @param {string} name\n\t\t * @param {string} value\n\t\t * @param {import('./page/types.js').Cookie['options']} options\n\t\t */\n\t\tset(name, value, options) {\n\t\t\t// TODO: remove this check in 3.0\n\t\t\tconst illegal_characters = name.match(INVALID_COOKIE_CHARACTER_REGEX);\n\t\t\tif (illegal_characters) {\n\t\t\t\tconsole.warn(\n\t\t\t\t\t`The cookie name \"${name}\" will be invalid in SvelteKit 3.0 as it contains ${illegal_characters.join(\n\t\t\t\t\t\t' and '\n\t\t\t\t\t)}. See RFC 2616 for more details https://datatracker.ietf.org/doc/html/rfc2616#section-2.2`\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tvalidate_options(options);\n\t\t\tset_internal(name, value, { ...defaults, ...options });\n\t\t},\n\n\t\t/**\n\t\t * @param {string} name\n\t\t *  @param {import('./page/types.js').Cookie['options']} options\n\t\t */\n\t\tdelete(name, options) {\n\t\t\tvalidate_options(options);\n\t\t\tcookies.set(name, '', { ...options, maxAge: 0 });\n\t\t},\n\n\t\t/**\n\t\t * @param {string} name\n\t\t * @param {string} value\n\t\t *  @param {import('./page/types.js').Cookie['options']} options\n\t\t */\n\t\tserialize(name, value, options) {\n\t\t\tvalidate_options(options);\n\n\t\t\tlet path = options.path;\n\n\t\t\tif (!options.domain || options.domain === url.hostname) {\n\t\t\t\tif (!normalized_url) {\n\t\t\t\t\tthrow new Error('Cannot serialize cookies until after the route is determined');\n\t\t\t\t}\n\t\t\t\tpath = resolve(normalized_url, path);\n\t\t\t}\n\n\t\t\treturn serialize(name, value, { ...defaults, ...options, path });\n\t\t}\n\t};\n\n\t/**\n\t * @param {URL} destination\n\t * @param {string | null} header\n\t */\n\tfunction get_cookie_header(destination, header) {\n\t\t/** @type {Record<string, string>} */\n\t\tconst combined_cookies = {\n\t\t\t// cookies sent by the user agent have lowest precedence\n\t\t\t...initial_cookies\n\t\t};\n\n\t\t// cookies previous set during this event with cookies.set have higher precedence\n\t\tfor (const key in new_cookies) {\n\t\t\tconst cookie = new_cookies[key];\n\t\t\tif (!domain_matches(destination.hostname, cookie.options.domain)) continue;\n\t\t\tif (!path_matches(destination.pathname, cookie.options.path)) continue;\n\n\t\t\tconst encoder = cookie.options.encode || encodeURIComponent;\n\t\t\tcombined_cookies[cookie.name] = encoder(cookie.value);\n\t\t}\n\n\t\t// explicit header has highest precedence\n\t\tif (header) {\n\t\t\tconst parsed = parse(header, { decode: (value) => value });\n\t\t\tfor (const name in parsed) {\n\t\t\t\tcombined_cookies[name] = parsed[name];\n\t\t\t}\n\t\t}\n\n\t\treturn Object.entries(combined_cookies)\n\t\t\t.map(([name, value]) => `${name}=${value}`)\n\t\t\t.join('; ');\n\t}\n\n\t/** @type {Array<() => void>} */\n\tconst internal_queue = [];\n\n\t/**\n\t * @param {string} name\n\t * @param {string} value\n\t * @param {import('./page/types.js').Cookie['options']} options\n\t */\n\tfunction set_internal(name, value, options) {\n\t\tif (!normalized_url) {\n\t\t\tinternal_queue.push(() => set_internal(name, value, options));\n\t\t\treturn;\n\t\t}\n\n\t\tlet path = options.path;\n\n\t\tif (!options.domain || options.domain === url.hostname) {\n\t\t\tpath = resolve(normalized_url, path);\n\t\t}\n\n\t\tnew_cookies[name] = { name, value, options: { ...options, path } };\n\n\t\tif (__SVELTEKIT_DEV__) {\n\t\t\tconst serialized = serialize(name, value, new_cookies[name].options);\n\t\t\tif (new TextEncoder().encode(serialized).byteLength > MAX_COOKIE_SIZE) {\n\t\t\t\tthrow new Error(`Cookie \"${name}\" is too large, and will be discarded by the browser`);\n\t\t\t}\n\n\t\t\tcookie_paths[name] ??= new Set();\n\n\t\t\tif (!value) {\n\t\t\t\tcookie_paths[name].delete(path);\n\t\t\t} else {\n\t\t\t\tcookie_paths[name].add(path);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @param {import('types').TrailingSlash} trailing_slash\n\t */\n\tfunction set_trailing_slash(trailing_slash) {\n\t\tnormalized_url = normalize_path(url.pathname, trailing_slash);\n\t\tinternal_queue.forEach((fn) => fn());\n\t}\n\n\treturn { cookies, new_cookies, get_cookie_header, set_internal, set_trailing_slash };\n}\n\n/**\n * @param {string} hostname\n * @param {string} [constraint]\n */\nexport function domain_matches(hostname, constraint) {\n\tif (!constraint) return true;\n\n\tconst normalized = constraint[0] === '.' ? constraint.slice(1) : constraint;\n\n\tif (hostname === normalized) return true;\n\treturn hostname.endsWith('.' + normalized);\n}\n\n/**\n * @param {string} path\n * @param {string} [constraint]\n */\nexport function path_matches(path, constraint) {\n\tif (!constraint) return true;\n\n\tconst normalized = constraint.endsWith('/') ? constraint.slice(0, -1) : constraint;\n\n\tif (path === normalized) return true;\n\treturn path.startsWith(normalized + '/');\n}\n\n/**\n * @param {Headers} headers\n * @param {import('./page/types.js').Cookie[]} cookies\n */\nexport function add_cookies_to_headers(headers, cookies) {\n\tfor (const new_cookie of cookies) {\n\t\tconst { name, value, options } = new_cookie;\n\t\theaders.append('set-cookie', serialize(name, value, options));\n\n\t\t// special case — for routes ending with .html, the route data lives in a sibling\n\t\t// `.html__data.json` file rather than a child `/__data.json` file, which means\n\t\t// we need to duplicate the cookie\n\t\tif (options.path.endsWith('.html')) {\n\t\t\tconst path = add_data_suffix(options.path);\n\t\t\theaders.append('set-cookie', serialize(name, value, { ...options, path }));\n\t\t}\n\t}\n}\n\n/**\n * @param {string[]} array\n */\nfunction conjoin(array) {\n\tif (array.length <= 2) return array.join(' and ');\n\treturn `${array.slice(0, -1).join(', ')} and ${array.at(-1)}`;\n}\n","import * as set_cookie_parser from 'set-cookie-parser';\nimport { respond } from './respond.js';\nimport * as paths from '__sveltekit/paths';\nimport { read_implementation } from '__sveltekit/server';\nimport { has_prerendered_path } from './utils.js';\n\n/**\n * @param {{\n *   event: import('@sveltejs/kit').RequestEvent;\n *   options: import('types').SSROptions;\n *   manifest: import('@sveltejs/kit').SSRManifest;\n *   state: import('types').SSRState;\n *   get_cookie_header: (url: URL, header: string | null) => string;\n *   set_internal: (name: string, value: string, opts: import('./page/types.js').Cookie['options']) => void;\n * }} opts\n * @returns {typeof fetch}\n */\nexport function create_fetch({ event, options, manifest, state, get_cookie_header, set_internal }) {\n\t/**\n\t * @type {typeof fetch}\n\t */\n\tconst server_fetch = async (info, init) => {\n\t\tconst original_request = normalize_fetch_input(info, init, event.url);\n\n\t\t// some runtimes (e.g. Cloudflare) error if you access `request.mode`,\n\t\t// annoyingly, so we need to read the value from the `init` object instead\n\t\tlet mode = (info instanceof Request ? info.mode : init?.mode) ?? 'cors';\n\t\tlet credentials =\n\t\t\t(info instanceof Request ? info.credentials : init?.credentials) ?? 'same-origin';\n\n\t\treturn options.hooks.handleFetch({\n\t\t\tevent,\n\t\t\trequest: original_request,\n\t\t\tfetch: async (info, init) => {\n\t\t\t\tconst request = normalize_fetch_input(info, init, event.url);\n\n\t\t\t\tconst url = new URL(request.url);\n\n\t\t\t\tif (!request.headers.has('origin')) {\n\t\t\t\t\trequest.headers.set('origin', event.url.origin);\n\t\t\t\t}\n\n\t\t\t\tif (info !== original_request) {\n\t\t\t\t\tmode = (info instanceof Request ? info.mode : init?.mode) ?? 'cors';\n\t\t\t\t\tcredentials =\n\t\t\t\t\t\t(info instanceof Request ? info.credentials : init?.credentials) ?? 'same-origin';\n\t\t\t\t}\n\n\t\t\t\t// Remove Origin, according to https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin#description\n\t\t\t\tif (\n\t\t\t\t\t(request.method === 'GET' || request.method === 'HEAD') &&\n\t\t\t\t\t((mode === 'no-cors' && url.origin !== event.url.origin) ||\n\t\t\t\t\t\turl.origin === event.url.origin)\n\t\t\t\t) {\n\t\t\t\t\trequest.headers.delete('origin');\n\t\t\t\t}\n\n\t\t\t\tif (url.origin !== event.url.origin) {\n\t\t\t\t\t// Allow cookie passthrough for \"credentials: same-origin\" and \"credentials: include\"\n\t\t\t\t\t// if SvelteKit is serving my.domain.com:\n\t\t\t\t\t// -        domain.com WILL NOT receive cookies\n\t\t\t\t\t// -     my.domain.com WILL receive cookies\n\t\t\t\t\t// -    api.domain.dom WILL NOT receive cookies\n\t\t\t\t\t// - sub.my.domain.com WILL receive cookies\n\t\t\t\t\t// ports do not affect the resolution\n\t\t\t\t\t// leading dot prevents mydomain.com matching domain.com\n\t\t\t\t\t// Do not forward other cookies for \"credentials: include\" because we don't know\n\t\t\t\t\t// which cookie belongs to which domain (browser does not pass this info)\n\t\t\t\t\tif (`.${url.hostname}`.endsWith(`.${event.url.hostname}`) && credentials !== 'omit') {\n\t\t\t\t\t\tconst cookie = get_cookie_header(url, request.headers.get('cookie'));\n\t\t\t\t\t\tif (cookie) request.headers.set('cookie', cookie);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn fetch(request);\n\t\t\t\t}\n\n\t\t\t\t// handle fetch requests for static assets. e.g. prebaked data, etc.\n\t\t\t\t// we need to support everything the browser's fetch supports\n\t\t\t\tconst prefix = paths.assets || paths.base;\n\t\t\t\tconst decoded = decodeURIComponent(url.pathname);\n\t\t\t\tconst filename = (\n\t\t\t\t\tdecoded.startsWith(prefix) ? decoded.slice(prefix.length) : decoded\n\t\t\t\t).slice(1);\n\t\t\t\tconst filename_html = `${filename}/index.html`; // path may also match path/index.html\n\n\t\t\t\tconst is_asset = manifest.assets.has(filename) || filename in manifest._.server_assets;\n\t\t\t\tconst is_asset_html =\n\t\t\t\t\tmanifest.assets.has(filename_html) || filename_html in manifest._.server_assets;\n\n\t\t\t\tif (is_asset || is_asset_html) {\n\t\t\t\t\tconst file = is_asset ? filename : filename_html;\n\n\t\t\t\t\tif (state.read) {\n\t\t\t\t\t\tconst type = is_asset\n\t\t\t\t\t\t\t? manifest.mimeTypes[filename.slice(filename.lastIndexOf('.'))]\n\t\t\t\t\t\t\t: 'text/html';\n\n\t\t\t\t\t\treturn new Response(state.read(file), {\n\t\t\t\t\t\t\theaders: type ? { 'content-type': type } : {}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if (read_implementation && file in manifest._.server_assets) {\n\t\t\t\t\t\tconst length = manifest._.server_assets[file];\n\t\t\t\t\t\tconst type = manifest.mimeTypes[file.slice(file.lastIndexOf('.'))];\n\n\t\t\t\t\t\treturn new Response(read_implementation(file), {\n\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t'Content-Length': '' + length,\n\t\t\t\t\t\t\t\t'Content-Type': type\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\treturn await fetch(request);\n\t\t\t\t}\n\n\t\t\t\tif (has_prerendered_path(manifest, paths.base + decoded)) {\n\t\t\t\t\t// The path of something prerendered could match a different route\n\t\t\t\t\t// that is still in the manifest, leading to the wrong route being loaded.\n\t\t\t\t\t// We therefore bail early here. The prerendered logic is different for\n\t\t\t\t\t// each adapter, (except maybe for prerendered redirects)\n\t\t\t\t\t// so we need to make an actual HTTP request.\n\t\t\t\t\treturn await fetch(request);\n\t\t\t\t}\n\n\t\t\t\tif (credentials !== 'omit') {\n\t\t\t\t\tconst cookie = get_cookie_header(url, request.headers.get('cookie'));\n\t\t\t\t\tif (cookie) {\n\t\t\t\t\t\trequest.headers.set('cookie', cookie);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst authorization = event.request.headers.get('authorization');\n\t\t\t\t\tif (authorization && !request.headers.has('authorization')) {\n\t\t\t\t\t\trequest.headers.set('authorization', authorization);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!request.headers.has('accept')) {\n\t\t\t\t\trequest.headers.set('accept', '*/*');\n\t\t\t\t}\n\n\t\t\t\tif (!request.headers.has('accept-language')) {\n\t\t\t\t\trequest.headers.set(\n\t\t\t\t\t\t'accept-language',\n\t\t\t\t\t\t/** @type {string} */ (event.request.headers.get('accept-language'))\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tconst response = await internal_fetch(request, options, manifest, state);\n\n\t\t\t\tconst set_cookie = response.headers.get('set-cookie');\n\t\t\t\tif (set_cookie) {\n\t\t\t\t\tfor (const str of set_cookie_parser.splitCookiesString(set_cookie)) {\n\t\t\t\t\t\tconst { name, value, ...options } = set_cookie_parser.parseString(str, {\n\t\t\t\t\t\t\tdecodeValues: false\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tconst path = options.path ?? (url.pathname.split('/').slice(0, -1).join('/') || '/');\n\n\t\t\t\t\t\t// options.sameSite is string, something more specific is required - type cast is safe\n\t\t\t\t\t\tset_internal(name, value, {\n\t\t\t\t\t\t\tpath,\n\t\t\t\t\t\t\tencode: (value) => value,\n\t\t\t\t\t\t\t.../** @type {import('cookie').CookieSerializeOptions} */ (options)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn response;\n\t\t\t}\n\t\t});\n\t};\n\n\t// Don't make this function `async`! Otherwise, the user has to `catch` promises they use for streaming responses or else\n\t// it will be an unhandled rejection. Instead, we add a `.catch(() => {})` ourselves below to prevent this from happening.\n\treturn (input, init) => {\n\t\t// See docs in fetch.js for why we need to do this\n\t\tconst response = server_fetch(input, init);\n\t\tresponse.catch(() => {});\n\t\treturn response;\n\t};\n}\n\n/**\n * @param {RequestInfo | URL} info\n * @param {RequestInit | undefined} init\n * @param {URL} url\n */\nfunction normalize_fetch_input(info, init, url) {\n\tif (info instanceof Request) {\n\t\treturn info;\n\t}\n\n\treturn new Request(typeof info === 'string' ? new URL(info, url) : info, init);\n}\n\n/**\n * @param {Request} request\n * @param {import('types').SSROptions} options\n * @param {import('@sveltejs/kit').SSRManifest} manifest\n * @param {import('types').SSRState} state\n * @returns {Promise<Response>}\n */\nasync function internal_fetch(request, options, manifest, state) {\n\tif (request.signal) {\n\t\tif (request.signal.aborted) {\n\t\t\tthrow new DOMException('The operation was aborted.', 'AbortError');\n\t\t}\n\n\t\tlet remove_abort_listener = () => {};\n\t\t/** @type {Promise<never>} */\n\t\tconst abort_promise = new Promise((_, reject) => {\n\t\t\tconst on_abort = () => {\n\t\t\t\treject(new DOMException('The operation was aborted.', 'AbortError'));\n\t\t\t};\n\t\t\trequest.signal.addEventListener('abort', on_abort, { once: true });\n\t\t\tremove_abort_listener = () => request.signal.removeEventListener('abort', on_abort);\n\t\t});\n\n\t\tconst result = await Promise.race([\n\t\t\trespond(request, options, manifest, {\n\t\t\t\t...state,\n\t\t\t\tdepth: state.depth + 1\n\t\t\t}),\n\t\t\tabort_promise\n\t\t]);\n\t\tremove_abort_listener();\n\t\treturn result;\n\t} else {\n\t\treturn await respond(request, options, manifest, {\n\t\t\t...state,\n\t\t\tdepth: state.depth + 1\n\t\t});\n\t}\n}\n","import { public_env } from '../shared-server.js';\n\n/** @type {string} */\nlet body;\n\n/** @type {string} */\nlet etag;\n\n/** @type {Headers} */\nlet headers;\n\n/**\n * @param {Request} request\n * @returns {Response}\n */\nexport function get_public_env(request) {\n\tbody ??= `export const env=${JSON.stringify(public_env)}`;\n\tetag ??= `W/${Date.now()}`;\n\theaders ??= new Headers({\n\t\t'content-type': 'application/javascript; charset=utf-8',\n\t\tetag\n\t});\n\n\tif (request.headers.get('if-none-match') === etag) {\n\t\treturn new Response(undefined, { status: 304, headers });\n\t}\n\n\treturn new Response(body, { headers });\n}\n","import { DEV } from 'esm-env';\nimport { base, app_dir } from '__sveltekit/paths';\nimport { is_endpoint_request, render_endpoint } from './endpoint.js';\nimport { render_page } from './page/index.js';\nimport { render_response } from './page/render.js';\nimport { respond_with_error } from './page/respond_with_error.js';\nimport { is_form_content_type } from '../../utils/http.js';\nimport {\n\thandle_fatal_error,\n\thas_prerendered_path,\n\tmethod_not_allowed,\n\tredirect_response\n} from './utils.js';\nimport { decode_pathname, decode_params, disable_search, normalize_path } from '../../utils/url.js';\nimport { exec } from '../../utils/routing.js';\nimport { redirect_json_response, render_data } from './data/index.js';\nimport { add_cookies_to_headers, get_cookies } from './cookie.js';\nimport { create_fetch } from './fetch.js';\nimport { PageNodes } from '../../utils/page_nodes.js';\nimport { HttpError, Redirect, SvelteKitError } from '../control.js';\nimport { validate_server_exports } from '../../utils/exports.js';\nimport { json, text } from '../../exports/index.js';\nimport { action_json_redirect, is_action_json_request } from './page/actions.js';\nimport { INVALIDATED_PARAM, TRAILING_SLASH_PARAM } from '../shared.js';\nimport { get_public_env } from './env_module.js';\nimport { resolve_route } from './page/server_routing.js';\nimport { validateHeaders } from './validate-headers.js';\nimport {\n\tadd_data_suffix,\n\tadd_resolution_suffix,\n\thas_data_suffix,\n\thas_resolution_suffix,\n\tstrip_data_suffix,\n\tstrip_resolution_suffix\n} from '../pathname.js';\nimport { with_event } from '../app/server/event.js';\n\n/* global __SVELTEKIT_ADAPTER_NAME__ */\n/* global __SVELTEKIT_DEV__ */\n\n/** @type {import('types').RequiredResolveOptions['transformPageChunk']} */\nconst default_transform = ({ html }) => html;\n\n/** @type {import('types').RequiredResolveOptions['filterSerializedResponseHeaders']} */\nconst default_filter = () => false;\n\n/** @type {import('types').RequiredResolveOptions['preload']} */\nconst default_preload = ({ type }) => type === 'js' || type === 'css';\n\nconst page_methods = new Set(['GET', 'HEAD', 'POST']);\n\nconst allowed_page_methods = new Set(['GET', 'HEAD', 'OPTIONS']);\n\nlet warned_on_devtools_json_request = false;\n\n/**\n * @param {Request} request\n * @param {import('types').SSROptions} options\n * @param {import('@sveltejs/kit').SSRManifest} manifest\n * @param {import('types').SSRState} state\n * @returns {Promise<Response>}\n */\nexport async function respond(request, options, manifest, state) {\n\t/** URL but stripped from the potential `/__data.json` suffix and its search param  */\n\tconst url = new URL(request.url);\n\n\tif (options.csrf_check_origin) {\n\t\tconst forbidden =\n\t\t\tis_form_content_type(request) &&\n\t\t\t(request.method === 'POST' ||\n\t\t\t\trequest.method === 'PUT' ||\n\t\t\t\trequest.method === 'PATCH' ||\n\t\t\t\trequest.method === 'DELETE') &&\n\t\t\trequest.headers.get('origin') !== url.origin;\n\n\t\tif (forbidden) {\n\t\t\tconst csrf_error = new HttpError(\n\t\t\t\t403,\n\t\t\t\t`Cross-site ${request.method} form submissions are forbidden`\n\t\t\t);\n\t\t\tif (request.headers.get('accept') === 'application/json') {\n\t\t\t\treturn json(csrf_error.body, { status: csrf_error.status });\n\t\t\t}\n\t\t\treturn text(csrf_error.body.message, { status: csrf_error.status });\n\t\t}\n\t}\n\n\tif (options.hash_routing && url.pathname !== base + '/' && url.pathname !== '/[fallback]') {\n\t\treturn text('Not found', { status: 404 });\n\t}\n\n\t/** @type {boolean[] | undefined} */\n\tlet invalidated_data_nodes;\n\n\t/**\n\t * If the request is for a route resolution, first modify the URL, then continue as normal\n\t * for path resolution, then return the route object as a JS file.\n\t */\n\tconst is_route_resolution_request = has_resolution_suffix(url.pathname);\n\tconst is_data_request = has_data_suffix(url.pathname);\n\n\tif (is_route_resolution_request) {\n\t\turl.pathname = strip_resolution_suffix(url.pathname);\n\t} else if (is_data_request) {\n\t\turl.pathname =\n\t\t\tstrip_data_suffix(url.pathname) +\n\t\t\t\t(url.searchParams.get(TRAILING_SLASH_PARAM) === '1' ? '/' : '') || '/';\n\t\turl.searchParams.delete(TRAILING_SLASH_PARAM);\n\t\tinvalidated_data_nodes = url.searchParams\n\t\t\t.get(INVALIDATED_PARAM)\n\t\t\t?.split('')\n\t\t\t.map((node) => node === '1');\n\t\turl.searchParams.delete(INVALIDATED_PARAM);\n\t}\n\n\t/** @type {Record<string, string>} */\n\tconst headers = {};\n\n\tconst { cookies, new_cookies, get_cookie_header, set_internal, set_trailing_slash } = get_cookies(\n\t\trequest,\n\t\turl\n\t);\n\n\t/** @type {import('@sveltejs/kit').RequestEvent} */\n\tconst event = {\n\t\tcookies,\n\t\t// @ts-expect-error `fetch` needs to be created after the `event` itself\n\t\tfetch: null,\n\t\tgetClientAddress:\n\t\t\tstate.getClientAddress ||\n\t\t\t(() => {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t`${__SVELTEKIT_ADAPTER_NAME__} does not specify getClientAddress. Please raise an issue`\n\t\t\t\t);\n\t\t\t}),\n\t\tlocals: {},\n\t\tparams: {},\n\t\tplatform: state.platform,\n\t\trequest,\n\t\troute: { id: null },\n\t\tsetHeaders: (new_headers) => {\n\t\t\tif (__SVELTEKIT_DEV__) {\n\t\t\t\tvalidateHeaders(new_headers);\n\t\t\t}\n\n\t\t\tfor (const key in new_headers) {\n\t\t\t\tconst lower = key.toLowerCase();\n\t\t\t\tconst value = new_headers[key];\n\n\t\t\t\tif (lower === 'set-cookie') {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t'Use `event.cookies.set(name, value, options)` instead of `event.setHeaders` to set cookies'\n\t\t\t\t\t);\n\t\t\t\t} else if (lower in headers) {\n\t\t\t\t\tthrow new Error(`\"${key}\" header is already set`);\n\t\t\t\t} else {\n\t\t\t\t\theaders[lower] = value;\n\n\t\t\t\t\tif (state.prerendering && lower === 'cache-control') {\n\t\t\t\t\t\tstate.prerendering.cache = /** @type {string} */ (value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\turl,\n\t\tisDataRequest: is_data_request,\n\t\tisSubRequest: state.depth > 0\n\t};\n\n\tevent.fetch = create_fetch({\n\t\tevent,\n\t\toptions,\n\t\tmanifest,\n\t\tstate,\n\t\tget_cookie_header,\n\t\tset_internal\n\t});\n\n\tif (state.emulator?.platform) {\n\t\tevent.platform = await state.emulator.platform({\n\t\t\tconfig: {},\n\t\t\tprerender: !!state.prerendering?.fallback\n\t\t});\n\t}\n\n\tlet resolved_path;\n\n\tconst prerendering_reroute_state = state.prerendering?.inside_reroute;\n\ttry {\n\t\t// For the duration or a reroute, disable the prerendering state as reroute could call API endpoints\n\t\t// which would end up in the wrong logic path if not disabled.\n\t\tif (state.prerendering) state.prerendering.inside_reroute = true;\n\n\t\t// reroute could alter the given URL, so we pass a copy\n\t\tresolved_path =\n\t\t\t(await options.hooks.reroute({ url: new URL(url), fetch: event.fetch })) ?? url.pathname;\n\t} catch {\n\t\treturn text('Internal Server Error', {\n\t\t\tstatus: 500\n\t\t});\n\t} finally {\n\t\tif (state.prerendering) state.prerendering.inside_reroute = prerendering_reroute_state;\n\t}\n\n\ttry {\n\t\tresolved_path = decode_pathname(resolved_path);\n\t} catch {\n\t\treturn text('Malformed URI', { status: 400 });\n\t}\n\n\tif (\n\t\tresolved_path !== url.pathname &&\n\t\t!state.prerendering?.fallback &&\n\t\thas_prerendered_path(manifest, resolved_path)\n\t) {\n\t\tconst url = new URL(request.url);\n\t\turl.pathname = is_data_request\n\t\t\t? add_data_suffix(resolved_path)\n\t\t\t: is_route_resolution_request\n\t\t\t\t? add_resolution_suffix(resolved_path)\n\t\t\t\t: resolved_path;\n\n\t\t// `fetch` automatically decodes the body, so we need to delete the related headers to not break the response\n\t\t// Also see https://github.com/sveltejs/kit/issues/12197 for more info (we should fix this more generally at some point)\n\t\tconst response = await fetch(url, request);\n\t\tconst headers = new Headers(response.headers);\n\t\tif (headers.has('content-encoding')) {\n\t\t\theaders.delete('content-encoding');\n\t\t\theaders.delete('content-length');\n\t\t}\n\n\t\treturn new Response(response.body, {\n\t\t\theaders,\n\t\t\tstatus: response.status,\n\t\t\tstatusText: response.statusText\n\t\t});\n\t}\n\n\t/** @type {import('types').SSRRoute | null} */\n\tlet route = null;\n\n\tif (base && !state.prerendering?.fallback) {\n\t\tif (!resolved_path.startsWith(base)) {\n\t\t\treturn text('Not found', { status: 404 });\n\t\t}\n\t\tresolved_path = resolved_path.slice(base.length) || '/';\n\t}\n\n\tif (is_route_resolution_request) {\n\t\treturn resolve_route(resolved_path, new URL(request.url), manifest);\n\t}\n\n\tif (resolved_path === `/${app_dir}/env.js`) {\n\t\treturn get_public_env(request);\n\t}\n\n\tif (resolved_path.startsWith(`/${app_dir}`)) {\n\t\t// Ensure that 404'd static assets are not cached - some adapters might apply caching by default\n\t\tconst headers = new Headers();\n\t\theaders.set('cache-control', 'public, max-age=0, must-revalidate');\n\t\treturn text('Not found', { status: 404, headers });\n\t}\n\n\tif (!state.prerendering?.fallback) {\n\t\t// TODO this could theoretically break — should probably be inside a try-catch\n\t\tconst matchers = await manifest._.matchers();\n\n\t\tfor (const candidate of manifest._.routes) {\n\t\t\tconst match = candidate.pattern.exec(resolved_path);\n\t\t\tif (!match) continue;\n\n\t\t\tconst matched = exec(match, candidate.params, matchers);\n\t\t\tif (matched) {\n\t\t\t\troute = candidate;\n\t\t\t\tevent.route = { id: route.id };\n\t\t\t\tevent.params = decode_params(matched);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t/** @type {import('types').RequiredResolveOptions} */\n\tlet resolve_opts = {\n\t\ttransformPageChunk: default_transform,\n\t\tfilterSerializedResponseHeaders: default_filter,\n\t\tpreload: default_preload\n\t};\n\n\t/** @type {import('types').TrailingSlash} */\n\tlet trailing_slash = 'never';\n\n\ttry {\n\t\t/** @type {PageNodes | undefined} */\n\t\tconst page_nodes = route?.page\n\t\t\t? new PageNodes(await load_page_nodes(route.page, manifest))\n\t\t\t: undefined;\n\n\t\t// determine whether we need to redirect to add/remove a trailing slash\n\t\tif (route) {\n\t\t\t// if `paths.base === '/a/b/c`, then the root route is `/a/b/c/`,\n\t\t\t// regardless of the `trailingSlash` route option\n\t\t\tif (url.pathname === base || url.pathname === base + '/') {\n\t\t\t\ttrailing_slash = 'always';\n\t\t\t} else if (page_nodes) {\n\t\t\t\tif (DEV) {\n\t\t\t\t\tpage_nodes.validate();\n\t\t\t\t}\n\t\t\t\ttrailing_slash = page_nodes.trailing_slash();\n\t\t\t} else if (route.endpoint) {\n\t\t\t\tconst node = await route.endpoint();\n\t\t\t\ttrailing_slash = node.trailingSlash ?? 'never';\n\t\t\t\tif (DEV) {\n\t\t\t\t\tvalidate_server_exports(node, /** @type {string} */ (route.endpoint_id));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!is_data_request) {\n\t\t\t\tconst normalized = normalize_path(url.pathname, trailing_slash);\n\n\t\t\t\tif (normalized !== url.pathname && !state.prerendering?.fallback) {\n\t\t\t\t\treturn new Response(undefined, {\n\t\t\t\t\t\tstatus: 308,\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t'x-sveltekit-normalize': '1',\n\t\t\t\t\t\t\tlocation:\n\t\t\t\t\t\t\t\t// ensure paths starting with '//' are not treated as protocol-relative\n\t\t\t\t\t\t\t\t(normalized.startsWith('//') ? url.origin + normalized : normalized) +\n\t\t\t\t\t\t\t\t(url.search === '?' ? '' : url.search)\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (state.before_handle || state.emulator?.platform) {\n\t\t\t\tlet config = {};\n\n\t\t\t\t/** @type {import('types').PrerenderOption} */\n\t\t\t\tlet prerender = false;\n\n\t\t\t\tif (route.endpoint) {\n\t\t\t\t\tconst node = await route.endpoint();\n\t\t\t\t\tconfig = node.config ?? config;\n\t\t\t\t\tprerender = node.prerender ?? prerender;\n\t\t\t\t} else if (page_nodes) {\n\t\t\t\t\tconfig = page_nodes.get_config() ?? config;\n\t\t\t\t\tprerender = page_nodes.prerender();\n\t\t\t\t}\n\n\t\t\t\tif (state.before_handle) {\n\t\t\t\t\tstate.before_handle(event, config, prerender);\n\t\t\t\t}\n\n\t\t\t\tif (state.emulator?.platform) {\n\t\t\t\t\tevent.platform = await state.emulator.platform({ config, prerender });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tset_trailing_slash(trailing_slash);\n\n\t\tif (state.prerendering && !state.prerendering.fallback && !state.prerendering.inside_reroute) {\n\t\t\tdisable_search(url);\n\t\t}\n\n\t\tconst response = await with_event(event, () =>\n\t\t\toptions.hooks.handle({\n\t\t\t\tevent,\n\t\t\t\tresolve: (event, opts) =>\n\t\t\t\t\t// counter-intuitively, we need to clear the event, so that it's not\n\t\t\t\t\t// e.g. accessible when loading modules needed to handle the request\n\t\t\t\t\twith_event(null, () =>\n\t\t\t\t\t\tresolve(event, page_nodes, opts).then((response) => {\n\t\t\t\t\t\t\t// add headers/cookies here, rather than inside `resolve`, so that we\n\t\t\t\t\t\t\t// can do it once for all responses instead of once per `return`\n\t\t\t\t\t\t\tfor (const key in headers) {\n\t\t\t\t\t\t\t\tconst value = headers[key];\n\t\t\t\t\t\t\t\tresponse.headers.set(key, /** @type {string} */ (value));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tadd_cookies_to_headers(response.headers, Object.values(new_cookies));\n\n\t\t\t\t\t\t\tif (state.prerendering && event.route.id !== null) {\n\t\t\t\t\t\t\t\tresponse.headers.set('x-sveltekit-routeid', encodeURI(event.route.id));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn response;\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t})\n\t\t);\n\n\t\t// respond with 304 if etag matches\n\t\tif (response.status === 200 && response.headers.has('etag')) {\n\t\t\tlet if_none_match_value = request.headers.get('if-none-match');\n\n\t\t\t// ignore W/ prefix https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/If-None-Match#directives\n\t\t\tif (if_none_match_value?.startsWith('W/\"')) {\n\t\t\t\tif_none_match_value = if_none_match_value.substring(2);\n\t\t\t}\n\n\t\t\tconst etag = /** @type {string} */ (response.headers.get('etag'));\n\n\t\t\tif (if_none_match_value === etag) {\n\t\t\t\tconst headers = new Headers({ etag });\n\n\t\t\t\t// https://datatracker.ietf.org/doc/html/rfc7232#section-4.1 + set-cookie\n\t\t\t\tfor (const key of [\n\t\t\t\t\t'cache-control',\n\t\t\t\t\t'content-location',\n\t\t\t\t\t'date',\n\t\t\t\t\t'expires',\n\t\t\t\t\t'vary',\n\t\t\t\t\t'set-cookie'\n\t\t\t\t]) {\n\t\t\t\t\tconst value = response.headers.get(key);\n\t\t\t\t\tif (value) headers.set(key, value);\n\t\t\t\t}\n\n\t\t\t\treturn new Response(undefined, {\n\t\t\t\t\tstatus: 304,\n\t\t\t\t\theaders\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Edge case: If user does `return Response(30x)` in handle hook while processing a data request,\n\t\t// we need to transform the redirect response to a corresponding JSON response.\n\t\tif (is_data_request && response.status >= 300 && response.status <= 308) {\n\t\t\tconst location = response.headers.get('location');\n\t\t\tif (location) {\n\t\t\t\treturn redirect_json_response(new Redirect(/** @type {any} */ (response.status), location));\n\t\t\t}\n\t\t}\n\n\t\treturn response;\n\t} catch (e) {\n\t\tif (e instanceof Redirect) {\n\t\t\tconst response = is_data_request\n\t\t\t\t? redirect_json_response(e)\n\t\t\t\t: route?.page && is_action_json_request(event)\n\t\t\t\t\t? action_json_redirect(e)\n\t\t\t\t\t: redirect_response(e.status, e.location);\n\t\t\tadd_cookies_to_headers(response.headers, Object.values(new_cookies));\n\t\t\treturn response;\n\t\t}\n\t\treturn await handle_fatal_error(event, options, e);\n\t}\n\n\t/**\n\t * @param {import('@sveltejs/kit').RequestEvent} event\n\t * @param {PageNodes | undefined} page_nodes\n\t * @param {import('@sveltejs/kit').ResolveOptions} [opts]\n\t */\n\tasync function resolve(event, page_nodes, opts) {\n\t\ttry {\n\t\t\tif (opts) {\n\t\t\t\tresolve_opts = {\n\t\t\t\t\ttransformPageChunk: opts.transformPageChunk || default_transform,\n\t\t\t\t\tfilterSerializedResponseHeaders: opts.filterSerializedResponseHeaders || default_filter,\n\t\t\t\t\tpreload: opts.preload || default_preload\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (options.hash_routing || state.prerendering?.fallback) {\n\t\t\t\treturn await render_response({\n\t\t\t\t\tevent,\n\t\t\t\t\toptions,\n\t\t\t\t\tmanifest,\n\t\t\t\t\tstate,\n\t\t\t\t\tpage_config: { ssr: false, csr: true },\n\t\t\t\t\tstatus: 200,\n\t\t\t\t\terror: null,\n\t\t\t\t\tbranch: [],\n\t\t\t\t\tfetched: [],\n\t\t\t\t\tresolve_opts\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (route) {\n\t\t\t\tconst method = /** @type {import('types').HttpMethod} */ (event.request.method);\n\n\t\t\t\t/** @type {Response} */\n\t\t\t\tlet response;\n\n\t\t\t\tif (is_data_request) {\n\t\t\t\t\tresponse = await render_data(\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\troute,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t\tmanifest,\n\t\t\t\t\t\tstate,\n\t\t\t\t\t\tinvalidated_data_nodes,\n\t\t\t\t\t\ttrailing_slash\n\t\t\t\t\t);\n\t\t\t\t} else if (route.endpoint && (!route.page || is_endpoint_request(event))) {\n\t\t\t\t\tresponse = await render_endpoint(event, await route.endpoint(), state);\n\t\t\t\t} else if (route.page) {\n\t\t\t\t\tif (!page_nodes) {\n\t\t\t\t\t\tthrow new Error('page_nodes not found. This should never happen');\n\t\t\t\t\t} else if (page_methods.has(method)) {\n\t\t\t\t\t\tresponse = await render_page(\n\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\troute.page,\n\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\tmanifest,\n\t\t\t\t\t\t\tstate,\n\t\t\t\t\t\t\tpage_nodes,\n\t\t\t\t\t\t\tresolve_opts\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst allowed_methods = new Set(allowed_page_methods);\n\t\t\t\t\t\tconst node = await manifest._.nodes[route.page.leaf]();\n\t\t\t\t\t\tif (node?.server?.actions) {\n\t\t\t\t\t\t\tallowed_methods.add('POST');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (method === 'OPTIONS') {\n\t\t\t\t\t\t\t// This will deny CORS preflight requests implicitly because we don't\n\t\t\t\t\t\t\t// add the required CORS headers to the response.\n\t\t\t\t\t\t\tresponse = new Response(null, {\n\t\t\t\t\t\t\t\tstatus: 204,\n\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\tallow: Array.from(allowed_methods.values()).join(', ')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst mod = [...allowed_methods].reduce((acc, curr) => {\n\t\t\t\t\t\t\t\tacc[curr] = true;\n\t\t\t\t\t\t\t\treturn acc;\n\t\t\t\t\t\t\t}, /** @type {Record<string, any>} */ ({}));\n\t\t\t\t\t\t\tresponse = method_not_allowed(mod, method);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// a route will always have a page or an endpoint, but TypeScript doesn't know that\n\t\t\t\t\tthrow new Error('Route is neither page nor endpoint. This should never happen');\n\t\t\t\t}\n\n\t\t\t\t// If the route contains a page and an endpoint, we need to add a\n\t\t\t\t// `Vary: Accept` header to the response because of browser caching\n\t\t\t\tif (request.method === 'GET' && route.page && route.endpoint) {\n\t\t\t\t\tconst vary = response.headers\n\t\t\t\t\t\t.get('vary')\n\t\t\t\t\t\t?.split(',')\n\t\t\t\t\t\t?.map((v) => v.trim().toLowerCase());\n\t\t\t\t\tif (!(vary?.includes('accept') || vary?.includes('*'))) {\n\t\t\t\t\t\t// the returned response might have immutable headers,\n\t\t\t\t\t\t// so we have to clone them before trying to mutate them\n\t\t\t\t\t\tresponse = new Response(response.body, {\n\t\t\t\t\t\t\tstatus: response.status,\n\t\t\t\t\t\t\tstatusText: response.statusText,\n\t\t\t\t\t\t\theaders: new Headers(response.headers)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresponse.headers.append('Vary', 'Accept');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn response;\n\t\t\t}\n\n\t\t\tif (state.error && event.isSubRequest) {\n\t\t\t\t// avoid overwriting the headers. This could be a same origin fetch request\n\t\t\t\t// to an external service from the root layout while rendering an error page\n\t\t\t\tconst headers = new Headers(request.headers);\n\t\t\t\theaders.set('x-sveltekit-error', 'true');\n\t\t\t\treturn await fetch(request, { headers });\n\t\t\t}\n\n\t\t\tif (state.error) {\n\t\t\t\treturn text('Internal Server Error', {\n\t\t\t\t\tstatus: 500\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// if this request came direct from the user, rather than\n\t\t\t// via our own `fetch`, render a 404 page\n\t\t\tif (state.depth === 0) {\n\t\t\t\t// In local development, Chrome requests this file for its 'automatic workspace folders' feature,\n\t\t\t\t// causing console spam. If users want to serve this file they can install\n\t\t\t\t// https://github.com/ChromeDevTools/vite-plugin-devtools-json\n\t\t\t\tif (DEV && event.url.pathname === '/.well-known/appspecific/com.chrome.devtools.json') {\n\t\t\t\t\tif (!warned_on_devtools_json_request) {\n\t\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\t`\\nGoogle Chrome is requesting ${event.url.pathname} to automatically configure devtools project settings. To serve this file, add this plugin to your Vite config:\\n\\nhttps://github.com/ChromeDevTools/vite-plugin-devtools-json\\n`\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\twarned_on_devtools_json_request = true;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn new Response(undefined, { status: 404 });\n\t\t\t\t}\n\n\t\t\t\treturn await respond_with_error({\n\t\t\t\t\tevent,\n\t\t\t\t\toptions,\n\t\t\t\t\tmanifest,\n\t\t\t\t\tstate,\n\t\t\t\t\tstatus: 404,\n\t\t\t\t\terror: new SvelteKitError(404, 'Not Found', `Not found: ${event.url.pathname}`),\n\t\t\t\t\tresolve_opts\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (state.prerendering) {\n\t\t\t\treturn text('not found', { status: 404 });\n\t\t\t}\n\n\t\t\t// we can't load the endpoint from our own manifest,\n\t\t\t// so we need to make an actual HTTP request\n\t\t\treturn await fetch(request);\n\t\t} catch (e) {\n\t\t\t// TODO if `e` is instead named `error`, some fucked up Vite transformation happens\n\t\t\t// and I don't even know how to describe it. need to investigate at some point\n\n\t\t\t// HttpError from endpoint can end up here - TODO should it be handled there instead?\n\t\t\treturn await handle_fatal_error(event, options, e);\n\t\t} finally {\n\t\t\tevent.cookies.set = () => {\n\t\t\t\tthrow new Error('Cannot use `cookies.set(...)` after the response has been generated');\n\t\t\t};\n\n\t\t\tevent.setHeaders = () => {\n\t\t\t\tthrow new Error('Cannot use `setHeaders(...)` after the response has been generated');\n\t\t\t};\n\t\t}\n\t}\n}\n\n/**\n * @param {import('types').PageNodeIndexes} page\n * @param {import('@sveltejs/kit').SSRManifest} manifest\n */\nexport function load_page_nodes(page, manifest) {\n\treturn Promise.all([\n\t\t// we use == here rather than === because [undefined] serializes as \"[null]\"\n\t\t...page.layouts.map((n) => (n == undefined ? n : manifest._.nodes[n]())),\n\t\tmanifest._.nodes[page.leaf]()\n\t]);\n}\n","/**\n * @param {Record<string, string>} env\n * @param {{\n * \t\tpublic_prefix: string;\n * \t\tprivate_prefix: string;\n * }} prefixes\n * @returns {Record<string, string>}\n */\nexport function filter_private_env(env, { public_prefix, private_prefix }) {\n\treturn Object.fromEntries(\n\t\tObject.entries(env).filter(\n\t\t\t([k]) =>\n\t\t\t\tk.startsWith(private_prefix) && (public_prefix === '' || !k.startsWith(public_prefix))\n\t\t)\n\t);\n}\n\n/**\n * @param {Record<string, string>} env\n * @param {{\n * \t\tpublic_prefix: string;\n *    private_prefix: string;\n * }} prefixes\n * @returns {Record<string, string>}\n */\nexport function filter_public_env(env, { public_prefix, private_prefix }) {\n\treturn Object.fromEntries(\n\t\tObject.entries(env).filter(\n\t\t\t([k]) =>\n\t\t\t\tk.startsWith(public_prefix) && (private_prefix === '' || !k.startsWith(private_prefix))\n\t\t)\n\t);\n}\n","/** @type {{ decoders: Record<string, (data: any) => any> }} */\nexport let app;\n\n/**\n * @param {{ decoders: Record<string, (data: any) => any> }} value\n */\nexport function set_app(value) {\n\tapp = value;\n}\n","import { respond } from './respond.js';\nimport { set_private_env, set_public_env, set_safe_public_env } from '../shared-server.js';\nimport { options, get_hooks } from '__SERVER__/internal.js';\nimport { DEV } from 'esm-env';\nimport { filter_private_env, filter_public_env } from '../../utils/env.js';\nimport { prerendering } from '__sveltekit/environment';\nimport { set_read_implementation, set_manifest } from '__sveltekit/server';\nimport { set_app } from './app.js';\n\n/** @type {ProxyHandler<{ type: 'public' | 'private' }>} */\nconst prerender_env_handler = {\n\tget({ type }, prop) {\n\t\tthrow new Error(\n\t\t\t`Cannot read values from $env/dynamic/${type} while prerendering (attempted to read env.${prop.toString()}). Use $env/static/${type} instead`\n\t\t);\n\t}\n};\n\n/** @type {Promise<any>} */\nlet init_promise;\n\nexport class Server {\n\t/** @type {import('types').SSROptions} */\n\t#options;\n\n\t/** @type {import('@sveltejs/kit').SSRManifest} */\n\t#manifest;\n\n\t/** @param {import('@sveltejs/kit').SSRManifest} manifest */\n\tconstructor(manifest) {\n\t\t/** @type {import('types').SSROptions} */\n\t\tthis.#options = options;\n\t\tthis.#manifest = manifest;\n\n\t\tset_manifest(manifest);\n\t}\n\n\t/**\n\t * @param {{\n\t *   env: Record<string, string>;\n\t *   read?: (file: string) => ReadableStream;\n\t * }} opts\n\t */\n\tasync init({ env, read }) {\n\t\t// Take care: Some adapters may have to call `Server.init` per-request to set env vars,\n\t\t// so anything that shouldn't be rerun should be wrapped in an `if` block to make sure it hasn't\n\t\t// been done already.\n\n\t\t// set env, in case it's used in initialisation\n\t\tconst prefixes = {\n\t\t\tpublic_prefix: this.#options.env_public_prefix,\n\t\t\tprivate_prefix: this.#options.env_private_prefix\n\t\t};\n\n\t\tconst private_env = filter_private_env(env, prefixes);\n\t\tconst public_env = filter_public_env(env, prefixes);\n\n\t\tset_private_env(\n\t\t\tprerendering ? new Proxy({ type: 'private' }, prerender_env_handler) : private_env\n\t\t);\n\t\tset_public_env(\n\t\t\tprerendering ? new Proxy({ type: 'public' }, prerender_env_handler) : public_env\n\t\t);\n\t\tset_safe_public_env(public_env);\n\n\t\tif (read) {\n\t\t\tset_read_implementation(read);\n\t\t}\n\n\t\t// During DEV and for some adapters this function might be called in quick succession,\n\t\t// so we need to make sure we're not invoking this logic (most notably the init hook) multiple times\n\t\tawait (init_promise ??= (async () => {\n\t\t\ttry {\n\t\t\t\tconst module = await get_hooks();\n\n\t\t\t\tthis.#options.hooks = {\n\t\t\t\t\thandle: module.handle || (({ event, resolve }) => resolve(event)),\n\t\t\t\t\thandleError:\n\t\t\t\t\t\tmodule.handleError ||\n\t\t\t\t\t\t(({ status, error }) =>\n\t\t\t\t\t\t\tconsole.error((status === 404 && /** @type {Error} */ (error)?.message) || error)),\n\t\t\t\t\thandleFetch: module.handleFetch || (({ request, fetch }) => fetch(request)),\n\t\t\t\t\treroute: module.reroute || (() => {}),\n\t\t\t\t\ttransport: module.transport || {}\n\t\t\t\t};\n\n\t\t\t\tset_app({\n\t\t\t\t\tdecoders: module.transport\n\t\t\t\t\t\t? Object.fromEntries(Object.entries(module.transport).map(([k, v]) => [k, v.decode]))\n\t\t\t\t\t\t: {}\n\t\t\t\t});\n\n\t\t\t\tif (module.init) {\n\t\t\t\t\tawait module.init();\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tif (DEV) {\n\t\t\t\t\tthis.#options.hooks = {\n\t\t\t\t\t\thandle: () => {\n\t\t\t\t\t\t\tthrow error;\n\t\t\t\t\t\t},\n\t\t\t\t\t\thandleError: ({ error }) => console.error(error),\n\t\t\t\t\t\thandleFetch: ({ request, fetch }) => fetch(request),\n\t\t\t\t\t\treroute: () => {},\n\t\t\t\t\t\ttransport: {}\n\t\t\t\t\t};\n\n\t\t\t\t\tset_app({\n\t\t\t\t\t\tdecoders: {}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t}\n\t\t})());\n\t}\n\n\t/**\n\t * @param {Request} request\n\t * @param {import('types').RequestOptions} options\n\t */\n\tasync respond(request, options) {\n\t\treturn respond(request, this.#options, this.#manifest, {\n\t\t\t...options,\n\t\t\terror: false,\n\t\t\tdepth: 0\n\t\t});\n\t}\n}\n"],"names":["ENDPOINT_METHODS","PAGE_METHODS","negotiate","accept","types","parts","accepted","split","forEach","str","i","match","exec","type","subtype","q","push","sort","a","b","min_priority","Infinity","mimetype","priority","findIndex","part","is_content_type","request","headers","get","trim","includes","toLowerCase","is_form_content_type","__name","als","request_event","with_event","event","fn","run","import","then","hooks","AsyncLocalStorage","catch","HttpError","this","constructor","status","body","message","toString","JSON","stringify","Redirect","location","SvelteKitError","Error","text","super","ActionFailure","data","DATA_SUFFIX","HTML_DATA_SUFFIX","has_data_suffix","pathname","endsWith","add_data_suffix","replace","strip_data_suffix","slice","ROUTE_SUFFIX","has_resolution_suffix","add_resolution_suffix","strip_resolution_suffix","json","init","Headers","has","set","encoder","encode","byteLength","Response","TextEncoder","encoded","coalesce_to_error","err","name","normalize_error","error","get_status","get_message","escape_html_attr_dict","escape_html_dict","surrogates","escape_html_attr_regex","RegExp","Object","keys","join","escape_html_regex","escape_html","is_attr","dict","length","charCodeAt","method_not_allowed","mod","method","allow","allowed_methods","allowed","filter","static_error_page","options","templates","async","handle_fatal_error","handle_error_and_jsonify","isDataRequest","handleError","redirect_response","clarify_devalue_error","path","route","id","serialize_uses","node","uses","dependencies","size","Array","from","search_params","params","parent","url","has_prerendered_path","manifest","_","prerendered_routes","at","render_endpoint","state","handler","fallback","HEAD","GET","prerender","prerender_default","POST","PATCH","PUT","DELETE","prerendering","inside_reroute","depth","response","cloned","clone","statusText","String","encodeURI","e","is_endpoint_request","compact","arr","val","is_action_json_request","handle_action_json_request","server","actions","no_actions_error","action_json","check_named_default_separate","call_action","stringify_action_response","transport","action_json_redirect","check_incorrect_fail_use","redirect","is_action_request","handle_action_request","setHeaders","default","URL","param","searchParams","startsWith","action","uneval_action_response","route_id","replacer","thing","key","devalue","uneval","try_serialize","value","encoders","fromEntries","entries","map","validate_action_return","validate_depends","dep","console","warn","INVALIDATED_PARAM","TRAILING_SLASH_PARAM","b64_encode","buffer","globalThis","Buffer","little_endian","Uint8Array","Uint16Array","btoa","TextDecoder","decode","get_relative_path","to","from_parts","to_parts","pop","shift","concat","load_server_data","is_tracking","Set","load","slash","trailingSlash","make_trackable","add","disable_search","done","result","call","fetch","info","Request","DEV","href","depends","deps","Proxy","target","untrack","load_data","fetched","server_data_promise","resolve_opts","csr","server_data_node","universal","create_universal_fetch","universal_fetch","input","cloned_body","cloned_headers","same_origin","origin","dependency","protocol","mode","acao","proxy","_receiver","push_fetched","is_b64","status_number","Number","isNaN","request_body","stream_to_string","request_headers","response_body","arrayBuffer","ArrayBuffer","parse","Reflect","lower","filterSerializedResponseHeaders","stream","reader","getReader","decoder","read","hash","values","isView","TypeError","byteOffset","replacements","pattern","serialize_data","cache_control","age","varyAny","payload","safe_payload","attrs","ttl","s","sha256","precompute","out","array","w","subarray","tmp","out0","out1","out2","out3","out4","out5","out6","out7","bytes","reverse_endianness","base64","Uint32Array","frac","x","Math","floor","prime","is_prime","factor","c","d","ceil","words","chars","l","generate_nonce","crypto","getRandomValues","quoted","crypto_pattern","BaseProvider","use_hashes","script_needs_csp","script_src_needs_csp","script_src_elem_needs_csp","style_needs_csp","style_src_needs_csp","style_src_attr_needs_csp","style_src_elem_needs_csp","directives","script_src","script_src_elem","style_src","style_src_attr","style_src_elem","nonce","effective_script_src","effective_style_src","needs_csp","directive","some","script_needs_nonce","style_needs_nonce","add_script","content","source","add_style","sha256_empty_comment_hash","get_header","is_meta","header","isArray","test","CspProvider","get_meta","CspReportOnlyProvider","v","has_report_to","has_report_uri","Csp","csp_provider","report_only_provider","reportOnly","defer","fulfil","reject","promise","Promise","f","r","create_async_iterator","deferred","iterator","Symbol","asyncIterator","next","matchers","values_needing_match","buffered","chained","rest","matcher","optional","next_param","next_value","generate_route_object","errors","layouts","leaf","nodes","n","create_client_import","client","import_path","assets","base","resolve_route","resolved_path","routes","candidate","matched","decode_params","create_server_routing_response","csr_route","create_css_import","css","node_css","css_path","start","updated","readable","check","render_response","branch","page_config","action_result","csp","app_template_contains_nonce","modulepreloads","imports","stylesheets","fonts","link_header_preloads","inline_styles","Map","rendered","form_value","paths.base","paths.assets","base_expression","hash_routing","ssr","props","stores","page","writable","navigating","constructors","all","component","form","paths.override","render_opts","context","root","render","reset","inline","k","head","html","code","prefixed","style","attributes","preload","preload_atts","lastIndexOf","global","version_hash","chunks","get_data","server_data","item","find","uses_env_dynamic_public","paths.app_dir","included_modulepreloads","preload_strategy","blocks","load_env_eagerly","properties","public_env","args","serialized","hydrate","index","stringified","replaceAll","embedded","indent","repeat","boot","script","app","service_worker","opts","init_app","http_equiv","csp_headers","cache","csp_header","report_only_header","env","safe_public_env","transformed","transformPageChunk","ReadableStream","controller","enqueue","chunk","close","promise_id","count","PageNodes","validate","layout","validate_layout_server_exports","server_id","validate_layout_exports","universal_id","validate_page_server_exports","validate_page_exports","get_option","option","reduce","trailing_slash","get_config","current","config","should_prerender_data","respond_with_error","default_layout","once","render_data","invalidated_data_nodes","node_ids","invalidated","aborted","normalize_path","new_event","functions","j","assign","promises","p","min","get_data_json","json_response","redirect_json_response","reducers","render_page","leaf_node","should_prerender","data_pathname","load_error","server_promises","resolve","load_promises","INVALID_COOKIE_CHARACTER_REGEX","validate_options","get_cookies","initial_cookies","normalized_url","new_cookies","defaults","httpOnly","sameSite","secure","hostname","cookies","domain_matches","domain","path_matches","getAll","cookies2","illegal_characters","set_internal","maxAge","serialize","get_cookie_header","destination","combined_cookies","cookie","encodeURIComponent","parsed","internal_queue","set_trailing_slash","constraint","normalized","add_cookies_to_headers","new_cookie","append","create_fetch","server_fetch","original_request","normalize_fetch_input","credentials","handleFetch","delete","prefix","decoded","decodeURIComponent","filename","filename_html","is_asset","server_assets","is_asset_html","file","mimeTypes","read_implementation","authorization","internal_fetch","set_cookie","set_cookie_parser","splitCookiesString","parseString","decodeValues","signal","DOMException","remove_abort_listener","abort_promise","on_abort","addEventListener","removeEventListener","race","respond","etag","get_public_env","Date","now","default_transform","default_filter","default_preload","page_methods","allowed_page_methods","csrf_check_origin","csrf_error","is_route_resolution_request","is_data_request","getClientAddress","locals","platform","new_headers","isSubRequest","emulator","prerendering_reroute_state","reroute","decode_pathname","url2","app_dir","page_nodes","load_page_nodes","endpoint","search","before_handle","handle","if_none_match_value","substring","acc","curr","vary","event2","filter_private_env","public_prefix","private_prefix","filter_public_env","set_app","prerender_env_handler","prop","init_promise","Server","prefixes","env_public_prefix","env_private_prefix","private_env","set_private_env","set_public_env","set_safe_public_env","set_read_implementation","module","get_hooks"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35]}